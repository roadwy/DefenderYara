
rule Backdoor_BAT_WebShell_ASQ_MTB{
	meta:
		description = "Backdoor:BAT/WebShell.ASQ!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 04 00 00 "
		
	strings :
		$a_03_0 = {0a 16 0b 38 ?? 00 00 00 00 02 1d 8d ?? 00 00 01 13 05 11 05 16 72 ?? ?? 00 70 a2 11 05 17 02 06 07 9a 28 ?? 00 00 06 a2 11 05 18 72 ?? ?? 00 70 a2 11 05 19 07 8c ?? 00 00 01 a2 11 05 1a 72 ?? ?? 00 70 a2 11 05 1b 06 07 9a a2 11 05 1c } //2
		$a_01_1 = {43 00 6c 00 65 00 61 00 72 00 20 00 41 00 6c 00 6c 00 20 00 54 00 68 00 72 00 65 00 61 00 64 00 20 00 2e 00 2e 00 2e 00 2e 00 } //1 Clear All Thread ....
		$a_01_2 = {38 00 66 00 33 00 34 00 62 00 30 00 38 00 36 00 31 00 62 00 63 00 65 00 31 00 65 00 30 00 35 00 33 00 36 00 61 00 32 00 61 00 33 00 64 00 33 00 33 00 63 00 37 00 61 00 30 00 66 00 33 00 39 00 } //1 8f34b0861bce1e0536a2a3d33c7a0f39
		$a_01_3 = {50 00 72 00 6f 00 63 00 65 00 73 00 73 00 20 00 4b 00 69 00 6c 00 6c 00 20 00 53 00 75 00 63 00 63 00 65 00 73 00 73 00 20 00 21 00 } //1 Process Kill Success !
	condition:
		((#a_03_0  & 1)*2+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=5
 
}