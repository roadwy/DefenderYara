
rule Backdoor_Win32_SixMuch_A{
	meta:
		description = "Backdoor:Win32/SixMuch.A,SIGNATURE_TYPE_PEHSTR_EXT,3c 00 32 00 23 00 00 "
		
	strings :
		$a_01_0 = {52 55 4e 44 4c 4c 33 32 2e 45 58 45 20 75 73 65 72 33 32 2e 64 6c 6c 2c 55 70 64 61 74 65 50 65 72 55 73 65 72 53 79 73 74 65 6d 50 61 72 61 6d 65 74 65 72 73 } //5 RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters
		$a_01_1 = {72 75 6e 64 6c 6c 33 32 2e 65 78 65 20 73 68 65 6c 6c 33 32 2e 64 6c 6c 2c 43 6f 6e 74 72 6f 6c 5f 52 75 6e 44 4c 4c 20 69 6e 65 74 63 70 6c 2e 63 70 6c 2c 2c 30 } //5 rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,0
		$a_01_2 = {68 74 74 70 3a 2f 2f 77 77 77 2e 36 36 36 74 2e 63 6f 6d 2f } //10 http://www.666t.com/
		$a_01_3 = {49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5f 54 72 69 64 65 6e 74 43 6d 62 6f 42 78 } //1 Internet Explorer_TridentCmboBx
		$a_01_4 = {49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5f 53 65 72 76 65 72 } //1 Internet Explorer_Server
		$a_01_5 = {49 45 4d 6f 6e 69 74 6f 72 2e 45 58 45 } //1 IEMonitor.EXE
		$a_01_6 = {49 45 4d 6f 6e 69 74 6f 72 20 4d 69 63 72 6f 73 6f 66 74 20 } //1 IEMonitor Microsoft 
		$a_01_7 = {73 61 66 65 66 65 } //1 safefe
		$a_01_8 = {5f 66 75 63 6b 69 6e 67 5f } //10 _fucking_
		$a_01_9 = {5f 73 6d 6f 6b 69 6e 67 5f } //10 _smoking_
		$a_01_10 = {3f 66 69 64 3d } //1 ?fid=
		$a_01_11 = {26 76 65 72 3d } //1 &ver=
		$a_01_12 = {64 6f 6d 61 69 6e 3d } //1 domain=
		$a_01_13 = {25 33 31 5b 41 2d 5a 61 2d 7a 5d } //1 %31[A-Za-z]
		$a_01_14 = {26 63 69 64 3d } //1 &cid=
		$a_01_15 = {30 30 2e 30 30 2e 30 30 2e 30 30 } //1 00.00.00.00
		$a_01_16 = {2a 2e 6c 6e 6b } //1 *.lnk
		$a_01_17 = {26 74 69 64 3d } //1 &tid=
		$a_01_18 = {3b 20 64 6f 6d 61 69 6e 3d } //1 ; domain=
		$a_01_19 = {33 36 30 73 65 } //1 360se
		$a_01_20 = {63 68 61 72 2a 20 58 31 46 39 31 41 41 37 30 36 30 38 44 34 42 45 45 38 38 43 37 35 34 45 45 34 30 45 46 45 32 37 39 20 3d 22 58 31 46 39 31 41 41 37 30 36 30 38 44 34 42 45 45 38 38 43 37 35 34 45 45 34 30 45 46 45 32 37 39 22 3b } //1 char* X1F91AA70608D4BEE88C754EE40EFE279 ="X1F91AA70608D4BEE88C754EE40EFE279";
		$a_01_21 = {63 68 61 72 2a 20 58 46 30 32 31 42 39 42 33 35 42 32 38 34 45 36 33 39 41 32 46 35 30 44 41 43 42 35 37 34 30 32 33 20 3d 22 58 46 30 32 31 42 39 42 33 35 42 32 38 34 45 36 33 39 41 32 46 35 30 44 41 43 42 35 37 34 30 32 33 22 3b } //1 char* XF021B9B35B284E639A2F50DACB574023 ="XF021B9B35B284E639A2F50DACB574023";
		$a_01_22 = {63 68 61 72 2a 20 58 43 44 45 43 34 37 44 33 34 31 43 34 34 34 38 34 41 45 45 32 32 41 30 37 36 43 30 46 41 43 33 39 20 3d 22 58 43 44 45 43 34 37 44 33 34 31 43 34 34 34 38 34 41 45 45 32 32 41 30 37 36 43 30 46 41 43 33 39 22 3b } //1 char* XCDEC47D341C44484AEE22A076C0FAC39 ="XCDEC47D341C44484AEE22A076C0FAC39";
		$a_01_23 = {63 68 61 72 2a 20 58 45 33 33 37 43 46 37 34 31 46 43 41 34 35 32 45 39 34 39 34 37 38 46 34 45 45 44 46 36 32 32 38 20 3d 22 58 45 33 33 37 43 46 37 34 31 46 43 41 34 35 32 45 39 34 39 34 37 38 46 34 45 45 44 46 36 32 32 38 22 3b } //1 char* XE337CF741FCA452E949478F4EEDF6228 ="XE337CF741FCA452E949478F4EEDF6228";
		$a_01_24 = {63 68 61 72 2a 20 58 37 31 46 37 45 38 36 35 30 30 32 32 34 41 30 44 42 39 36 30 33 33 43 44 38 46 44 32 34 34 33 37 20 3d 22 58 37 31 46 37 45 38 36 35 30 30 32 32 34 41 30 44 42 39 36 30 33 33 43 44 38 46 44 32 34 34 33 37 22 3b } //1 char* X71F7E86500224A0DB96033CD8FD24437 ="X71F7E86500224A0DB96033CD8FD24437";
		$a_01_25 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 45 78 70 6c 6f 72 65 72 5c 48 69 64 65 44 65 73 6b 74 6f 70 49 63 6f 6e 73 5c 43 6c 61 73 73 69 63 53 74 61 72 74 4d 65 6e 75 } //1 Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu
		$a_01_26 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 41 70 70 20 50 61 74 68 73 5c 49 45 58 50 4c 4f 52 45 2e 45 58 45 } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\IEXPLORE.EXE
		$a_01_27 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 45 78 70 6c 6f 72 65 72 5c 48 69 64 65 44 65 73 6b 74 6f 70 49 63 6f 6e 73 5c 4e 65 77 53 74 61 72 74 50 61 6e 65 6c } //1 Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel
		$a_01_28 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 45 78 70 6c 6f 72 65 72 5c 44 65 73 6b 74 6f 70 5c 4e 61 6d 65 53 70 61 63 65 5c 25 73 } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\%s
		$a_01_29 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 45 78 70 6c 6f 72 65 72 } //1 SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
		$a_01_30 = {41 64 64 50 6f 73 74 50 61 72 61 6d } //1 AddPostParam
		$a_01_31 = {46 69 6e 64 46 69 72 73 74 46 69 6c 65 41 } //1 FindFirstFileA
		$a_01_32 = {51 75 69 74 41 70 70 } //1 QuitApp
		$a_01_33 = {43 61 6c 6c 4e 65 78 74 48 6f 6f 6b 45 78 } //1 CallNextHookEx
		$a_01_34 = {49 6e 74 65 72 6e 65 74 47 65 74 43 6f 6f 6b 69 65 41 } //1 InternetGetCookieA
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*10+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*10+(#a_01_9  & 1)*10+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*1+(#a_01_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_01_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1+(#a_01_29  & 1)*1+(#a_01_30  & 1)*1+(#a_01_31  & 1)*1+(#a_01_32  & 1)*1+(#a_01_33  & 1)*1+(#a_01_34  & 1)*1) >=50
 
}