
rule Backdoor_Win32_Hackdef_gen_A{
	meta:
		description = "Backdoor:Win32/Hackdef.gen!A,SIGNATURE_TYPE_PEHSTR_EXT,14 00 12 00 69 00 00 "
		
	strings :
		$a_00_0 = {72 75 6e 20 61 73 20 72 6f 6f 74 6b 69 74 } //3 run as rootkit
		$a_00_1 = {5a 6f 72 47 4c 4f 75 42 53 48 45 4c 4c } //2 ZorGLOuBSHELL
		$a_00_2 = {63 3a 5c 68 78 64 6c 6f 67 65 78 2e 74 78 74 } //2 c:\hxdlogex.txt
		$a_00_3 = {5c 44 65 76 69 63 65 5c 5c 55 64 70 } //1 \Device\\Udp
		$a_00_4 = {5c 44 65 76 69 63 65 5c 5c 54 63 70 } //1 \Device\\Tcp
		$a_00_5 = {68 78 64 65 66 2d 72 64 72 62 61 73 65 2d 31 30 30 } //2 hxdef-rdrbase-100
		$a_00_6 = {5c 5c 2e 5c 48 78 44 65 66 44 72 69 76 65 72 } //2 \\.\HxDefDriver
		$a_00_7 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 68 78 64 65 66 2d 72 6b 31 30 30 73 } //3 \\.\mailslot\hxdef-rk100s
		$a_00_8 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 68 78 64 65 66 2d 72 6b 31 30 30 73 30 41 43 45 45 37 36 31 } //3 \\.\mailslot\hxdef-rk100s0ACEE761
		$a_00_9 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 64 65 61 74 68 2d 61 70 31 30 30 73 } //2 \\.\mailslot\death-ap100s
		$a_00_10 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 64 65 61 74 68 2d 61 70 63 } //2 \\.\mailslot\death-apc
		$a_00_11 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 64 65 61 74 68 2d 61 70 62 } //2 \\.\mailslot\death-apb
		$a_00_12 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 64 65 61 74 68 2d 61 70 73 } //2 \\.\mailslot\death-aps
		$a_00_13 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 64 65 61 74 68 2d 61 70 31 30 30 73 30 41 43 45 45 37 36 31 } //2 \\.\mailslot\death-ap100s0ACEE761
		$a_00_14 = {6a 6f 68 6e 64 6f 65 32 32 31 2e 6e 65 74 66 69 72 6d 73 2e 63 6f 6d } //1 johndoe221.netfirms.com
		$a_00_15 = {50 72 65 66 65 74 63 68 5c 2a 2e 70 66 } //2 Prefetch\*.pf
		$a_00_16 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 68 78 64 65 66 2d 72 6b 63 } //3 \\.\mailslot\hxdef-rkc
		$a_00_17 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 68 78 64 65 66 2d 72 6b 62 } //3 \\.\mailslot\hxdef-rkb
		$a_00_18 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 68 78 64 65 66 2d 72 6b 73 } //3 \\.\mailslot\hxdef-rks
		$a_00_19 = {75 6e 69 6e 73 74 61 6c 6c 69 6e 67 20 6f 6c 64 20 73 65 72 76 69 63 65 20 7c 20 64 72 69 76 65 72 } //1 uninstalling old service | driver
		$a_00_20 = {23 53 54 45 41 4c 54 48 20 54 41 42 4c 45 23 } //2 #STEALTH TABLE#
		$a_00_21 = {23 52 4f 4f 54 20 50 52 4f 43 45 53 53 45 53 23 } //2 #ROOT PROCESSES#
		$a_00_22 = {23 52 30 30 54 20 50 52 4f 43 45 53 53 45 53 23 } //2 #R00T PROCESSES#
		$a_00_23 = {23 53 54 45 41 4c 54 48 20 53 45 52 56 49 43 45 53 23 } //2 #STEALTH SERVICES#
		$a_00_24 = {23 53 54 45 41 4c 54 48 20 52 45 47 56 41 4c 55 45 53 23 } //2 #STEALTH REGVALUES#
		$a_00_25 = {23 53 54 45 41 4c 54 48 20 52 45 47 4b 45 59 53 23 } //2 #STEALTH REGKEYS#
		$a_00_26 = {23 53 54 45 41 4c 54 48 20 50 52 4f 43 45 53 53 45 53 23 } //2 #STEALTH PROCESSES#
		$a_00_27 = {23 53 54 45 41 4c 54 48 20 50 4f 52 54 53 23 } //2 #STEALTH PORTS#
		$a_00_28 = {23 4d 41 53 54 45 52 20 50 52 4f 43 45 53 53 45 53 23 } //2 #MASTER PROCESSES#
		$a_00_29 = {23 43 4f 4e 46 49 47 55 52 41 54 49 4f 4e 23 } //2 #CONFIGURATION#
		$a_00_30 = {5b 43 4f 56 45 52 53 20 50 52 4f 43 45 53 53 45 53 5d } //2 [COVERS PROCESSES]
		$a_00_31 = {5b 43 4f 56 45 52 53 20 53 45 52 56 49 43 45 53 5d } //2 [COVERS SERVICES]
		$a_00_32 = {5b 43 4f 56 45 52 53 20 52 45 47 4b 45 59 53 5d } //2 [COVERS REGKEYS]
		$a_00_33 = {5b 43 4f 56 45 52 53 20 52 45 47 56 41 4c 55 45 53 5d } //2 [COVERS REGVALUES]
		$a_00_34 = {4f 50 45 4e 48 4f 4c 45 53 48 45 4c 4c } //2 OPENHOLESHELL
		$a_00_35 = {63 68 61 6e 67 65 20 73 65 72 76 69 63 65 20 63 6f 6e 66 69 67 20 32 61 20 65 78 69 73 74 73 } //1 change service config 2a exists
		$a_00_36 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6c 65 69 67 68 61 6e 6e 73 } //2 \\.\mailslot\leighanns
		$a_00_37 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6c 65 69 67 68 61 6e 6e 63 } //2 \\.\mailslot\leighannc
		$a_00_38 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6c 65 69 67 68 61 6e 6e 62 } //2 \\.\mailslot\leighannb
		$a_00_39 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6c 65 69 67 68 61 6e 6e 31 30 30 73 } //2 \\.\mailslot\leighann100s
		$a_00_40 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6c 65 69 67 68 61 6e 6e 31 30 30 73 41 42 43 44 45 46 } //2 \\.\mailslot\leighann100sABCDEF
		$a_00_41 = {5b 70 69 61 6c 69 61 20 50 52 4f 43 45 53 53 45 53 5d } //2 [pialia PROCESSES]
		$a_00_42 = {5b 70 69 61 6c 69 61 20 53 45 52 56 49 43 45 53 5d } //2 [pialia SERVICES]
		$a_00_43 = {5b 70 69 61 6c 69 61 20 52 45 47 4b 45 59 53 5d } //2 [pialia REGKEYS]
		$a_00_44 = {5b 70 69 61 6c 69 61 20 52 45 47 56 41 4c 55 45 53 5d } //2 [pialia REGVALUES]
		$a_00_45 = {5b 70 69 61 6c 69 61 20 50 4f 52 54 53 5d } //2 [pialia PORTS]
		$a_00_46 = {5b 49 4e 56 49 53 49 42 4c 45 20 54 41 42 4c 45 5d } //2 [INVISIBLE TABLE]
		$a_00_47 = {5b 49 4e 56 49 53 49 42 4c 45 20 50 52 4f 43 45 53 53 45 53 5d } //2 [INVISIBLE PROCESSES]
		$a_00_48 = {5b 49 4e 56 49 53 49 42 4c 45 20 53 45 52 56 49 43 45 53 5d } //2 [INVISIBLE SERVICES]
		$a_00_49 = {5b 49 4e 56 49 53 49 42 4c 45 20 52 45 47 4b 45 59 53 5d } //2 [INVISIBLE REGKEYS]
		$a_00_50 = {5b 49 4e 56 49 53 49 42 4c 45 20 52 45 47 56 41 4c 55 45 53 5d } //2 [INVISIBLE REGVALUES]
		$a_00_51 = {5b 49 4e 56 49 53 49 42 4c 45 20 50 4f 52 54 53 5d } //2 [INVISIBLE PORTS]
		$a_00_52 = {5b 48 49 44 44 45 4e 20 50 52 4f 43 45 53 53 45 53 5d } //2 [HIDDEN PROCESSES]
		$a_00_53 = {5b 52 4f 4f 54 20 50 52 4f 43 45 53 53 45 53 5d } //2 [ROOT PROCESSES]
		$a_00_54 = {5b 48 49 44 44 45 4e 20 53 45 52 56 49 43 45 53 5d } //2 [HIDDEN SERVICES]
		$a_00_55 = {5b 48 49 44 44 45 4e 20 52 45 47 4b 45 59 53 5d } //2 [HIDDEN REGKEYS]
		$a_00_56 = {5b 48 49 44 44 45 4e 20 52 45 47 56 41 4c 55 45 53 5d } //2 [HIDDEN REGVALUES]
		$a_00_57 = {42 41 43 4b 44 4f 4f 52 53 48 45 4c 4c } //1 BACKDOORSHELL
		$a_00_58 = {53 45 52 56 49 43 45 44 49 53 50 4c 41 59 4e 41 4d 45 } //1 SERVICEDISPLAYNAME
		$a_00_59 = {53 45 52 56 49 43 45 44 45 53 43 52 49 50 54 49 4f 4e } //1 SERVICEDESCRIPTION
		$a_00_60 = {46 49 4c 45 4d 41 50 50 49 4e 47 4e 41 4d 45 } //1 FILEMAPPINGNAME
		$a_00_61 = {53 56 43 44 49 53 50 4c 41 59 4e 41 4d 45 } //1 SVCDISPLAYNAME
		$a_00_62 = {53 56 43 44 45 53 43 52 49 50 54 49 4f 4e } //1 SVCDESCRIPTION
		$a_00_63 = {44 52 56 46 49 4c 45 4e 41 4d 45 } //1 DRVFILENAME
		$a_00_64 = {48 61 63 6b 65 72 20 44 65 66 65 6e 64 65 72 20 31 2e 30 2e 30 20 52 65 64 69 72 20 42 61 73 65 } //5 Hacker Defender 1.0.0 Redir Base
		$a_00_65 = {48 69 64 69 6e 67 20 63 6f 6e 73 6f 6c 65 } //1 Hiding console
		$a_00_66 = {43 6f 72 72 75 70 74 65 64 20 69 6e 69 66 69 6c 65 21 20 44 65 6c 65 74 65 20 69 74 20 6f 72 20 66 69 78 20 69 74 20 61 6e 64 20 72 65 73 74 61 72 74 20 74 68 69 73 20 61 70 70 6c 69 63 61 74 69 6f 6e } //3 Corrupted inifile! Delete it or fix it and restart this application
		$a_00_67 = {2d 3a 49 4e 53 54 41 4c 4c 4f 4e 4c 59 } //3 -:INSTALLONLY
		$a_00_68 = {2d 3a 52 45 46 52 45 53 48 } //3 -:REFRESH
		$a_00_69 = {2d 3a 4e 4f 53 45 52 56 49 43 45 } //3 -:NOSERVICE
		$a_00_70 = {2d 3a 55 4e 49 4e 53 54 41 4c 4c } //3 -:UNINSTALL
		$a_00_71 = {5f 5f 49 4e 53 54 41 4c 4c } //2 __INSTALL
		$a_00_72 = {5f 5f 52 45 4c 4f 41 44 } //2 __RELOAD
		$a_00_73 = {5f 5f 53 54 45 41 4c 54 48 } //2 __STEALTH
		$a_00_74 = {5f 5f 44 49 45 } //2 __DIE
		$a_00_75 = {47 48 61 6e 64 6c 65 73 20 76 31 2e 30 20 66 6f 72 20 47 4b 69 74 20 62 79 20 67 72 61 79 2c 74 68 78 20 66 6f 72 20 48 6f 6c 79 5f 46 61 74 68 65 72 20 26 26 20 52 61 74 74 65 72 2f 32 39 41 } //2 GHandles v1.0 for GKit by gray,thx for Holy_Father && Ratter/29A
		$a_00_76 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 65 64 69 61 2d 63 6b 72 } //3 \\.\mailslot\media-ckr
		$a_00_77 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 65 64 69 61 2d 72 6b 62 } //3 \\.\mailslot\media-rkb
		$a_00_78 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 65 64 69 61 2d 72 6b 73 } //3 \\.\mailslot\media-rks
		$a_00_79 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 65 64 69 61 2d 62 6c 61 63 6b 30 41 43 45 45 37 36 31 } //3 \\.\mailslot\media-black0ACEE761
		$a_00_80 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 65 64 69 61 2d 62 6c 61 63 6b } //2 \\.\mailslot\media-black
		$a_00_81 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 6d 79 61 70 70 2d 6e 74 73 } //2 \\.\mailslot\myapp-nts
		$a_00_82 = {2d 2d 4a 55 53 54 5f 49 4e 53 54 41 4c 4c } //2 --JUST_INSTALL
		$a_00_83 = {2d 2d 52 45 50 4c 41 59 } //2 --REPLAY
		$a_00_84 = {2d 2d 42 45 5f 43 4f 4f 4c } //2 --BE_COOL
		$a_00_85 = {2d 2d 52 45 4d 4f 56 45 5f 4d 45 } //2 --REMOVE_ME
		$a_00_86 = {2d 2d 4e 54 2d 2d } //2 --NT--
		$a_00_87 = {3d 21 3d 25 3d 29 3d 2d 3d 31 3d 35 3d 39 3d 3d 3d 41 3d 45 3d 49 3d 4d 3d 51 3d 55 3d 59 3d 5d 3d 61 3d 65 3d 69 3d 6d 3d 71 3d 75 3d 79 3d 7d 3d } //2 =!=%=)=-=1=5=9===A=E=I=M=Q=U=Y=]=a=e=i=m=q=u=y=}=
		$a_00_88 = {43 72 65 61 74 65 4d 61 69 6c 53 6c 6f 74 } //1 CreateMailSlot
		$a_00_89 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 74 75 66 68 6b 2d 6e 74 31 30 30 73 30 41 43 45 45 37 36 31 } //2 \\.\mailslot\tufhk-nt100s0ACEE761
		$a_00_90 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 74 75 66 68 6b 2d 6e 74 31 30 30 73 } //2 \\.\mailslot\tufhk-nt100s
		$a_00_91 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 74 75 66 68 6b 2d 6e 74 63 } //2 \\.\mailslot\tufhk-ntc
		$a_00_92 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c 74 75 66 68 6b 2d 6e 74 62 } //2 \\.\mailslot\tufhk-ntb
		$a_00_93 = {2d 3a 62 64 3a 2d } //3 -:bd:-
		$a_02_94 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c ?? ?? ?? ?? ?? 2d 72 6b 73 } //2
		$a_02_95 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c ?? ?? ?? ?? ?? 2d 72 6b 62 } //2
		$a_02_96 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c ?? ?? ?? ?? ?? 2d 72 6b 63 } //2
		$a_02_97 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c ?? ?? ?? ?? ?? 2d 72 6b 31 30 30 73 } //2
		$a_02_98 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c ?? ?? ?? ?? ?? ?? ?? ?? 31 30 30 73 } //2
		$a_02_99 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 2d 78 64 62 } //2
		$a_02_100 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 2d 78 64 63 } //2
		$a_02_101 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 2d 78 64 31 33 30 73 } //2
		$a_02_102 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 2d 78 64 31 33 30 73 41 42 43 44 } //2
		$a_02_103 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 62 63 62 } //2
		$a_02_104 = {5c 5c 2e 5c 6d 61 69 6c 73 6c 6f 74 5c [0-06] 62 63 63 } //2
	condition:
		((#a_00_0  & 1)*3+(#a_00_1  & 1)*2+(#a_00_2  & 1)*2+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*2+(#a_00_6  & 1)*2+(#a_00_7  & 1)*3+(#a_00_8  & 1)*3+(#a_00_9  & 1)*2+(#a_00_10  & 1)*2+(#a_00_11  & 1)*2+(#a_00_12  & 1)*2+(#a_00_13  & 1)*2+(#a_00_14  & 1)*1+(#a_00_15  & 1)*2+(#a_00_16  & 1)*3+(#a_00_17  & 1)*3+(#a_00_18  & 1)*3+(#a_00_19  & 1)*1+(#a_00_20  & 1)*2+(#a_00_21  & 1)*2+(#a_00_22  & 1)*2+(#a_00_23  & 1)*2+(#a_00_24  & 1)*2+(#a_00_25  & 1)*2+(#a_00_26  & 1)*2+(#a_00_27  & 1)*2+(#a_00_28  & 1)*2+(#a_00_29  & 1)*2+(#a_00_30  & 1)*2+(#a_00_31  & 1)*2+(#a_00_32  & 1)*2+(#a_00_33  & 1)*2+(#a_00_34  & 1)*2+(#a_00_35  & 1)*1+(#a_00_36  & 1)*2+(#a_00_37  & 1)*2+(#a_00_38  & 1)*2+(#a_00_39  & 1)*2+(#a_00_40  & 1)*2+(#a_00_41  & 1)*2+(#a_00_42  & 1)*2+(#a_00_43  & 1)*2+(#a_00_44  & 1)*2+(#a_00_45  & 1)*2+(#a_00_46  & 1)*2+(#a_00_47  & 1)*2+(#a_00_48  & 1)*2+(#a_00_49  & 1)*2+(#a_00_50  & 1)*2+(#a_00_51  & 1)*2+(#a_00_52  & 1)*2+(#a_00_53  & 1)*2+(#a_00_54  & 1)*2+(#a_00_55  & 1)*2+(#a_00_56  & 1)*2+(#a_00_57  & 1)*1+(#a_00_58  & 1)*1+(#a_00_59  & 1)*1+(#a_00_60  & 1)*1+(#a_00_61  & 1)*1+(#a_00_62  & 1)*1+(#a_00_63  & 1)*1+(#a_00_64  & 1)*5+(#a_00_65  & 1)*1+(#a_00_66  & 1)*3+(#a_00_67  & 1)*3+(#a_00_68  & 1)*3+(#a_00_69  & 1)*3+(#a_00_70  & 1)*3+(#a_00_71  & 1)*2+(#a_00_72  & 1)*2+(#a_00_73  & 1)*2+(#a_00_74  & 1)*2+(#a_00_75  & 1)*2+(#a_00_76  & 1)*3+(#a_00_77  & 1)*3+(#a_00_78  & 1)*3+(#a_00_79  & 1)*3+(#a_00_80  & 1)*2+(#a_00_81  & 1)*2+(#a_00_82  & 1)*2+(#a_00_83  & 1)*2+(#a_00_84  & 1)*2+(#a_00_85  & 1)*2+(#a_00_86  & 1)*2+(#a_00_87  & 1)*2+(#a_00_88  & 1)*1+(#a_00_89  & 1)*2+(#a_00_90  & 1)*2+(#a_00_91  & 1)*2+(#a_00_92  & 1)*2+(#a_00_93  & 1)*3+(#a_02_94  & 1)*2+(#a_02_95  & 1)*2+(#a_02_96  & 1)*2+(#a_02_97  & 1)*2+(#a_02_98  & 1)*2+(#a_02_99  & 1)*2+(#a_02_100  & 1)*2+(#a_02_101  & 1)*2+(#a_02_102  & 1)*2+(#a_02_103  & 1)*2+(#a_02_104  & 1)*2) >=18
 
}