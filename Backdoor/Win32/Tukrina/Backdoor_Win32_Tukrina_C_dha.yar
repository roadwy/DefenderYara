
rule Backdoor_Win32_Tukrina_C_dha{
	meta:
		description = "Backdoor:Win32/Tukrina.C!dha,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_41_0 = {59 a9 33 76 01 } //1
		$a_68_1 = {97 16 9c 01 00 05 41 68 8d 00 d2 17 01 00 05 41 68 5f 95 90 f4 01 00 05 41 68 62 62 db 68 00 00 5d 04 00 00 5c f9 03 80 5c 25 00 00 5d f9 03 80 00 00 01 00 06 00 0f 00 84 21 54 75 6b 72 69 6e 61 } //1280
		$a_64_2 = {61 00 00 01 40 05 82 42 00 04 00 78 b1 02 00 0a 00 0a 00 0c 00 00 06 00 39 43 58 66 89 45 90 01 01 } //17454
		$a_66_3 = {45 90 01 01 6a 33 58 66 89 45 90 01 01 6a 32 58 66 89 45 90 01 01 6a 6c 58 66 89 45 90 01 01 6a 6f 58 66 89 45 90 01 01 6a 63 58 90 00 06 00 24 43 6a 4d 66 89 90 02 05 58 6a 69 66 89 90 02 05 58 6a 63 66 89 90 02 05 58 6a 72 66 89 90 02 05 58 6a 6f 90 00 06 00 25 } //29546
		$a_58_4 = {89 90 02 05 6a 69 58 66 89 90 02 05 6a 63 58 66 89 90 02 05 6a 72 58 66 89 90 02 05 6a 6f 58 90 00 06 00 43 43 b8 4f 00 00 00 66 89 84 24 90 01 04 b8 6e 00 00 00 66 89 84 24 90 01 04 b8 65 00 00 00 66 89 84 24 90 01 04 b8 44 00 00 } //27203
	condition:
		((#a_41_0  & 1)*1+(#a_68_1  & 1)*1280+(#a_64_2  & 1)*17454+(#a_66_3  & 1)*29546+(#a_58_4  & 1)*27203) >=4
 
}