
rule TrojanDropper_O97M_DLoadr_P_MSR{
	meta:
		description = "TrojanDropper:O97M/DLoadr.P!MSR,SIGNATURE_TYPE_MACROHSTR_EXT,0a 00 09 00 05 00 00 09 00 "
		
	strings :
		$a_00_0 = {68 30 20 3d 20 22 6d 74 22 20 2b 20 22 68 2e 39 22 20 2b 20 22 30 2f 39 22 20 2b 20 22 36 3a 6f 22 20 2b 20 22 74 2e 73 75 2e 73 70 75 22 20 2b 20 22 6f 72 67 2f 22 20 2b 20 22 2f 3a 70 74 22 20 2b 20 22 74 68 20 } //01 00 
		$a_00_1 = {63 30 20 3d 20 22 61 54 22 20 2b 20 22 68 22 20 2b 20 22 53 6d } //0a 00 
		$a_00_2 = {73 30 20 28 22 6d 22 29 20 2b 20 22 53 68 22 20 2b 20 28 22 54 22 29 20 2b 20 22 61 20 68 22 20 2b 20 28 22 74 22 29 20 2b 20 28 22 74 22 29 20 2b 20 22 70 3a 2f 2f 67 72 6f 75 70 22 20 2b 20 28 22 73 22 29 20 2b 20 22 2e 75 22 20 2b 20 28 22 73 22 29 20 2b 20 22 2e 74 6f 3a 36 39 2f 30 33 2e 68 22 20 2b 20 28 22 74 22 29 20 2b 20 28 22 6d 22 29 } //09 00 
		$a_00_3 = {73 30 20 28 22 6d 22 29 20 2b 20 28 22 73 22 29 20 2b 20 28 22 68 22 29 20 2b 20 28 22 74 22 29 20 2b 20 28 22 61 22 29 20 2b 20 28 22 20 22 29 20 2b 20 28 22 68 22 29 20 2b 20 28 22 74 22 29 20 2b 20 28 22 74 22 29 20 2b 20 28 22 70 22 29 20 2b 20 28 22 73 22 29 20 2b 20 28 22 3a 22 29 20 2b 20 28 22 2f 22 29 20 2b 20 28 22 2f 22 29 20 2b 20 28 22 74 22 29 } //01 00 
		$a_00_4 = {53 65 74 20 64 30 20 3d 20 47 65 74 4f 62 6a 65 63 74 28 22 57 69 4e 6d 47 6d 54 73 3a 7b 49 6d 50 65 52 73 4f 6e 41 74 49 6f 4e 6c 45 76 45 6c 3d 49 6d 50 65 52 73 4f 6e 41 74 45 7d 21 5c 5c 2e 5c 52 6f 4f 74 5c 43 69 4d 76 32 22 29 } //00 00 
	condition:
		any of ($a_*)
 
}