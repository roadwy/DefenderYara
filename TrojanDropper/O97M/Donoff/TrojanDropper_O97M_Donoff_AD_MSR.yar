
rule TrojanDropper_O97M_Donoff_AD_MSR{
	meta:
		description = "TrojanDropper:O97M/Donoff.AD!MSR,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 04 00 00 "
		
	strings :
		$a_02_0 = {2e 43 72 65 61 74 65 4f 62 6a 65 63 74 28 90 02 06 2b 20 22 57 22 20 2b 20 90 02 06 2b 20 22 53 63 22 20 26 20 90 02 06 26 20 22 72 69 70 22 20 26 20 22 74 2e 22 20 26 20 47 62 6f 6f 70 6c 72 29 90 00 } //1
		$a_02_1 = {20 3d 20 49 6e 6d 20 26 20 90 02 06 26 20 22 5c 48 69 67 68 53 6b 79 22 20 26 20 90 00 } //2
		$a_02_2 = {20 3d 20 22 22 20 26 20 48 6f 6f 6c 6f 72 74 67 20 26 20 90 02 06 26 20 22 5c 63 6c 6f 75 64 2e 22 20 26 20 90 02 06 26 20 22 6a 22 20 26 20 90 02 06 26 20 22 73 22 20 26 20 22 22 20 26 20 22 65 22 90 00 } //2
		$a_00_3 = {20 3d 20 22 22 20 26 20 22 73 22 20 26 20 22 22 20 26 20 22 68 22 20 26 20 22 22 20 26 20 22 22 20 26 20 22 65 6c 22 20 26 20 22 6c 22 20 26 20 } //1  = "" & "s" & "" & "h" & "" & "" & "el" & "l" & 
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*2+(#a_02_2  & 1)*2+(#a_00_3  & 1)*1) >=5
 
}