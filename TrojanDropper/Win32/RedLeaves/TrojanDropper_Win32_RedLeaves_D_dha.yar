
rule TrojanDropper_Win32_RedLeaves_D_dha{
	meta:
		description = "TrojanDropper:Win32/RedLeaves.D!dha,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 09 00 00 "
		
	strings :
		$a_01_0 = {43 44 6c 67 43 68 75 50 65 69 00 } //1
		$a_01_1 = {d7 e3 b2 ca b7 d6 ce f6 b9 a4 be df 20 56 31 2e 30 00 00 00 } //1
		$a_01_2 = {6c 76 65 73 6e 73 2e 65 78 65 00 } //1
		$a_01_3 = {64 62 77 69 64 2e 73 75 77 00 } //1
		$a_01_4 = {64 65 6e 74 79 6f 72 2e 65 78 65 00 } //1
		$a_01_5 = {75 6e 69 74 65 73 2e 74 75 63 00 } //1
		$a_01_6 = {43 44 6c 67 44 72 61 77 65 72 00 } //1
		$a_03_7 = {8b 45 0c 56 89 46 38 89 5e 3c e8 f5 0a 00 00 88 46 40 39 5e 38 75 1c 8b 46 0c 83 c8 04 83 c8 04 83 e0 17 89 46 0c 85 46 10 74 08 53 8b ce e8 ?? ?? ff ff } //2
		$a_03_8 = {99 b9 1a 00 00 00 f7 f9 80 c2 41 88 94 35 ?? ?? ?? ?? 03 f7 81 fe 96 00 00 00 7c [0-4c] 83 c8 02 39 59 38 75 26 83 c8 04 eb 21 8b ?? ?? ?? ?? ?? 8b ?? 04 8b 84 0d ?? ?? ?? ?? 8d 8c 0d ?? ?? ?? ?? f7 d8 1b c0 83 e0 fc 83 c0 04 83 e0 17 } //2
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_03_7  & 1)*2+(#a_03_8  & 1)*2) >=3
 
}