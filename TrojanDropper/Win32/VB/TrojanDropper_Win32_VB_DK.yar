
rule TrojanDropper_Win32_VB_DK{
	meta:
		description = "TrojanDropper:Win32/VB.DK,SIGNATURE_TYPE_PEHSTR_EXT,ffffffb6 00 ffffffb5 00 0b 00 00 "
		
	strings :
		$a_00_0 = {44 65 43 72 53 76 72 } //10 DeCrSvr
		$a_00_1 = {46 61 6c 73 65 53 6f 63 6b 65 74 } //10 FalseSocket
		$a_00_2 = {56 42 36 44 45 2e 44 4c 4c } //10 VB6DE.DLL
		$a_00_3 = {73 74 75 62 2e 73 68 61 72 6b } //10 stub.shark
		$a_00_4 = {50 72 6f 6a 65 6b 74 31 } //10 Projekt1
		$a_00_5 = {53 76 72 2e 53 6f 63 6b 65 74 } //10 Svr.Socket
		$a_00_6 = {4d 53 56 42 56 4d 36 30 2e 44 4c 4c } //10 MSVBVM60.DLL
		$a_00_7 = {5a 6f 6d 62 69 65 5f 47 65 74 54 79 70 65 49 6e 66 6f } //10 Zombie_GetTypeInfo
		$a_00_8 = {40 00 2d 00 37 00 30 00 42 00 46 00 2d 00 34 00 43 00 37 00 32 00 2d 00 39 00 34 00 46 00 33 00 2d 00 42 00 45 00 35 00 43 00 } //1 @-70BF-4C72-94F3-BE5C
		$a_00_9 = {2a 00 5c 00 41 00 45 00 3a 00 5c 00 73 00 68 00 61 00 72 00 4b 00 5c 00 32 00 2e 00 32 00 5c 00 53 00 65 00 72 00 76 00 65 00 72 00 5c 00 50 00 72 00 6f 00 6a 00 65 00 6b 00 74 00 31 00 2e 00 76 00 62 00 70 00 } //1 *\AE:\sharK\2.2\Server\Projekt1.vbp
		$a_02_10 = {20 44 65 43 72 53 76 72 00 69 6c 65 20 00 61 72 44 69 72 20 26 00 00 00 00 88 00 00 00 00 00 00 00 02 00 00 00 0b 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 01 00 00 00 90 90 00 00 00 a0 00 00 00 01 00 00 00 52 75 6e 41 01 20 28 50 72 6f 00 00 20 3d 20 46 61 6c 73 65 53 6f 63 6b 65 74 00 20 } //100
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_00_4  & 1)*10+(#a_00_5  & 1)*10+(#a_00_6  & 1)*10+(#a_00_7  & 1)*10+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_02_10  & 1)*100) >=181
 
}