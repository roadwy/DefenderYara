
rule VirTool_BAT_Injector_HL{
	meta:
		description = "VirTool:BAT/Injector.HL,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {20 00 0e 00 00 8d 05 00 00 01 13 06 11 06 16 1f ?? 9c 11 06 17 1f 16 9c 11 06 18 20 d5 00 00 00 9c 11 06 19 1f 54 9c 11 06 1a 1f 6b 9c 11 06 1b 1f 6a 9c 11 06 1c 1f 4a } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule VirTool_BAT_Injector_HL_2{
	meta:
		description = "VirTool:BAT/Injector.HL,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 0c 00 00 "
		
	strings :
		$a_03_0 = {91 61 9c 11 ?? 17 58 13 ?? 11 ?? 11 ?? 31 } //1
		$a_01_1 = {20 18 01 00 00 14 14 17 8d } //1
		$a_03_2 = {91 61 9c 08 17 58 0c 08 11 ?? 31 } //1
		$a_03_3 = {1f 5c 6a 73 ?? ?? ?? ?? 13 ?? 17 2d ?? 20 d0 0f 00 00 0b } //1
		$a_03_4 = {20 8d 7f ee 00 6a 73 ?? ?? ?? ?? 13 ?? 16 2d } //1
		$a_01_5 = {20 08 01 00 00 8c } //1
		$a_01_6 = {1f 64 fe 04 5f 2c } //1
		$a_03_7 = {91 61 9c 06 [0-10] 58 4a 31 } //1
		$a_00_8 = {46 00 61 00 69 00 6c 00 65 00 64 00 20 00 77 00 69 00 74 00 68 00 20 00 77 00 69 00 6e 00 33 00 32 00 20 00 65 00 72 00 72 00 6f 00 72 00 20 00 63 00 6f 00 64 00 65 00 20 00 7b 00 30 00 7d 00 } //1 Failed with win32 error code {0}
		$a_00_9 = {50 00 61 00 72 00 65 00 6e 00 74 00 20 00 50 00 72 00 6f 00 63 00 2e 00 20 00 49 00 44 00 3a 00 20 00 7b 00 30 00 7d 00 2c 00 20 00 50 00 61 00 72 00 65 00 6e 00 74 00 20 00 50 00 72 00 6f 00 63 00 2e 00 20 00 6e 00 61 00 6d 00 65 00 3a 00 20 00 7b 00 31 00 7d 00 } //1 Parent Proc. ID: {0}, Parent Proc. name: {1}
		$a_01_10 = {78 00 70 00 65 00 63 00 74 00 6f 00 } //-100 xpecto
		$a_01_11 = {65 41 67 65 6e 74 75 72 4e 45 54 } //-100 eAgenturNET
	condition:
		((#a_03_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_03_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_01_10  & 1)*-100+(#a_01_11  & 1)*-100) >=3
 
}