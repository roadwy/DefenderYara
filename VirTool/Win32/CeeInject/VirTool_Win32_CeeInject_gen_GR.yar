
rule VirTool_Win32_CeeInject_gen_GR{
	meta:
		description = "VirTool:Win32/CeeInject.gen!GR,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 17 00 00 "
		
	strings :
		$a_03_0 = {8b 51 34 89 55 ?? 8b 45 ?? 8b 48 50 89 4d ?? 6a 40 68 00 30 00 00 8b 55 90 1b 02 52 8b 45 90 1b 00 50 } //1
		$a_03_1 = {8b 42 34 89 45 ?? 8b 0d ?? ?? ?? ?? 8b 51 50 89 55 ?? 6a 40 68 00 30 00 00 8b 45 90 1b 02 50 8b 4d 90 1b 00 51 } //1
		$a_03_2 = {8b 51 34 89 55 ?? a1 ?? ?? ?? ?? 8b 48 50 89 4d ?? 6a 40 68 00 30 00 00 8b 55 90 1b 02 52 8b 45 90 1b 00 50 8b 0d ?? ?? ?? ?? 51 } //1
		$a_03_3 = {83 c2 50 52 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 0c [0-20] 6a 40 68 00 30 00 00 (8b 0d ?? ?? ?? ?? 51 8b 15 ?? ?? ?? ?? 52 a1 ?? ??|?? ?? 50 a1 ?? ?? ?? ?? 50 8b 0d ?? ?? ?? ?? 51 8b) 15 ?? ?? ?? ?? 52 6a 05 } //1
		$a_03_4 = {83 c0 50 50 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 0c [0-20] 6a 40 68 00 30 00 00 8b 15 ?? ?? ?? ?? 52 a1 ?? ?? ?? ?? 50 8b 0d ?? ?? ?? ?? 51 6a 05 } //1
		$a_03_5 = {6a 40 68 00 30 00 00 57 ff b5 ?? ?? ?? ?? ff b5 ?? ?? ?? ?? ff d0 a1 ?? ?? ?? ?? 8b b5 ?? ?? ?? ?? 33 db 53 ff 70 54 56 ff 70 34 } //1
		$a_03_6 = {68 00 00 40 00 ff 75 ?? ff 55 ?? 89 45 ?? 85 c0 0f 88 ?? ?? ?? ?? 8b 46 34 6a 40 68 00 30 00 00 } //1
		$a_03_7 = {83 c2 34 52 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 0c 6a 04 a1 ?? ?? ?? ?? 83 c0 50 50 68 ?? ?? ?? ?? [0-48] 6a 40 68 00 30 00 00 } //1
		$a_03_8 = {07 00 01 00 90 09 06 00 [0-04] c7 } //1
		$a_03_9 = {83 00 01 00 6a 04 8d 45 ?? 50 68 ?? ?? ?? ?? e8 90 09 06 00 [0-04] c7 } //1
		$a_03_10 = {0f b7 42 06 39 85 ?? ?? ?? ?? 7d 66 8b 0d ?? ?? ?? ?? 8b 51 3c 8b 85 90 1b 00 6b c0 28 03 45 ?? 8d 8c 10 f8 00 00 00 } //1
		$a_03_11 = {0f b7 51 06 39 55 ?? 7d ?? a1 ?? ?? ?? ?? 8b 48 3c 8b 55 90 1b 00 6b d2 28 03 55 ?? 8d 84 0a f8 00 00 00 } //1
		$a_03_12 = {0f b7 48 06 39 4d ?? 7d ?? 8b 55 90 1b 00 6b d2 28 a1 ?? ?? ?? ?? 8b 48 3c 03 55 ?? 8d 94 0a f8 00 00 00 } //1
		$a_03_13 = {0f b7 42 06 39 45 ?? 7d 60 8b 0d ?? ?? ?? ?? 8b 51 3c 8b 45 90 1b 00 6b c0 28 03 45 ?? 8d 8c 10 f8 00 00 00 } //1
		$a_03_14 = {0f b7 48 06 39 4d ?? 7d ?? 8b 15 ?? ?? ?? ?? 8b 42 3c 8b 4d ?? 6b c9 28 03 4d ?? 8d 94 01 f8 00 00 00 } //1
		$a_03_15 = {0f b7 42 06 39 45 ?? 7d ?? 8b 4d 90 1b 00 6b c9 28 8b 15 ?? ?? ?? ?? 8b 42 3c 03 4d ?? 8d 8c 01 f8 00 00 00 } //1
		$a_03_16 = {66 3b 48 06 73 ?? 8b 0d ?? ?? ?? ?? 8b 49 3c 03 cb 8d 8c 31 f8 00 00 00 } //1
		$a_03_17 = {83 c2 01 89 55 ?? 0f b7 45 ?? 39 45 90 1b 00 7d ?? 8b 4d 90 1b 00 6b c9 28 8b 15 ?? ?? ?? ?? 8b 42 3c 03 4d ?? 8d 8c 01 f8 00 00 00 } //1
		$a_03_18 = {83 c2 01 89 95 ?? ?? ?? ?? 0f b7 45 ?? 39 85 90 1b 00 7d ?? 8b 8d 90 1b 00 6b c9 28 8b 15 ?? ?? ?? ?? 8b 42 3c 03 4d ?? 8d 8c 01 f8 00 00 00 } //1
		$a_03_19 = {0f b7 46 06 ff 45 ?? 83 45 ?? 28 39 45 ?? 90 13 8b 7d ?? 8b 45 ?? 8b 4f 3c 03 c7 8d bc 08 f8 00 00 00 } //1
		$a_03_20 = {83 c1 01 89 8d ?? ?? ?? ?? 0f b7 55 ?? 39 95 90 1b 00 7d ?? 8b 85 90 1b 00 6b c0 28 8b 0d ?? ?? ?? ?? 8b 51 3c 03 45 ?? 8d 84 10 f8 00 00 00 } //1
		$a_03_21 = {83 c0 01 89 85 ?? ?? ?? ?? 0f b7 4d ?? 39 8d ?? ?? ?? ?? 7d 65 8b 95 ?? ?? ?? ?? 6b d2 28 a1 ?? ?? ?? ?? 8b 48 3c 03 55 ?? 8d 94 0a f8 00 00 00 } //1
		$a_03_22 = {33 d0 8b 45 08 03 45 f8 88 10 8b 4d 08 03 4d f8 0f b6 11 83 c2 [07 08 12] } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_03_8  & 1)*1+(#a_03_9  & 1)*1+(#a_03_10  & 1)*1+(#a_03_11  & 1)*1+(#a_03_12  & 1)*1+(#a_03_13  & 1)*1+(#a_03_14  & 1)*1+(#a_03_15  & 1)*1+(#a_03_16  & 1)*1+(#a_03_17  & 1)*1+(#a_03_18  & 1)*1+(#a_03_19  & 1)*1+(#a_03_20  & 1)*1+(#a_03_21  & 1)*1+(#a_03_22  & 1)*1) >=3
 
}