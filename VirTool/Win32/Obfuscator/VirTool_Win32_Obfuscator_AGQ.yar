
rule VirTool_Win32_Obfuscator_AGQ{
	meta:
		description = "VirTool:Win32/Obfuscator.AGQ,SIGNATURE_TYPE_PEHSTR_EXT,05 00 02 00 0e 00 00 "
		
	strings :
		$a_03_0 = {56 8b 45 08 8d 34 07 8a c1 02 c0 32 06 32 45 0c 3c ?? 75 17 33 d2 3b f9 0f 94 c2 33 55 0c 74 0b 83 7d 10 ?? 7d 05 8a 55 0c 88 16 88 06 } //1
		$a_03_1 = {8a 45 08 8b 7d ?? 8a 1c 37 02 c1 8a d1 02 d2 32 c2 32 c3 88 04 37 39 75 08 7e 1d 8b 45 0c 99 6a 03 5f f7 ff 0f b6 c2 } //1
		$a_03_2 = {8a ca 02 c9 32 cb 32 08 80 f9 06 75 1e 8d 3c 06 3b fa 75 17 8b 7d ?? 81 e7 ?? ?? ?? ?? 79 05 4f 83 cf fc 47 83 ff 02 7d 02 88 18 } //1
		$a_03_3 = {02 c9 8d 34 07 32 0e 32 4d ?? 80 f9 04 75 1b 8b 45 ?? 39 45 ?? 75 13 8b 45 ?? 6a 03 99 5b f7 fb 83 f8 } //1
		$a_03_4 = {8a 0e 02 d2 32 c2 32 c1 81 7d ?? ?? ?? 00 00 88 06 7e 2e 8b 7d ?? 03 7d ?? 0f b6 c0 fe c1 83 f7 02 88 0e 3d ?? ?? 00 00 7e 17 8a 45 ?? 8b 5d 0c 02 c3 02 c1 0f b6 c0 99 f7 fb 80 fa } //1
		$a_03_5 = {8b 06 8b 3f 8b 8d ?? ?? ff ff eb 07 8a 17 48 88 11 41 47 3b c3 75 f5 8b 06 8b b5 ?? ?? ff ff 01 85 ?? ?? ff ff 83 c6 08 89 b5 ?? ?? ff ff 8d 7e fc 39 1e } //1
		$a_03_6 = {eb 07 8a 10 4e 88 11 41 40 3b f3 75 f5 8b 85 ?? ?? ff ff 8b 00 01 85 ?? ?? ff ff 8b 85 ?? ?? ff ff 83 c0 08 8d 48 fc } //1
		$a_03_7 = {8b 07 8b 7d ?? 01 45 0c 83 c7 08 8d 47 fc 89 7d ?? 89 45 10 39 37 75 b3 8b 55 ?? c7 42 01 ?? ?? ?? ?? 89 55 08 39 75 ?? 75 07 c7 45 08 ?? ?? ?? ?? 8b 7d 08 ff d7 } //1
		$a_03_8 = {8a 10 ff 4d 08 88 11 41 40 39 5d 08 75 f2 8b 07 8b 7d 10 01 45 ?? 83 c7 08 8d 47 ?? 89 7d 10 89 45 0c 39 1f } //1
		$a_03_9 = {eb 07 8a 10 4e 88 11 41 40 3b f3 75 f5 8b 45 08 8b 00 01 45 ?? 8b 45 ?? 83 c0 08 8d 48 ?? 89 45 ?? 89 4d ?? 89 45 08 } //1
		$a_03_10 = {8a 10 ff 4d ?? 88 11 41 40 39 75 ?? 75 f2 8b 45 ?? 8b 00 01 45 ?? 8b 45 ?? 83 c0 08 8d 48 ?? 89 45 ?? 89 4d ?? 89 45 ?? 39 30 } //1
		$a_03_11 = {8a 17 48 88 11 41 47 3b c3 75 f5 8b 06 8b 75 ?? 01 45 ?? 83 c6 08 89 75 ?? 8d 7e fc 39 1e 75 ?? 8b 55 } //1
		$a_03_12 = {8a 17 48 88 11 41 47 3b c3 75 f5 8b 44 24 ?? 8b 00 01 44 24 ?? 8b 44 24 ?? 83 c0 08 89 44 24 ?? 8d 78 fc 89 44 24 ?? 39 18 } //1
		$a_03_13 = {8a 13 88 11 41 43 48 75 ?? 03 3e 8b 75 ?? 83 c6 08 83 3e 00 89 75 ?? 8d 5e fc 75 ?? 8b 7d } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_03_8  & 1)*1+(#a_03_9  & 1)*1+(#a_03_10  & 1)*1+(#a_03_11  & 1)*1+(#a_03_12  & 1)*1+(#a_03_13  & 1)*1) >=2
 
}