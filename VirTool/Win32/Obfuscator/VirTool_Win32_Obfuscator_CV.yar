
rule VirTool_Win32_Obfuscator_CV{
	meta:
		description = "VirTool:Win32/Obfuscator.CV,SIGNATURE_TYPE_PEHSTR_EXT,ffffffc8 00 54 00 19 00 00 "
		
	strings :
		$a_00_0 = {4d 53 56 42 56 4d 36 30 2e 44 4c 4c } //10 MSVBVM60.DLL
		$a_00_1 = {43 6f 6e 74 72 6f 6c 53 65 72 76 69 63 65 } //10 ControlService
		$a_00_2 = {41 64 6a 75 73 74 54 6f 6b 65 6e 50 72 69 76 69 6c 65 67 65 73 } //10 AdjustTokenPrivileges
		$a_00_3 = {4e 74 55 6e 6d 61 70 56 69 65 77 4f 66 53 65 63 74 69 6f 6e } //10 NtUnmapViewOfSection
		$a_00_4 = {5a 77 54 65 72 6d 69 6e 61 74 65 4a 6f 62 4f 62 6a 65 63 74 } //10 ZwTerminateJobObject
		$a_01_5 = {44 00 4d 00 44 00 45 00 50 00 61 00 63 00 6b 00 } //10 DMDEPack
		$a_01_6 = {44 00 4d 00 44 00 45 00 50 00 41 00 43 00 48 00 45 00 52 00 } //10 DMDEPACHER
		$a_00_7 = {72 00 75 00 6e 00 69 00 65 00 70 00 2e 00 65 00 78 00 65 00 2c 00 6e 00 6f 00 64 00 33 00 32 00 6b 00 75 00 69 00 2e 00 65 00 78 00 65 00 2c 00 6e 00 6f 00 64 00 33 00 32 00 6b 00 72 00 6e 00 2e 00 65 00 78 00 65 00 2c 00 } //1 runiep.exe,nod32kui.exe,nod32krn.exe,
		$a_00_8 = {77 00 73 00 63 00 6e 00 74 00 66 00 79 00 2e 00 65 00 78 00 65 00 2c 00 77 00 75 00 61 00 75 00 63 00 6c 00 74 00 2e 00 65 00 78 00 65 00 2c 00 } //1 wscntfy.exe,wuauclt.exe,
		$a_00_9 = {6b 00 61 00 76 00 33 00 32 00 2e 00 65 00 78 00 65 00 2c 00 6b 00 70 00 66 00 77 00 73 00 76 00 63 00 2e 00 65 00 78 00 65 00 2c 00 6b 00 70 00 66 00 77 00 33 00 32 00 2e 00 65 00 78 00 65 00 2c 00 } //1 kav32.exe,kpfwsvc.exe,kpfw32.exe,
		$a_00_10 = {72 00 66 00 77 00 73 00 72 00 76 00 2e 00 65 00 78 00 65 00 2c 00 73 00 63 00 68 00 65 00 64 00 2e 00 65 00 78 00 65 00 2c 00 61 00 76 00 61 00 73 00 74 00 2e 00 65 00 78 00 65 00 2c 00 67 00 75 00 61 00 72 00 64 00 2e 00 65 00 78 00 65 00 } //1 rfwsrv.exe,sched.exe,avast.exe,guard.exe
		$a_00_11 = {5c 00 50 00 61 00 63 00 6b 00 2e 00 76 00 62 00 70 00 } //1 \Pack.vbp
		$a_00_12 = {5c 00 6b 00 69 00 6c 00 6c 00 76 00 76 00 2e 00 73 00 79 00 73 00 } //1 \killvv.sys
		$a_01_13 = {63 6c 73 5f 44 72 69 76 65 72 } //1 cls_Driver
		$a_00_14 = {33 00 36 00 30 00 73 00 61 00 66 00 65 00 62 00 6f 00 78 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_15 = {73 00 61 00 66 00 65 00 62 00 6f 00 78 00 54 00 72 00 61 00 79 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_16 = {33 00 36 00 30 00 54 00 72 00 61 00 79 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_17 = {33 00 36 00 30 00 53 00 61 00 66 00 65 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_18 = {52 00 61 00 76 00 6d 00 6f 00 6e 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_19 = {61 00 76 00 70 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_20 = {43 00 43 00 65 00 6e 00 74 00 65 00 72 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_21 = {52 00 61 00 76 00 6d 00 6f 00 6e 00 44 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_22 = {52 00 61 00 76 00 2e 00 65 00 78 00 65 00 00 00 } //1
		$a_00_23 = {48 00 4b 00 4c 00 4d 00 5c 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 49 00 6d 00 61 00 67 00 65 00 20 00 46 00 69 00 6c 00 65 00 20 00 45 00 78 00 65 00 63 00 75 00 74 00 69 00 6f 00 6e 00 20 00 4f 00 70 00 74 00 69 00 6f 00 6e 00 73 00 5c 00 } //1 HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\
		$a_00_24 = {57 00 73 00 63 00 72 00 69 00 70 00 74 00 2e 00 53 00 68 00 65 00 6c 00 6c 00 } //1 Wscript.Shell
	condition:
		((#a_00_0  & 1)*10+(#a_00_1  & 1)*10+(#a_00_2  & 1)*10+(#a_00_3  & 1)*10+(#a_00_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*10+(#a_00_7  & 1)*1+(#a_00_8  & 1)*1+(#a_00_9  & 1)*1+(#a_00_10  & 1)*1+(#a_00_11  & 1)*1+(#a_00_12  & 1)*1+(#a_01_13  & 1)*1+(#a_00_14  & 1)*1+(#a_00_15  & 1)*1+(#a_00_16  & 1)*1+(#a_00_17  & 1)*1+(#a_00_18  & 1)*1+(#a_00_19  & 1)*1+(#a_00_20  & 1)*1+(#a_00_21  & 1)*1+(#a_00_22  & 1)*1+(#a_00_23  & 1)*1+(#a_00_24  & 1)*1) >=84
 
}