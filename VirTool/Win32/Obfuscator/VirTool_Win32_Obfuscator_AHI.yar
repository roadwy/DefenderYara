
rule VirTool_Win32_Obfuscator_AHI{
	meta:
		description = "VirTool:Win32/Obfuscator.AHI,SIGNATURE_TYPE_PEHSTR_EXT,64 00 04 00 09 00 00 "
		
	strings :
		$a_03_0 = {84 03 00 00 75 [0-0f] 81 [0-05] 1b 01 00 00 [0-1e] 83 [0-05] 0a 81 [0-05] 28 23 00 00 75 [0-0a] c1 ?? 03 } //3
		$a_01_1 = {80 38 7a 75 22 80 78 01 31 75 1c 80 78 02 79 75 16 80 78 03 63 75 10 80 78 04 74 75 0a } //3
		$a_01_2 = {25 ff 0f 00 80 79 07 48 0d 00 f0 ff ff 40 } //1
		$a_01_3 = {57 c1 e6 02 8a c3 02 c0 32 04 11 32 44 24 10 0f b6 f8 3b fe 75 02 fe c0 88 04 11 83 fb 04 7e 05 33 db 43 eb 01 43 41 3b 4c 24 14 7c d7 5f 5e } //3
		$a_01_4 = {6b c9 03 49 89 4d fc 8a c8 02 c9 32 4d 08 32 0c 3e 0f b6 d1 3b 55 fc 75 02 fe c1 88 0c 3e 83 f8 04 7e 06 8b 45 08 99 f7 ff 40 46 3b 75 0c 7c d7 5e } //3
		$a_03_5 = {02 d2 32 c2 8b ?? ?? ?? 32 ?? ?? 39 ?? ?? ?? 7e 02 fe c0 83 ?? ?? ?? 03 8b ?? ?? ?? 88 ?? ?? 7e [0-0f] 7e ?? 83 ?? ?? ?? 08 7d ?? 83 ?? 05 7e } //3
		$a_03_6 = {ff ff 7e 02 fe c0 83 bd ?? ?? ff ff 03 8b ?? ?? ?? ff ff 88 [0-03] 7e [0-12] 7e ?? 83 bd ?? ?? ff ff 08 7d ?? 83 ?? 05 7e [0-2d] 83 bd ?? ?? ff ff 05 7e ?? c7 85 ?? ?? ff ff 02 00 00 00 eb } //3
		$a_03_7 = {88 07 83 fe 03 7e ?? 33 [0-05] 7e ?? 83 fe 08 7d 09 83 ?? 05 7e 04 03 ?? 88 ?? ?? 3b ?? 7c [0-08] 83 bd ?? ?? ff ff 05 7e 0c c7 85 ?? ?? ff ff 02 00 00 00 eb 06 } //3
		$a_03_8 = {8a 0c 01 80 f9 79 75 ?? ff [0-05] 8a [0-05] 02 da 32 d9 8b [0-05] 88 1c 01 85 ff 75 ?? 85 c0 75 ?? 83 [0-05] 03 81 [0-05] d0 07 00 00 7e ?? 81 [0-05] f4 01 00 00 7e 07 4f 74 04 03 c7 33 ff 83 fa 03 7e 0a 33 d2 eb 07 ?? e9 ?? fe ff ff } //4
	condition:
		((#a_03_0  & 1)*3+(#a_01_1  & 1)*3+(#a_01_2  & 1)*1+(#a_01_3  & 1)*3+(#a_01_4  & 1)*3+(#a_03_5  & 1)*3+(#a_03_6  & 1)*3+(#a_03_7  & 1)*3+(#a_03_8  & 1)*4) >=4
 
}