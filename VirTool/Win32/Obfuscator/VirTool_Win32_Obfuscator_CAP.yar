
rule VirTool_Win32_Obfuscator_CAP{
	meta:
		description = "VirTool:Win32/Obfuscator.CAP,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 02 00 00 "
		
	strings :
		$a_03_0 = {39 4d 08 7e 0e e8 ?? ?? ?? ?? 30 04 11 41 3b 4d 08 7c f2 5d c2 04 00 } //20
		$a_03_1 = {6a 40 ff b5 ?? ?? ?? ?? ff 35 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 89 9d ?? ?? ?? ?? c7 85 ?? ?? ?? ?? 20 00 00 00 8b 85 ?? ?? ?? ?? 03 c0 89 85 ?? ?? ?? ?? 46 3b b5 ?? ?? ?? ?? 72 ?? ff b5 ?? ?? ?? ?? e8 ?? ?? ?? ?? ff } //20
	condition:
		((#a_03_0  & 1)*20+(#a_03_1  & 1)*20) >=40
 
}
rule VirTool_Win32_Obfuscator_CAP_2{
	meta:
		description = "VirTool:Win32/Obfuscator.CAP,SIGNATURE_TYPE_PEHSTR_EXT,28 00 28 00 0a 00 00 "
		
	strings :
		$a_01_0 = {21 31 30 31 39 00 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e } //1
		$a_01_1 = {21 31 30 31 36 00 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e } //1
		$a_03_2 = {33 f6 89 7d ?? 89 45 ?? 39 5d ?? 76 ?? 53 ff 15 ?? ?? 40 00 56 ff 75 ?? e8 ?? ?? ?? ?? 88 04 3e 46 59 59 3b 75 ?? 72 } //2
		$a_03_3 = {57 ff 75 f0 e8 ?? ?? ?? ?? 59 59 8b 0d ?? ?? ?? ?? 88 04 39 83 ff ?? 75 } //2
		$a_03_4 = {56 ff 75 fc e8 ?? ?? ?? ?? 59 59 8b 0d ?? ?? ?? ?? 88 04 31 83 fe ?? 75 } //2
		$a_03_5 = {8b 4d 94 8b c6 e8 ?? ?? ?? ?? 88 04 3e 46 3b 75 ?? 72 } //2
		$a_03_6 = {55 8b ec 8b 45 ?? 8b 4d ?? 8a 04 01 5d c3 } //10
		$a_03_7 = {c3 cc ff 25 ?? ?? ?? ?? 8a 04 01 c3 } //10
		$a_03_8 = {8b c7 c1 e8 05 03 45 ?? 8b cf c1 e1 04 03 4d ?? 33 c1 8b 4d ?? 81 45 ?? ?? ?? ?? ?? 03 cf 33 c1 2b d8 ff 4d ?? 75 ?? 8b 45 ?? 89 78 04 5f 5e 89 18 5b c9 c3 } //30
		$a_03_9 = {8b c7 c1 e8 05 03 45 ?? 8b cf c1 e1 04 03 4d ?? 33 c1 8d 0c 3b 33 c1 2b f0 8b c6 c1 e8 05 03 45 ?? 8b ce c1 e1 04 03 4d ?? 33 c1 8d 0c 33 33 c1 2b f8 81 c3 ?? ?? ?? ?? ff 4d ?? 75 ?? 8b 45 ?? 89 38 5f 89 70 04 5e 5b c9 c3 } //30
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*2+(#a_03_3  & 1)*2+(#a_03_4  & 1)*2+(#a_03_5  & 1)*2+(#a_03_6  & 1)*10+(#a_03_7  & 1)*10+(#a_03_8  & 1)*30+(#a_03_9  & 1)*30) >=40
 
}
rule VirTool_Win32_Obfuscator_CAP_3{
	meta:
		description = "VirTool:Win32/Obfuscator.CAP,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 18 00 00 "
		
	strings :
		$a_03_0 = {4c 36 18 00 ?? ?? 81 ?? ?? 31 46 34 00 ?? ?? 81 ?? ?? 80 65 0f 02 ?? ?? 81 ?? ?? 0e 54 b8 02 ?? ?? 81 ?? ?? a9 cc 52 00 } //9
		$a_03_1 = {01 1f f2 00 7e 12 81 ?? ?? 7c 7f 00 00 74 09 81 ?? ?? a9 cc 52 00 } //9
		$a_03_2 = {9b 54 0f 00 ?? ?? 81 ?? ?? 24 6f 63 24 } //5
		$a_01_3 = {7d 3e 65 01 } //5 㹽ť
		$a_03_4 = {79 b3 07 00 ?? ?? 81 ?? ?? 4f b7 23 00 ?? ?? 81 ?? ?? 11 d0 ec 1c } //9
		$a_03_5 = {33 32 2e 64 66 c7 [0-05] 00 6c 6c } //5
		$a_00_6 = {52 68 ad c0 03 00 6a 01 } //5
		$a_03_7 = {bd 76 f0 00 7e ?? 81 ?? ?? bf 73 15 41 74 } //5
		$a_00_8 = {3d 71 75 0b 00 75 } //4 焽୵甀
		$a_00_9 = {81 7d e4 96 7c 5e 37 7d } //4
		$a_00_10 = {81 7d e4 cf 26 00 00 7d } //4
		$a_80_11 = {76 69 7a 69 79 65 68 75 79 69 70 61 6a 61 6e 65 64 65 6c 65 20 6d 61 6e 75 6a 69 68 61 6b 6f 6d 69 76 75 63 6f 79 6f 7a 65 68 69 6c 69 78 69 79 65 6a 69 20 6d 69 79 61 62 69 66 6f 70 6f 67 65 62 69 74 65 } //viziyehuyipajanedele manujihakomivucoyozehilixiyeji miyabifopogebite  3
		$a_80_12 = {68 75 68 75 6a 69 70 69 62 75 6e 75 6c 65 6e 69 76 69 62 75 66 75 20 74 65 6b 6f 6b 75 62 65 6d 61 76 69 66 65 78 69 72 75 6d 69 74 61 74 69 6d 69 70 69 20 77 75 79 6f 6b 61 68 61 74 6f 63 65 73 65 79 75 } //huhujipibunulenivibufu tekokubemavifexirumitatimipi wuyokahatoceseyu  3
		$a_80_13 = {79 75 67 69 66 61 64 61 74 65 20 6d 65 6d 69 74 6f 6c 61 7a 75 72 6f 6a 61 6b 69 6d 75 73 75 73 69 6e 61 6d 69 77 75 20 6b 65 78 61 77 65 67 75 73 65 63 75 63 61 73 65 66 61 6e 69 7a 6f 73 6f 79 6f 70 61 } //yugifadate memitolazurojakimususinamiwu kexawegusecucasefanizosoyopa  3
		$a_80_14 = {64 6f 6a 61 73 75 70 61 62 61 78 6f 20 6d 69 73 61 77 69 62 6f 62 75 77 6f 6e 69 79 75 20 74 6f 79 6f 6c 69 79 65 73 75 6c 69 62 69 } //dojasupabaxo misawibobuwoniyu toyoliyesulibi  3
		$a_80_15 = {6c 6f 79 61 74 61 6c 6f 74 75 62 69 66 6f 6d 61 70 69 20 74 69 63 69 73 65 6b 6f 72 65 20 64 61 77 69 72 75 77 75 64 6f 6e 75 6a 65 } //loyatalotubifomapi ticisekore dawiruwudonuje  3
		$a_80_16 = {77 61 62 75 6b 65 68 65 62 75 20 7a 6f 70 6f 62 75 79 6f 77 61 20 67 61 6b 69 6b 6f 62 75 6d 61 77 69 72 75 70 65 74 69 72 75 64 6f } //wabukehebu zopobuyowa gakikobumawirupetirudo  3
		$a_80_17 = {74 6f 6e 6f 6d 6f 78 61 64 61 72 65 72 61 6a 6f 20 6d 69 63 75 7a 61 73 75 74 65 6e 75 62 6f 62 61 20 6d 75 70 6f 74 75 6b 65 6d 6f } //tonomoxadarerajo micuzasutenuboba mupotukemo  3
		$a_80_18 = {70 69 77 6f 76 61 67 69 74 65 74 65 6b 61 6d 69 68 61 62 69 74 65 64 6f } //piwovagitetekamihabitedo  3
		$a_80_19 = {64 75 77 61 76 69 73 65 63 6f 73 69 74 65 73 61 66 75 79 61 74 65 74 6f 74 69 } //duwavisecositesafuyatetoti  3
		$a_80_20 = {66 69 62 69 62 6f 6c 75 68 69 73 75 63 69 } //fibiboluhisuci  3
		$a_80_21 = {78 65 68 6f 6b 61 67 75 7a 6f 64 69 6b 61 63 61 73 65 68 61 6d 61 20 72 69 73 61 6d 6f 6b 65 6b 75 72 75 } //xehokaguzodikacasehama risamokekuru  3
		$a_80_22 = {6c 65 6d 69 6e 6f 77 61 79 69 79 6f 62 6f 70 61 68 6f 73 75 64 6f 6a 69 70 75 6b 6f 63 6f 6d 65 20 63 65 72 65 78 69 63 61 20 6d 61 6c 65 6b 75 6e 75 74 75 70 75 66 69 64 } //leminowayiyobopahosudojipukocome cerexica malekunutupufid  3
		$a_80_23 = {6e 69 76 6f 6b 65 72 61 6b 75 67 69 73 61 7a 61 20 6e 69 6b 69 6c 69 62 65 78 75 72 75 20 62 6f 70 65 67 65 6a 6f 72 } //nivokerakugisaza nikilibexuru bopegejor  3
	condition:
		((#a_03_0  & 1)*9+(#a_03_1  & 1)*9+(#a_03_2  & 1)*5+(#a_01_3  & 1)*5+(#a_03_4  & 1)*9+(#a_03_5  & 1)*5+(#a_00_6  & 1)*5+(#a_03_7  & 1)*5+(#a_00_8  & 1)*4+(#a_00_9  & 1)*4+(#a_00_10  & 1)*4+(#a_80_11  & 1)*3+(#a_80_12  & 1)*3+(#a_80_13  & 1)*3+(#a_80_14  & 1)*3+(#a_80_15  & 1)*3+(#a_80_16  & 1)*3+(#a_80_17  & 1)*3+(#a_80_18  & 1)*3+(#a_80_19  & 1)*3+(#a_80_20  & 1)*3+(#a_80_21  & 1)*3+(#a_80_22  & 1)*3+(#a_80_23  & 1)*3) >=10
 
}
rule VirTool_Win32_Obfuscator_CAP_4{
	meta:
		description = "VirTool:Win32/Obfuscator.CAP,SIGNATURE_TYPE_PEHSTR_EXT,07 00 07 00 21 00 00 "
		
	strings :
		$a_03_0 = {33 c0 39 05 ?? ?? ?? ?? 76 ?? 8b 0d ?? ?? ?? ?? 8a 94 01 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 14 01 40 3b 05 ?? ?? ?? ?? 72 } //1
		$a_03_1 = {50 56 56 56 ff 15 ?? ?? ?? ?? a1 ?? ?? ?? ?? 8a 84 38 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 04 39 47 3b 3d ?? ?? ?? ?? 72 } //1
		$a_03_2 = {41 00 ff 15 ?? ?? ?? ?? 8b 15 ?? ?? ?? ?? 03 95 ?? ?? ?? ?? a1 ?? ?? ?? ?? 03 85 ?? ?? ?? ?? 8a 88 ?? ?? ?? ?? 88 0a 81 bd ?? ?? ?? ?? ?? ?? ?? ?? 7d } //1
		$a_03_3 = {83 c0 01 89 85 ?? ?? ?? ?? 8b 8d ?? ?? ?? ?? 3b 0d ?? ?? ?? ?? 73 ?? 8b 15 ?? ?? ?? ?? 03 95 ?? ?? ?? ?? a1 ?? ?? ?? ?? 03 85 ?? ?? ?? ?? 8a 88 ?? ?? ?? ?? 88 0a eb } //1
		$a_03_4 = {33 f6 39 5d ?? 76 ?? 3b f3 75 ?? ff 75 ?? 53 ff 15 ?? ?? ?? ?? a3 ?? ?? ?? ?? 8a 84 37 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 04 0e 83 fe ?? 75 } //1
		$a_03_5 = {ff 75 dc 53 ff 15 ?? ?? ?? ?? a3 ?? ?? ?? ?? 8a 84 37 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 04 0e 83 fe ?? 75 } //1
		$a_03_6 = {6a 00 ff d7 6a 00 6a 00 ff d3 8b 0d ?? ?? ?? ?? 8a 94 31 ?? ?? ?? ?? a1 ?? ?? ?? ?? 88 14 30 46 3b 35 ?? ?? ?? ?? 72 } //1
		$a_03_7 = {6a 00 ff d7 6a 00 6a 00 ff d3 a1 ?? ?? ?? ?? 8a 8c 30 ?? ?? ?? ?? 8b 15 ?? ?? ?? ?? 88 0c 32 46 3b 35 ?? ?? ?? ?? 72 } //1
		$a_03_8 = {33 c0 89 0d ?? ?? ?? ?? 39 05 ?? ?? ?? ?? 76 ?? 8b 15 ?? ?? ?? ?? 8a 8c 02 ?? ?? ?? ?? 8b 15 ?? ?? ?? ?? 88 0c 02 40 3b 05 ?? ?? ?? ?? 72 } //1
		$a_03_9 = {33 c0 89 15 ?? ?? ?? ?? 39 05 ?? ?? ?? ?? 76 ?? 8b 0d ?? ?? ?? ?? 8a 94 01 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 14 01 40 3b 05 ?? ?? ?? ?? 72 } //1
		$a_03_10 = {6a 00 ff d7 8b 0d ?? ?? ?? ?? 8a 94 31 ?? ?? ?? ?? a1 ?? ?? ?? ?? 88 14 30 46 3b 35 ?? ?? ?? ?? 72 } //1
		$a_03_11 = {41 00 ff 15 ?? ?? ?? ?? 8b d6 b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 04 0e 46 3b b4 24 ?? ?? ?? ?? 72 } //1
		$a_03_12 = {6a 00 ff 15 ?? ?? ?? ?? ff d3 8b d6 b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 88 04 0e 46 3b 74 24 ?? 72 } //1
		$a_03_13 = {6a 00 8d 85 ?? ?? ?? ?? 50 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? a1 ?? ?? ?? ?? 03 85 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? 03 8d ?? ?? ?? ?? 8a 89 ?? ?? ?? ?? 88 08 eb } //1
		$a_03_14 = {50 57 57 ff 15 ?? ?? ?? ?? e8 ?? ?? ?? ?? 30 04 1e 4e 79 } //2
		$a_03_15 = {6a 00 6a 00 ff d5 e8 ?? ?? ?? ?? 30 04 3e 46 3b f3 7c } //2
		$a_03_16 = {6a 00 6a 00 ff 15 ?? ?? ?? ?? e8 ?? ?? ?? ?? 30 04 3e 46 3b f3 7c } //2
		$a_03_17 = {6a 00 ff 15 ?? ?? ?? ?? e8 ?? ?? ?? ?? 30 04 3e 6a 00 ff 15 ?? ?? ?? ?? 46 3b 75 ?? 7c } //2
		$a_03_18 = {33 c1 8b 55 ?? c1 ea ?? 03 55 ?? 33 c2 8b 4d ?? 2b c8 89 4d ?? 81 7d ?? ?? ?? ?? ?? 73 } //2
		$a_03_19 = {33 d0 33 d1 2b f2 8b d6 c1 ea 05 03 54 24 ?? 8b c6 c1 e0 04 03 44 24 ?? 8d 0c 33 33 d0 33 d1 2b fa 81 fd ?? ?? ?? ?? 73 } //2
		$a_03_20 = {33 c8 2b d9 8b cb 8b c3 c1 e9 05 03 4d ?? c1 e0 04 03 45 ?? 33 c8 8d 04 1e 33 c8 8d b6 ?? ?? ?? ?? 2b f9 83 6d ?? ?? 75 } //2
		$a_03_21 = {8d 49 00 69 c9 ?? ?? ?? ?? 81 c1 ?? ?? ?? ?? 8b d1 c1 ea ?? 30 14 30 40 3b c7 7c } //2
		$a_03_22 = {0f b6 c0 8b 4d ?? 03 4d ?? 0f be 09 33 c8 8b 45 ?? 03 45 ?? 88 08 8b 45 ?? 48 89 45 ?? eb } //2
		$a_03_23 = {33 ff 81 ff ?? ?? ?? ?? 75 ?? ff 15 ?? ?? ?? ?? 8b c7 99 83 fa ?? 7c } //4
		$a_03_24 = {33 f6 81 fe ?? ?? ?? ?? 7d ?? ff d7 81 fe ?? ?? ?? ?? 75 ?? ff 15 ?? ?? ?? ?? 46 81 fe ?? ?? ?? ?? 7c } //4
		$a_03_25 = {41 00 52 a1 ?? ?? ?? ?? 50 8b 0d ?? ?? ?? ?? 51 e8 ?? ?? ?? ?? 83 c4 ?? ff 15 ?? ?? ?? ?? 64 8b 15 ?? ?? ?? ?? 8b 02 c7 40 04 01 00 00 00 33 c0 } //4
		$a_03_26 = {8d 55 fc 52 6a 40 a1 ?? ?? ?? ?? 50 8b 0d ?? ?? ?? ?? 51 ff 15 ?? ?? ?? ?? 8b 15 ?? ?? ?? ?? 52 8b 15 ?? ?? ?? ?? 8b 0d ?? ?? ?? ?? e8 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 6a 00 6a 00 ff 15 } //4
		$a_03_27 = {46 3b 75 dc 72 ?? ff 75 ?? e8 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 8b 00 8b 4d ?? 5f 5e c7 40 04 01 00 00 00 33 cd 33 c0 } //4
		$a_03_28 = {6a 00 6a 00 ff 15 ?? ?? ?? ?? 46 81 fe ?? ?? ?? ?? 7c ?? e8 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 64 8b 0d 2c 00 00 00 8b 11 } //4
		$a_03_29 = {6a 00 6a 00 ff 15 ?? ?? ?? ?? 46 81 fe ?? ?? ?? ?? 7c ?? e8 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 64 a1 2c 00 00 00 8b 08 } //4
		$a_03_30 = {41 00 ff 15 ?? ?? ?? ?? 64 a1 2c 00 00 00 8b 08 5f 5e c7 41 ?? ?? ?? ?? ?? 33 c0 } //4
		$a_03_31 = {5f 5e c3 ff 15 ?? ?? ?? ?? c3 8a 84 11 ?? ?? 00 00 c3 } //4
		$a_03_32 = {6a 00 ff 15 ?? ?? ?? ?? 68 ?? ?? ?? ?? 6a 00 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 81 bd ?? ?? ?? ?? ?? ?? ?? ?? 75 ?? ff 15 ?? ?? ?? ?? 81 bd } //4
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_03_8  & 1)*1+(#a_03_9  & 1)*1+(#a_03_10  & 1)*1+(#a_03_11  & 1)*1+(#a_03_12  & 1)*1+(#a_03_13  & 1)*1+(#a_03_14  & 1)*2+(#a_03_15  & 1)*2+(#a_03_16  & 1)*2+(#a_03_17  & 1)*2+(#a_03_18  & 1)*2+(#a_03_19  & 1)*2+(#a_03_20  & 1)*2+(#a_03_21  & 1)*2+(#a_03_22  & 1)*2+(#a_03_23  & 1)*4+(#a_03_24  & 1)*4+(#a_03_25  & 1)*4+(#a_03_26  & 1)*4+(#a_03_27  & 1)*4+(#a_03_28  & 1)*4+(#a_03_29  & 1)*4+(#a_03_30  & 1)*4+(#a_03_31  & 1)*4+(#a_03_32  & 1)*4) >=7
 
}