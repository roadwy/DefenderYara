
rule VirTool_Win32_VBInject_gen_DG{
	meta:
		description = "VirTool:Win32/VBInject.gen!DG,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 0b 00 00 "
		
	strings :
		$a_03_0 = {fb 12 fc 0d 6c ?? ?? 80 ?? ?? fc a0 } //2
		$a_03_1 = {f5 07 00 01 00 71 ?? ?? ([0-03] f5 00 00 00 00 f5 ?? 00 00 00 04 ?? ?? fe 8e 1e |)} //1
		$a_03_2 = {f5 58 59 59 59 (71 ?? ?? 90 03 01 01 14 1e 59|?? ?? 6c ?? ?? 0a ?? 00 0c 00 [0-01] 6c ?? ?? f5 ?? 00 00 00 )} //1
		$a_03_3 = {58 59 59 59 04 ?? ?? 0a ?? 00 08 00 90 09 04 00 fe c1 } //1
		$a_03_4 = {f3 e8 00 2b ?? ?? 6c ?? ?? 0a ?? 00 0c 00 } //1
		$a_03_5 = {f5 e8 00 00 00 71 ?? ?? (14|1e ?? ?? (|) 1e f4 )} //1
		$a_03_6 = {80 0c 00 fc 90 90 6c ?? ff 08 08 00 8a 40 00 c2 [0-30] 08 08 00 8a 3c 00 fc 90 90 fb 11 } //1
		$a_01_7 = {26 00 48 00 35 00 39 00 35 00 39 00 35 00 39 00 35 00 38 00 } //1 &H59595958
		$a_01_8 = {ad e7 fe 64 84 fc ea 01 f5 28 00 00 00 6c 70 ff f5 f8 00 00 00 aa f5 28 00 00 00 6c 74 ff b2 aa 80 10 00 2e e8 fc 40 } //1
		$a_03_9 = {f5 03 00 00 00 6c ?? ?? 52 fe c1 ?? ?? 40 00 00 00 90 09 08 00 fe c1 ?? ?? 00 30 00 00 } //1
		$a_03_10 = {ad e7 fe 64 ?? ?? ?? ?? ?? ?? f5 f8 00 00 00 6c ?? ?? aa f5 28 00 00 00 6c ?? ?? b2 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_03_9  & 1)*1+(#a_03_10  & 1)*1) >=3
 
}