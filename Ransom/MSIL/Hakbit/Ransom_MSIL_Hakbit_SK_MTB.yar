
rule Ransom_MSIL_Hakbit_SK_MTB{
	meta:
		description = "Ransom:MSIL/Hakbit.SK!MTB,SIGNATURE_TYPE_PEHSTR_EXT,1f 00 1f 00 1d 00 00 "
		
	strings :
		$a_01_0 = {5c 00 48 00 45 00 4c 00 50 00 5f 00 4d 00 45 00 5f 00 52 00 45 00 43 00 4f 00 56 00 45 00 52 00 5f 00 4d 00 59 00 5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 74 00 78 00 74 00 } //10 \HELP_ME_RECOVER_MY_FILES.txt
		$a_01_1 = {5c 00 44 00 45 00 41 00 4c 00 5f 00 46 00 4f 00 52 00 5f 00 41 00 43 00 43 00 45 00 53 00 53 00 5f 00 54 00 4f 00 5f 00 59 00 4f 00 55 00 52 00 5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 74 00 78 00 74 00 } //10 \DEAL_FOR_ACCESS_TO_YOUR_FILES.txt
		$a_01_2 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 77 00 77 00 77 00 2e 00 6d 00 79 00 5f 00 77 00 61 00 6c 00 6c 00 70 00 61 00 70 00 65 00 72 00 5f 00 6c 00 6f 00 63 00 61 00 74 00 69 00 6f 00 6e 00 2e 00 63 00 6f 00 6d 00 2f 00 77 00 61 00 6c 00 6c 00 70 00 61 00 70 00 65 00 72 00 2e 00 62 00 6d 00 70 00 } //10 http://www.my_wallpaper_location.com/wallpaper.bmp
		$a_01_3 = {52 00 61 00 6e 00 73 00 6f 00 6d 00 42 00 75 00 69 00 6c 00 64 00 65 00 72 00 5f 00 4c 00 6f 00 67 00 } //10 RansomBuilder_Log
		$a_01_4 = {52 00 47 00 46 00 30 00 5a 00 53 00 42 00 76 00 5a 00 69 00 42 00 6c 00 62 00 6d 00 4e 00 79 00 65 00 58 00 42 00 30 00 61 00 57 00 39 00 75 00 4f 00 69 00 41 00 3d 00 } //10 RGF0ZSBvZiBlbmNyeXB0aW9uOiA=
		$a_01_5 = {54 00 6e 00 56 00 74 00 59 00 6d 00 56 00 79 00 49 00 47 00 39 00 6d 00 49 00 47 00 5a 00 70 00 62 00 47 00 56 00 7a 00 49 00 47 00 56 00 75 00 59 00 33 00 4a 00 35 00 63 00 48 00 52 00 6c 00 5a 00 44 00 6f 00 67 00 } //10 TnVtYmVyIG9mIGZpbGVzIGVuY3J5cHRlZDog
		$a_01_6 = {55 00 30 00 39 00 47 00 56 00 46 00 64 00 42 00 55 00 6b 00 56 00 63 00 54 00 57 00 6c 00 6a 00 63 00 6d 00 39 00 7a 00 62 00 32 00 5a 00 30 00 58 00 46 00 64 00 70 00 62 00 6d 00 52 00 76 00 64 00 33 00 4d 00 67 00 54 00 6c 00 52 00 63 00 51 00 33 00 56 00 79 00 63 00 6d 00 56 00 75 00 64 00 46 00 5a 00 6c 00 63 00 6e 00 4e 00 70 00 62 00 32 00 35 00 63 00 56 00 32 00 6c 00 75 00 62 00 47 00 39 00 6e 00 62 00 32 00 34 00 3d 00 } //15 U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24=
		$a_00_7 = {51 00 58 00 52 00 6c 00 62 00 6e 00 52 00 70 00 62 00 32 00 34 00 } //15 QXRlbnRpb24
		$a_01_8 = {55 00 32 00 56 00 30 00 4c 00 55 00 31 00 77 00 55 00 48 00 4a 00 6c 00 5a 00 6d 00 56 00 79 00 5a 00 57 00 35 00 6a 00 5a 00 53 00 41 00 74 00 52 00 57 00 35 00 68 00 59 00 6d 00 78 00 6c 00 51 00 32 00 39 00 75 00 64 00 48 00 4a 00 76 00 62 00 47 00 78 00 6c 00 5a 00 45 00 5a 00 76 00 62 00 47 00 52 00 6c 00 63 00 6b 00 46 00 6a 00 59 00 32 00 56 00 7a 00 63 00 79 00 42 00 45 00 61 00 58 00 4e 00 68 00 59 00 6d 00 78 00 6c 00 5a 00 41 00 3d 00 3d 00 } //15 U2V0LU1wUHJlZmVyZW5jZSAtRW5hYmxlQ29udHJvbGxlZEZvbGRlckFjY2VzcyBEaXNhYmxlZA==
		$a_01_9 = {6e 00 65 00 74 00 2e 00 65 00 78 00 65 00 } //2 net.exe
		$a_01_10 = {73 00 63 00 2e 00 65 00 78 00 65 00 } //2 sc.exe
		$a_01_11 = {76 00 73 00 73 00 61 00 64 00 6d 00 69 00 6e 00 2e 00 65 00 78 00 65 00 } //2 vssadmin.exe
		$a_01_12 = {74 00 61 00 73 00 6b 00 6b 00 69 00 6c 00 6c 00 2e 00 65 00 78 00 65 00 } //2 taskkill.exe
		$a_01_13 = {64 00 65 00 6c 00 2e 00 65 00 78 00 65 00 } //2 del.exe
		$a_01_14 = {66 00 74 00 70 00 3a 00 2f 00 2f 00 66 00 69 00 6c 00 65 00 73 00 2e 00 30 00 30 00 30 00 77 00 65 00 62 00 68 00 6f 00 73 00 74 00 2e 00 63 00 6f 00 6d 00 2f 00 70 00 75 00 62 00 6c 00 69 00 63 00 5f 00 68 00 74 00 6d 00 6c 00 2f 00 } //5 ftp://files.000webhost.com/public_html/
		$a_01_15 = {46 00 54 00 50 00 20 00 55 00 73 00 65 00 72 00 4e 00 61 00 6d 00 65 00 } //5 FTP UserName
		$a_01_16 = {46 00 54 00 50 00 20 00 50 00 61 00 73 00 73 00 77 00 6f 00 72 00 64 00 } //5 FTP Password
		$a_01_17 = {41 00 43 00 43 00 45 00 53 00 53 00 } //5 ACCESS
		$a_01_18 = {41 65 73 4d 61 6e 61 67 65 64 } //1 AesManaged
		$a_01_19 = {55 70 6c 6f 61 64 46 69 6c 65 } //1 UploadFile
		$a_01_20 = {46 74 70 57 65 62 52 65 73 70 6f 6e 73 65 } //1 FtpWebResponse
		$a_01_21 = {54 6f 42 61 73 65 36 34 53 74 72 69 6e 67 } //1 ToBase64String
		$a_01_22 = {52 74 6c 53 65 74 50 72 6f 63 65 73 73 49 73 43 72 69 74 69 63 61 6c } //1 RtlSetProcessIsCritical
		$a_01_23 = {53 48 45 6d 70 74 79 52 65 63 79 63 6c 65 42 69 6e } //1 SHEmptyRecycleBin
		$a_01_24 = {46 69 6c 65 49 6e 66 6f } //1 FileInfo
		$a_01_25 = {44 72 69 76 65 49 6e 66 6f } //1 DriveInfo
		$a_01_26 = {46 69 6c 65 53 79 73 74 65 6d 49 6e 66 6f } //1 FileSystemInfo
		$a_01_27 = {53 6d 61 72 74 41 73 73 65 6d 62 6c 79 } //1 SmartAssembly
		$a_01_28 = {43 68 65 63 6b 52 65 6d 6f 74 65 44 65 62 75 67 67 65 72 50 72 65 73 65 6e 74 } //1 CheckRemoteDebuggerPresent
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*10+(#a_01_6  & 1)*15+(#a_00_7  & 1)*15+(#a_01_8  & 1)*15+(#a_01_9  & 1)*2+(#a_01_10  & 1)*2+(#a_01_11  & 1)*2+(#a_01_12  & 1)*2+(#a_01_13  & 1)*2+(#a_01_14  & 1)*5+(#a_01_15  & 1)*5+(#a_01_16  & 1)*5+(#a_01_17  & 1)*5+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1+(#a_01_23  & 1)*1+(#a_01_24  & 1)*1+(#a_01_25  & 1)*1+(#a_01_26  & 1)*1+(#a_01_27  & 1)*1+(#a_01_28  & 1)*1) >=31
 
}