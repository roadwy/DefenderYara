
rule Ransom_Win32_Crilock_A{
	meta:
		description = "Ransom:Win32/Crilock.A,SIGNATURE_TYPE_PEHSTR_EXT,07 00 05 00 05 00 00 05 00 "
		
	strings :
		$a_03_0 = {e8 00 00 00 00 5b 8d 43 36 bf 90 01 04 b9 90 01 04 89 fa 31 db 89 ce 83 e6 03 75 10 90 00 } //01 00 
		$a_01_1 = {5c 66 73 32 30 20 42 69 74 63 6f 69 6e 20 69 73 20 61 20 63 72 79 70 74 6f 63 75 72 72 65 6e 63 79 20 77 68 65 72 65 } //01 00  \fs20 Bitcoin is a cryptocurrency where
		$a_01_2 = {47 65 74 74 69 6e 67 20 73 74 61 72 74 65 64 20 77 69 74 68 20 42 69 74 63 6f 69 6e 7d 7d 7d 5c 63 66 31 5c 75 6c 6e 6f 6e 65 5c 62 30 5c 66 30 5c 66 73 32 30 5c 70 61 72 } //01 00  Getting started with Bitcoin}}}\cf1\ulnone\b0\f0\fs20\par
		$a_01_3 = {6e 6f 62 6f 64 79 20 61 6e 64 20 6e 65 76 65 72 20 77 69 6c 6c 20 62 65 20 61 62 6c 65 5c 62 30 20 20 74 6f 20 72 65 73 74 6f 72 65 20 66 69 6c 65 73 2e 2e 2e 5c 70 61 72 } //01 00  nobody and never will be able\b0  to restore files...\par
		$a_01_4 = {25 41 4d 4f 55 4e 54 5f 55 53 44 25 20 55 53 44 5c 62 30 20 20 2f 20 5c 62 20 25 41 4d 4f 55 4e 54 5f 45 55 52 25 20 45 55 52 5c 62 30 } //00 00  %AMOUNT_USD% USD\b0  / \b %AMOUNT_EUR% EUR\b0
	condition:
		any of ($a_*)
 
}
rule Ransom_Win32_Crilock_A_2{
	meta:
		description = "Ransom:Win32/Crilock.A,SIGNATURE_TYPE_PEHSTR_EXT,03 00 03 00 07 00 00 01 00 "
		
	strings :
		$a_01_0 = {25 41 4d 4f 55 4e 54 5f 42 54 43 25 00 00 00 00 25 42 49 54 43 4f 49 4e 5f 41 44 44 52 45 53 53 25 00 } //01 00 
		$a_01_1 = {76 65 72 73 69 6f 6e 3d 25 75 26 69 64 3d 25 75 00 } //01 00 
		$a_01_2 = {6d 00 6f 00 6e 00 65 00 79 00 70 00 61 00 6b 00 00 00 70 00 61 00 79 00 73 00 61 00 66 00 65 00 63 00 61 00 72 00 64 00 00 00 75 00 6b 00 61 00 73 00 68 00 00 00 } //01 00 
		$a_01_3 = {54 00 69 00 6d 00 65 00 20 00 6c 00 65 00 66 00 74 00 00 00 25 00 75 00 20 00 3a 00 20 00 25 00 30 00 32 00 75 00 20 00 3a 00 20 00 25 00 30 00 32 00 75 00 00 00 } //01 00 
		$a_01_4 = {43 00 72 00 79 00 70 00 74 00 6f 00 4c 00 6f 00 63 00 6b 00 65 00 72 00 00 00 } //01 00 
		$a_01_5 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 25 00 68 00 73 00 2f 00 31 00 30 00 30 00 32 00 2e 00 65 00 78 00 65 00 00 00 } //01 00 
		$a_01_6 = {59 6f 75 72 20 69 6d 70 6f 72 74 61 6e 74 20 66 69 6c 65 73 20 5c 62 20 65 6e 63 72 79 70 74 69 6f 6e 5c 62 30 20 20 70 72 6f 64 75 63 65 64 20 6f 6e 20 74 68 69 73 20 63 6f 6d 70 75 74 65 72 3a 20 70 68 6f 74 6f 73 2c 20 76 69 64 65 6f 73 2c 20 64 6f 63 75 6d 65 6e 74 73 2c 20 65 74 63 2e } //00 00  Your important files \b encryption\b0  produced on this computer: photos, videos, documents, etc.
		$a_00_7 = {87 10 } //00 00 
	condition:
		any of ($a_*)
 
}