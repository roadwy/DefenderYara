
rule Ransom_Win32_Tescrypt_C{
	meta:
		description = "Ransom:Win32/Tescrypt.C,SIGNATURE_TYPE_PEHSTR_EXT,04 00 03 00 07 00 00 01 00 "
		
	strings :
		$a_01_0 = {0f b7 c0 c1 c2 07 33 d0 83 c1 02 0f b7 01 66 85 c0 75 ed } //01 00 
		$a_01_1 = {3b fb 74 f3 81 ff 00 00 80 13 77 eb } //01 00 
		$a_01_2 = {b9 de ad be ef 39 08 75 05 33 f6 46 eb c6 } //01 00 
		$a_03_3 = {68 8a 01 00 00 68 90 01 04 57 89 9d 90 01 02 ff ff ff d6 85 c0 75 2a 90 00 } //01 00 
		$a_00_4 = {25 00 73 00 5c 00 5f 00 25 00 73 00 5f 00 25 00 73 00 2e 00 54 00 58 00 54 00 } //01 00  %s\_%s_%s.TXT
		$a_00_5 = {25 00 73 00 5c 00 5f 00 25 00 73 00 5f 00 25 00 73 00 2e 00 48 00 54 00 4d 00 4c 00 } //01 00  %s\_%s_%s.HTML
		$a_01_6 = {62 63 64 65 64 69 74 2e 65 78 65 20 2f 73 65 74 20 7b 63 75 72 72 65 6e 74 7d 20 72 65 63 6f 76 65 72 79 65 6e 61 62 6c 65 64 20 6f 66 66 } //00 00  bcdedit.exe /set {current} recoveryenabled off
	condition:
		any of ($a_*)
 
}
rule Ransom_Win32_Tescrypt_C_2{
	meta:
		description = "Ransom:Win32/Tescrypt.C,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 05 00 00 01 00 "
		
	strings :
		$a_01_0 = {2e 74 6f 72 32 77 65 62 } //01 00  .tor2web
		$a_01_1 = {62 63 64 65 64 69 74 2e 65 78 65 20 2f 73 65 74 20 7b 63 75 72 72 65 6e 74 7d 20 62 6f 6f 74 73 74 61 74 75 73 70 6f 6c 69 63 79 20 49 67 6e 6f 72 65 41 6c 6c 46 61 69 6c 75 72 65 73 } //01 00  bcdedit.exe /set {current} bootstatuspolicy IgnoreAllFailures
		$a_01_2 = {62 63 64 65 64 69 74 2e 65 78 65 20 2f 73 65 74 20 7b 63 75 72 72 65 6e 74 7d 20 72 65 63 6f 76 65 72 79 65 6e 61 62 6c 65 64 20 6f 66 66 } //01 00  bcdedit.exe /set {current} recoveryenabled off
		$a_01_3 = {25 00 73 00 5c 00 48 00 4f 00 57 00 54 00 4f 00 5f 00 52 00 45 00 53 00 54 00 4f 00 52 00 45 00 5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 } //01 00  %s\HOWTO_RESTORE_FILES.
		$a_01_4 = {5c 00 72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 66 00 69 00 6c 00 65 00 5f 00 } //00 00  \recover_file_
		$a_00_5 = {78 6d 06 } //00 06 
	condition:
		any of ($a_*)
 
}
rule Ransom_Win32_Tescrypt_C_3{
	meta:
		description = "Ransom:Win32/Tescrypt.C,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 19 00 00 01 00 "
		
	strings :
		$a_00_0 = {25 00 73 00 5c 00 68 00 6f 00 77 00 74 00 6f 00 5f 00 72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 66 00 69 00 6c 00 65 00 73 00 2e 00 74 00 78 00 74 00 00 00 } //01 00 
		$a_00_1 = {25 00 73 00 5c 00 68 00 6f 00 77 00 74 00 6f 00 5f 00 72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 66 00 69 00 6c 00 65 00 73 00 2e 00 62 00 6d 00 70 00 00 00 } //01 00 
		$a_02_2 = {25 00 73 00 5c 00 48 00 4f 00 57 00 54 00 4f 00 5f 00 52 00 45 00 53 00 54 00 4f 00 52 00 45 00 5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 68 00 74 00 6d 00 90 02 01 00 90 00 } //01 00 
		$a_00_3 = {25 00 73 00 5c 00 48 00 4f 00 57 00 54 00 4f 00 5f 00 52 00 45 00 53 00 54 00 4f 00 52 00 45 00 5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 62 00 6d 00 70 00 00 00 } //01 00 
		$a_01_4 = {25 00 73 00 5c 00 76 00 63 00 77 00 25 00 73 00 2e 00 65 00 78 00 65 00 00 00 } //01 00 
		$a_01_5 = {25 00 73 00 5c 00 25 00 73 00 2d 00 61 00 2e 00 65 00 78 00 65 00 00 00 } //01 00 
		$a_01_6 = {72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 66 00 69 00 6c 00 65 00 5f 00 00 00 } //01 00 
		$a_01_7 = {41 6c 6c 20 79 6f 75 72 20 66 69 6c 65 73 20 77 65 72 65 20 65 6e 63 72 79 70 74 65 64 20 77 69 74 68 20 74 68 65 20 70 75 62 6c 69 63 20 6b 65 79 2c 20 77 68 69 63 68 20 68 61 73 20 62 65 65 6e 20 74 72 61 6e 73 66 65 72 72 65 64 20 74 6f 20 79 6f 75 72 20 63 6f 6d 70 75 74 65 72 20 76 69 61 20 74 68 65 20 49 6e 74 65 72 6e 65 74 2e } //01 00  All your files were encrypted with the public key, which has been transferred to your computer via the Internet.
		$a_03_8 = {73 69 74 65 20 28 6f 72 20 54 4f 52 90 03 01 08 20 2d 42 72 6f 77 73 65 72 27 73 29 20 64 69 72 65 63 74 6c 79 29 3a 90 00 } //01 00 
		$a_01_9 = {2e 6f 6e 69 6f 6e 2f 25 53 3c 2f 66 6f 6e 74 3e 3c 62 72 3e } //01 00  .onion/%S</font><br>
		$a_01_10 = {73 75 67 67 65 73 74 20 79 6f 75 20 64 6f 20 6e 6f 74 20 77 61 73 74 65 20 76 61 6c 75 61 62 6c 65 20 74 69 6d 65 20 73 65 61 72 63 68 69 6e 67 20 66 6f 72 20 6f 74 68 65 72 20 73 6f 6c 75 74 69 6f 6e 73 20 62 65 63 61 75 73 65 20 74 68 65 79 20 64 6f 20 6e 6f 74 20 65 78 69 73 74 2e } //01 00  suggest you do not waste valuable time searching for other solutions because they do not exist.
		$a_01_11 = {45 73 70 65 63 69 61 6c 6c 79 20 66 6f 72 20 79 6f 75 2c 20 6f 6e 20 6f 75 72 20 73 65 72 76 65 72 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 74 68 65 20 73 65 63 72 65 74 20 6b 65 79 } //01 00  Especially for you, on our server was generated the secret key
		$a_01_12 = {41 6c 61 73 2c 20 69 66 20 79 6f 75 20 64 6f 20 6e 6f 74 20 74 61 6b 65 20 74 68 65 20 6e 65 63 65 73 73 61 72 79 20 6d 65 61 73 75 72 65 73 20 66 6f 72 20 74 68 65 20 73 70 65 63 69 66 69 65 64 20 74 69 6d 65 20 74 68 65 6e 20 74 68 65 20 63 6f 6e 64 69 74 69 6f 6e 73 20 66 6f 72 20 6f 62 74 61 69 6e 69 6e 67 } //01 00  Alas, if you do not take the necessary measures for the specified time then the conditions for obtaining
		$a_01_13 = {76 73 73 61 00 00 00 00 64 6d 69 6e 2e 65 78 65 00 00 00 00 64 65 6c 65 74 65 00 00 73 68 61 64 6f 77 73 00 00 00 00 00 2f 61 6c 6c 00 00 00 00 00 00 2f 51 75 69 65 74 00 } //01 00 
		$a_01_14 = {53 45 43 52 45 54 20 53 45 52 56 45 52 21 21 21 } //01 00  SECRET SERVER!!!
		$a_01_15 = {74 77 6f 20 77 61 79 73 20 79 6f 75 20 63 61 6e 20 63 68 6f 6f 73 65 3a 20 77 61 69 74 20 66 6f 72 20 61 20 6d 69 72 61 63 6c 65 20 61 6e 64 20 67 65 74 20 79 6f 75 72 20 70 72 69 63 65 20 64 6f 75 62 6c 65 64 2c 20 6f 72 20 73 74 61 72 74 20 6f 62 74 61 69 6e 69 6e 67 20 42 54 43 20 4e 4f 57 2c 20 61 6e 64 20 72 65 73 74 6f 72 65 20 79 6f 75 72 20 64 61 74 61 20 65 61 73 79 20 77 61 79 2e } //01 00  two ways you can choose: wait for a miracle and get your price doubled, or start obtaining BTC NOW, and restore your data easy way.
		$a_00_16 = {69 72 72 65 76 6f 63 61 62 6c 79 20 63 68 61 6e 67 65 64 2c 20 79 6f 75 20 77 69 6c 6c 20 6e 6f 74 20 62 65 20 61 62 6c 65 20 74 6f 20 77 6f 72 6b 20 77 69 74 68 20 74 68 65 6d 2c 20 72 65 61 64 20 74 68 65 6d 20 6f 72 20 73 65 65 20 74 68 65 6d 2c } //01 00  irrevocably changed, you will not be able to work with them, read them or see them,
		$a_03_17 = {59 6f 75 72 20 70 65 72 73 6f 6e 61 6c 20 70 61 67 65 20 28 75 73 69 6e 67 20 54 4f 52 2d 42 72 6f 77 73 65 72 29 3a 20 90 1d 18 00 2e 6f 6e 69 6f 6e 2f 25 53 90 00 } //01 00 
		$a_01_18 = {2d 2d 3e 53 65 63 72 65 74 20 53 65 72 76 65 72 21 21 21 0a } //01 00  ⴭ匾捥敲⁴敓癲牥℡ਡ
		$a_00_19 = {49 66 20 59 6f 75 20 68 61 76 65 20 72 65 61 6c 6c 79 20 76 61 6c 75 61 62 6c 65 20 64 61 74 61 2c 20 79 6f 75 20 62 65 74 74 65 72 20 6e 6f 74 20 77 61 73 74 65 20 79 6f 75 72 20 74 69 6d 65 2c 20 62 65 63 61 75 73 65 20 74 68 65 72 65 20 69 73 20 6e 6f 20 6f 74 68 65 72 20 77 61 79 20 74 6f 20 67 65 74 20 79 6f 75 72 20 66 69 6c 65 73 2c 20 65 78 63 65 70 74 20 6d 61 6b 65 20 61 20 70 61 79 6d 65 6e 74 2e } //01 00  If You have really valuable data, you better not waste your time, because there is no other way to get your files, except make a payment.
		$a_00_20 = {21 21 21 20 53 70 65 63 69 61 6c 6c 79 20 66 6f 72 20 79 6f 75 72 20 50 43 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 70 65 72 73 6f 6e 61 6c 20 52 53 41 2d 34 30 39 36 20 4b 45 59 2c 20 62 6f 74 68 20 70 75 62 6c 69 63 20 61 6e 64 20 70 72 69 76 61 74 65 2e } //01 00  !!! Specially for your PC was generated personal RSA-4096 KEY, both public and private.
		$a_03_21 = {21 21 21 20 59 6f 75 72 20 70 65 72 73 6f 6e 61 6c 20 70 61 67 65 20 69 6e 20 54 4f 52 20 42 72 6f 77 73 65 72 3a 20 90 1d 18 00 2e 6f 6e 69 6f 6e 2f 25 53 90 00 } //01 00 
		$a_00_22 = {5f 00 46 00 49 00 4c 00 45 00 53 00 2e 00 48 00 54 00 4d 00 00 00 00 00 25 00 73 00 5c 00 48 00 6f 00 77 00 74 00 6f 00 5f 00 52 00 65 00 73 00 74 00 6f 00 72 00 65 00 25 00 73 00 00 00 } //01 00 
		$a_00_23 = {2d 2d 3e 20 73 74 72 75 63 74 75 72 65 20 61 6e 64 20 64 61 74 61 20 77 69 74 68 69 6e 20 79 6f 75 72 20 66 69 6c 65 73 20 68 61 76 65 20 62 65 65 6e 20 69 72 72 65 76 6f 63 61 62 6c 79 20 3c 21 2d 2d } //01 00  --> structure and data within your files have been irrevocably <!--
		$a_02_24 = {2d 2d 3e 53 65 63 72 65 74 20 20 3c 21 2d 2d 90 02 30 2d 2d 3e 53 65 72 76 65 72 21 21 21 0a 90 00 } //00 00 
		$a_00_25 = {7e 15 00 00 } //03 18 
	condition:
		any of ($a_*)
 
}