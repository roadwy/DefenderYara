
rule Ransom_Win32_Tescrypt_D{
	meta:
		description = "Ransom:Win32/Tescrypt.D,SIGNATURE_TYPE_PEHSTR_EXT,06 00 06 00 06 00 00 "
		
	strings :
		$a_03_0 = {99 b9 7a 00 00 00 f7 f9 8b f2 83 fe 61 7c ec 6a 01 e8 ?? ?? ?? ?? 8b 55 08 83 c4 04 6a 0f 66 89 34 7a ff 15 ?? ?? ?? ?? 47 3b fb 7c 90 09 1f 00 [0-0f] ff 15 ?? ?? ?? ?? 50 e8 } //2
		$a_03_1 = {52 ff d7 83 c4 08 85 c0 74 16 68 42 a8 6f 9e 6a 01 6a 00 e8 ?? ?? ?? ?? 83 c4 0c 6a 00 56 ff d0 90 09 05 00 68 } //2
		$a_01_2 = {4e 4f 54 20 59 4f 55 52 20 4c 41 4e 47 55 41 47 45 3f 20 55 53 45 20 3c 61 20 68 72 65 66 3d 22 68 74 74 70 73 3a 2f 2f 74 72 61 6e 73 6c 61 74 65 2e 67 6f 6f 67 6c 65 2e 63 6f 6d 22 } //1 NOT YOUR LANGUAGE? USE <a href="https://translate.google.com"
		$a_02_3 = {59 6f 75 72 20 70 65 72 73 6f 6e 61 6c 20 [0-09] 54 4f 52 ?? 42 72 6f 77 73 65 72 [0-05] 20 ?? ?? ?? ?? ?? ?? ?? ?? [0-08] 2e 6f 6e 69 6f 6e 2f 25 53 } //1
		$a_01_4 = {68 00 65 00 6c 00 70 00 5f 00 72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 69 00 6e 00 73 00 74 00 72 00 75 00 63 00 74 00 69 00 6f 00 6e 00 73 00 00 00 } //1
		$a_00_5 = {00 00 5c 00 72 00 65 00 63 00 6f 00 76 00 65 00 72 00 5f 00 66 00 69 00 6c 00 65 00 5f 00 00 00 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*2+(#a_01_2  & 1)*1+(#a_02_3  & 1)*1+(#a_01_4  & 1)*1+(#a_00_5  & 1)*1) >=6
 
}