
rule Ransom_Win32_Mespinoza_SB{
	meta:
		description = "Ransom:Win32/Mespinoza.SB,SIGNATURE_TYPE_PEHSTR_EXT,65 00 65 00 04 00 00 "
		
	strings :
		$a_03_0 = {[] 4[] 1[]  [] 8[] 4[]  [] c[] 0[]  [] 7[] 5[]  [] ?[] ?[]  [] 2[] b[]  [] c[] e[]  [] 8[] b[]  [] 3[] 5[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] 8[] d[]  [] 4[] 1[]  [] 0[] 1[]  [] 5[] 0[]  [] [[] 5[] 0[] -[] 5[] f[] ][]  [] 6[] a[]  [] 0[] 7[]  [] 6[] a[]  [] 0[] 0[]  [] 6[] 8[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] f[] f[]  [] 9[] 0[]  [] 0[] 4[]  [] 0[] 1[]  [] 0[] 3[]  [] 7[] [[] f[]  [] 9[] 0[]  [] 0[] 4[]  [] 0[] ][]  [] 1[]  [] 0[] 3[]  [] d[] 0[]  [] 2[] d[]  [] d[] f[]  [] 6[] [[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] 6[] ][]  [] a[]  [] 0[] 7[]  [] 6[] a[]  [] 0[] 0[]  [] 6[] 8[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] f[] f[]  [] 9[] 0[]  [] 0[] 4[]  [] 0[] 1[]  [] 0[] 3[]  [] 7[] [[] f[]  [] 9[] 0[]  [] 0[] 4[]  [] 0[] ][]  [] 1[]  [] 0[] 3[]  [] d[] [[] 0[]  [] 0[] 4[]  [] 0[] 1[]  [] 0[] ][]  [] 3[]  [] 7[] 0[]  [] 2[] d[]  [] 7[] f[]  [] ?[] ?[]  [] f[] [[] ?[]  [] ?[] ?[]  [] 8[] b[]  [] 9[] ][]  [] 0[]  [] 0[] 4[]  [] 0[] 1[]  [] 0[] 3[]  [] 4[] [[] 3[]  [] c[] d[]  [] 5[] e[]  [] e[] ][]  [] 8[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] ?[] ?[]  [] 8[] b[]  [] e[] 5[]  [] 5[] d[]  [] c[] 3[]  [] 9[] 0[]  [] 0[] a[]  [] 4[] [[] 4[]  [] 0[] 1[]  [] 0[] 3[]  [] 0[] ][]  [] 0[]  [] 2[] d[]  [] 0[] f[]  [] } //100
		$a_80_1 = {6e 2e 70 79 73 61 } //n.pysa  1
		$a_81_2 = {25 73 5c 52 65 61 64 6d 65 2e 52 45 41 44 4d 45 } //1 %s\Readme.README
		$a_81_3 = {45 76 65 72 79 20 62 79 74 65 20 6f 6e 20 61 6e 79 20 74 79 70 65 73 20 6f 66 20 79 6f 75 72 20 64 65 76 69 63 65 73 20 77 61 73 20 65 6e 63 72 79 70 74 65 64 2e } //1 Every byte on any types of your devices was encrypted.
	condition:
		((#a_03_0  & 1)*100+(#a_80_1  & 1)*1+(#a_81_2  & 1)*1+(#a_81_3  & 1)*1) >=101
 
}