
rule Trojan_WinNT_Stuxnet_A{
	meta:
		description = "Trojan:WinNT/Stuxnet.A,SIGNATURE_TYPE_PEHSTR_EXT,06 00 04 00 06 00 00 "
		
	strings :
		$a_03_0 = {8d 34 19 3b f2 73 42 80 38 e8 75 0f 8b 70 01 8d 74 06 05 3b 35 ?? ?? ?? ?? 74 0e 41 48 83 f9 78 72 de } //3
		$a_03_1 = {76 50 0f b7 c3 6b c0 28 8d 14 30 e8 ?? ?? ?? ff 84 c0 74 31 8b 42 08 8b 4a 10 3b c1 73 02 } //3
		$a_03_2 = {81 e6 00 f0 ff ff eb 06 81 ee 00 10 00 00 56 ff 74 24 0c e8 ?? 00 00 00 59 59 85 c0 75 [0-0a] 56 8b 74 24 0c b8 4d 5a 00 00 66 39 06 } //3
		$a_03_3 = {a9 00 00 00 20 74 41 a8 20 74 3d a9 00 00 00 40 74 36 6a 08 59 bf ?? ?? ?? ?? 8b f2 33 c0 f3 a6 } //3
		$a_03_4 = {6e 74 6f 73 6b 72 6e 6c 2e 65 78 65 [0-08] 6e 74 6b 72 6e 6c 70 61 2e 65 78 65 } //1
		$a_01_5 = {2e 74 65 78 74 00 00 00 50 41 47 45 00 } //1
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*3+(#a_03_2  & 1)*3+(#a_03_3  & 1)*3+(#a_03_4  & 1)*1+(#a_01_5  & 1)*1) >=4
 
}