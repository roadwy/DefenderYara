
rule Trojan_O97M_Obfuse_RKA_eml{
	meta:
		description = "Trojan:O97M/Obfuse.RKA!eml,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 04 00 00 "
		
	strings :
		$a_02_0 = {63 3a 5c 4e 69 6c 57 69 6e 5c 4e 69 6c 57 69 6e 74 2e 62 61 74 22 2c 20 54 72 75 65 29 90 0a 2e 00 2e 43 72 65 61 74 65 54 65 78 74 46 69 6c 65 28 22 90 00 } //1
		$a_00_1 = {2e 43 72 65 61 74 65 54 65 78 74 46 69 6c 65 28 43 68 72 28 39 39 29 20 26 20 43 68 72 28 35 38 29 20 26 20 43 68 72 28 39 32 29 20 26 20 43 68 72 28 37 38 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 30 38 29 20 26 20 43 68 72 28 38 37 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 31 30 29 20 26 20 43 68 72 28 39 32 29 20 26 20 43 68 72 28 37 38 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 30 38 29 20 26 20 43 68 72 28 38 37 29 20 26 20 43 68 72 28 31 30 35 29 20 26 20 43 68 72 28 31 31 30 29 20 26 20 43 68 72 28 31 31 36 29 20 26 20 43 68 72 28 34 36 29 20 26 20 43 68 72 28 31 31 38 29 20 26 20 43 68 72 28 39 38 29 20 26 20 43 68 72 28 31 31 35 29 2c 20 54 72 75 65 29 } //1 .CreateTextFile(Chr(99) & Chr(58) & Chr(92) & Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(92) & Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(116) & Chr(46) & Chr(118) & Chr(98) & Chr(115), True)
		$a_00_2 = {44 65 6c 65 74 65 46 69 6c 65 20 3d 20 22 63 3a 5c 4e 69 6c 57 69 6e 5c 4e 69 6c 57 69 6e 74 2e 62 61 74 22 } //1 DeleteFile = "c:\NilWin\NilWint.bat"
		$a_00_3 = {63 3a 5c 4e 69 6c 57 69 6e 5c 4e 69 6c 57 69 6e 74 2e 76 62 73 } //1 c:\NilWin\NilWint.vbs
	condition:
		((#a_02_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1) >=3
 
}