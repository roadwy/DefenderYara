
rule Trojan_O97M_Cactustorch_A{
	meta:
		description = "Trojan:O97M/Cactustorch.A,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {26 20 22 4e 57 4d 31 4e 6a 45 35 4d 7a 52 6c 4d 44 67 35 42 68 51 41 41 41 41 48 64 47 46 79 5a 32 56 30 4d 41 6b 47 41 41 41 41 42 68 59 41 41 41 41 61 55 33 6c 7a 64 47 56 74 4c 6c 4a 6c 5a 6d 78 6c 59 33 52 70 62 32 34 75 51 58 4e 7a 22 } //1 & "NWM1NjE5MzRlMDg5BhQAAAAHdGFyZ2V0MAkGAAAABhYAAAAaU3lzdGVtLlJlZmxlY3Rpb24uQXNz"
		$a_01_1 = {26 20 22 59 57 30 67 59 32 46 75 62 6d 39 30 49 47 4a 6c 49 48 4a 31 62 69 42 70 62 69 42 45 54 31 4d 67 62 57 39 6b 5a 53 34 4e 44 51 6f 6b 41 41 41 41 41 41 41 41 41 46 42 46 41 41 42 4d 41 51 4d 41 4c 50 6b 5a 57 51 41 41 41 41 41 41 22 } //1 & "YW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZS4NDQokAAAAAAAAAFBFAABMAQMALPkZWQAAAAAA"
		$a_01_2 = {26 20 22 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 43 41 41 41 41 41 44 68 2b 36 44 67 43 30 43 63 30 68 75 41 46 4d 7a 53 46 55 61 47 6c 7a 49 48 42 79 62 32 64 79 22 } //1 & "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAADh+6DgC0Cc0huAFMzSFUaGlzIHByb2dy"
		$a_01_3 = {26 20 22 41 77 41 41 41 41 68 45 5a 57 78 6c 5a 32 46 30 5a 51 64 30 59 58 4a 6e 5a 58 51 77 42 32 31 6c 64 47 68 76 5a 44 41 44 41 77 4d 77 55 33 6c 7a 64 47 56 74 4c 6b 52 6c 62 47 56 6e 59 58 52 6c 55 32 56 79 61 57 46 73 61 58 70 68 22 } //1 & "AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph"
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}