
rule Trojan_AndroidOS_Boqx_A_MTB{
	meta:
		description = "Trojan:AndroidOS/Boqx.A!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_03_0 = {12 00 38 07 53 00 1a 01 ?? ?? 1a 04 ?? ?? 1a 05 00 00 6e 30 ?? ?? 42 05 0c 02 22 04 ?? ?? 71 10 ?? ?? 01 00 0c 05 70 20 ?? ?? 54 00 1a 05 ?? ?? 6e 20 ?? ?? 52 00 0a 05 6e 20 ?? ?? 52 00 0c 05 6e 20 ?? ?? 54 00 0c 04 6e 10 ?? ?? 04 00 0c 01 12 04 1a 05 ?? ?? 6e 20 ?? ?? 52 00 0a 05 6e 30 ?? ?? 42 05 0c 02 22 03 ?? ?? 70 20 ?? ?? 13 00 6e 10 ?? ?? 03 00 0c 00 1f 00 } //1
		$a_00_1 = {67 65 74 46 69 6c 65 42 79 55 72 6c } //1 getFileByUrl
		$a_00_2 = {69 73 50 72 65 66 65 72 72 65 64 41 50 4e 43 6d 77 61 70 } //1 isPreferredAPNCmwap
	condition:
		((#a_03_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1) >=3
 
}