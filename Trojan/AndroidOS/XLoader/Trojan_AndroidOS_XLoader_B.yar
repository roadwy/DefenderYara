
rule Trojan_AndroidOS_XLoader_B{
	meta:
		description = "Trojan:AndroidOS/XLoader.B,SIGNATURE_TYPE_DEXHSTR_EXT,04 00 04 00 03 00 00 "
		
	strings :
		$a_00_0 = {63 32 56 30 51 32 39 74 63 47 39 75 5a 57 35 30 52 57 35 68 59 6d 78 6c 5a 46 4e 6c 64 48 52 70 62 6d 63 3d } //1 c2V0Q29tcG9uZW50RW5hYmxlZFNldHRpbmc=
		$a_01_1 = {2e 4c 6f 61 64 65 72 } //1 .Loader
		$a_03_2 = {07 00 22 00 [0-0c] 70 10 ?? ?? 00 00 6e 10 ?? ?? 07 00 0c 01 [0-0a] 6e 10 ?? ?? 01 00 0c 01 [0-0a] 6e 20 ?? ?? 10 00 62 01 [0-0c] 6e 20 ?? ?? 10 00 1a 01 [0-0c] 6e 20 ?? ?? 10 00 6e 10 ?? ?? 00 00 0c 00 [0-0a] 22 01 [0-0c] 70 20 ?? ?? 01 00 6e 10 ?? ?? 01 00 0a 00 [0-0a] 38 00 [0-0c] 6e 10 ?? ?? 01 00 22 00 [0-0c] 70 10 ?? ?? 00 00 6e 10 ?? ?? 07 00 0c 02 [0-0a] 1a 03 [0-0c] ?? ?? ?? ?? 32 00 0c 02 [0-0a] 16 03 04 00 [0-0a] 6e 30 ?? ?? 32 04 22 03 [0-0c] 70 20 ?? ?? 23 00 13 02 00 08 [0-0a] 23 22 [0-0c] 6e 20 ?? ?? 23 00 0a 04 [0-0a] 12 f5 [0-0a] 12 06 [0-e4] 00 00 6e 10 ?? ?? 01 00 0c 00 [0-0a] 70 20 ?? ?? 07 00 0e 00 [0-0a] 6e 40 ?? ?? 20 46 } //2
	condition:
		((#a_00_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*2) >=4
 
}