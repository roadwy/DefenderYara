
rule Trojan_Win32_Medfos_B{
	meta:
		description = "Trojan:Win32/Medfos.B,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 05 00 00 "
		
	strings :
		$a_03_0 = {66 c7 45 e0 68 00 (66 c7 45 e2 74 00|e9 90 16 66 c7 45 e2 74 00) 90 03 06 09 66 c7 45 e4 74 00 e9 90 16 66 c7 45 e4 74 00 } //10
		$a_03_1 = {81 fe 66 66 66 06 (89 75 fc|e9 90 16 89 75 fc) } //1
		$a_03_2 = {3d 66 66 66 06 (0f 86|e9 90 16 0f 86) } //1
		$a_03_3 = {3d 66 66 66 06 (76|e9 90 16 76) } //1
		$a_03_4 = {c7 45 f4 2e 00 00 00 (89 5d f8|e9 90 16 90 03 03 06 89 5d f8 e9 90 16 89 5d f8) 90 03 02 0e 6a 0a e9 90 16 90 03 02 05 6a 0a e9 90 16 6a 0a 90 03 03 06 8d 45 ec e9 90 16 8d 45 ec 90 03 01 04 50 e9 90 16 50 90 03 02 0e 8b cb e9 90 16 90 03 02 05 8b cb e9 90 16 8b cb } //10
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*10) >=21
 
}
rule Trojan_Win32_Medfos_B_2{
	meta:
		description = "Trojan:Win32/Medfos.B,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 05 00 00 "
		
	strings :
		$a_03_0 = {66 c7 45 ec 68 00 (66 c7 45 ee 74 00|e9 90 16 66 c7 45 ee 74 00) 90 03 06 09 66 c7 45 f0 74 00 e9 90 16 66 c7 45 f0 74 00 } //10
		$a_03_1 = {81 fe 66 66 66 06 (89 75 fc|e9 90 16 89 75 fc) } //1
		$a_03_2 = {3d 66 66 66 06 (0f 86|e9 90 16 0f 86) } //1
		$a_03_3 = {3d 66 66 66 06 (76|e9 90 16 76) } //1
		$a_03_4 = {c7 45 fc 2e 00 00 00 (33 db|e9 90 16 90 03 02 05 33 db e9 90 16 33 db) 90 03 02 0e 6a 0a e9 90 16 90 03 02 05 6a 0a e9 90 16 6a 0a 90 03 03 06 8d 45 f4 e9 90 16 8d 45 f4 90 03 01 04 50 e9 90 16 50 90 03 03 10 8b 45 0c e9 90 16 90 03 03 06 8b 45 0c e9 90 16 8b 45 0c } //10
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*10) >=21
 
}