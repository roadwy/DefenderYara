
rule Trojan_Win32_Trickbot_AT{
	meta:
		description = "Trojan:Win32/Trickbot.AT,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 0b 00 00 "
		
	strings :
		$a_03_0 = {0c 41 41 41 41 90 09 1c 00 81 90 01 01 41 41 41 41 75 90 01 01 81 90 01 01 04 41 41 41 41 75 90 01 01 81 90 01 01 08 41 41 41 41 75 90 00 } //1
		$a_03_1 = {55 41 56 56 57 53 48 83 ec 90 02 80 8b 90 01 01 48 90 01 01 8b 90 01 01 40 90 01 01 8b 90 01 01 38 90 01 01 8b 90 01 01 30 90 01 01 8b 90 01 01 28 90 01 01 8b 90 01 01 20 90 01 01 8b 90 01 01 10 90 01 01 8b 90 01 01 18 90 00 } //1
		$a_01_2 = {48 83 e4 f0 48 8b 75 50 48 85 f6 74 40 48 8b 45 48 8b 4d 40 48 89 56 70 4c 89 46 78 4c 89 8e 80 00 00 00 } //1
		$a_01_3 = {48 8b 45 48 8b 4d 40 48 89 56 70 4c 89 46 78 4c 89 8e 80 00 00 00 8b c9 48 89 8e 88 00 00 00 48 89 86 90 00 00 00 48 89 b6 98 00 00 00 48 8b 4e 10 ff 56 30 48 8b 4e 10 ba ff ff ff ff ff 56 20 } //1
		$a_01_4 = {8b 74 24 10 8b 44 16 24 8d 04 58 0f b7 0c 10 8b 44 16 1c 8d 04 88 8b 04 10 03 c2 eb db 4d 5a 80 } //1
		$a_03_5 = {6a 00 e2 fc 48 8b 90 01 02 48 8b 90 01 01 48 05 90 01 04 48 89 90 01 03 48 89 90 01 02 48 89 90 01 02 48 c7 90 01 02 ff 00 00 90 00 } //2
		$a_80_6 = {48 4a 49 41 2f 43 42 2b 46 47 4b 4c 4e 4f 50 33 52 53 6c 55 56 57 58 59 5a 66 62 63 64 65 61 67 68 69 35 6b 6d 6e 30 70 71 72 73 74 75 76 77 78 38 39 6f 31 32 34 36 37 } //HJIA/CB+FGKLNOP3RSlUVWXYZfbcdeaghi5kmn0pqrstuvwx89o12467  2
		$a_81_7 = {2f 35 2f 73 70 6b 2f } //1 /5/spk/
		$a_81_8 = {70 77 67 72 61 62 } //1 pwgrab
		$a_00_9 = {00 6d 63 63 6f 6e 66 00 } //1 洀捣湯f
		$a_81_10 = {2f 25 73 2f 25 73 2f 35 2f 25 73 2f } //1 /%s/%s/5/%s/
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_03_5  & 1)*2+(#a_80_6  & 1)*2+(#a_81_7  & 1)*1+(#a_81_8  & 1)*1+(#a_00_9  & 1)*1+(#a_81_10  & 1)*1) >=5
 
}