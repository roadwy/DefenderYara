
rule Trojan_Win32_Emotet_K{
	meta:
		description = "Trojan:Win32/Emotet.K,SIGNATURE_TYPE_PEHSTR_EXT,09 00 09 00 06 00 00 "
		
	strings :
		$a_03_0 = {55 54 89 1d bc ?? ?? 00 8f 05 c4 ?? ?? 00 83 05 c4 ?? ?? 00 08 83 2d c4 ?? ?? 00 04 8f 05 c0 ?? ?? 00 a1 c8 ?? ?? 00 83 05 c4 ?? ?? 00 04 83 2d c4 ?? ?? 00 04 89 35 b4 ?? ?? 00 89 3d b8 ?? ?? 00 ff e0 cc ff 25 } //8
		$a_03_1 = {b9 00 d0 00 00 [0-20] c7 04 24 00 00 00 00 } //1
		$a_03_2 = {c7 04 24 00 00 00 00 [0-20] c7 44 24 04 00 d0 00 00 } //1
		$a_03_3 = {c7 44 24 04 00 d0 00 00 [0-20] c7 44 24 0c 40 00 00 00 } //1
		$a_03_4 = {c7 40 0c 40 00 00 00 [0-20] c7 40 08 00 10 00 00 } //1
		$a_03_5 = {c7 40 04 00 d0 00 00 [0-20] c7 00 00 00 00 00 } //1
	condition:
		((#a_03_0  & 1)*8+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1) >=9
 
}
rule Trojan_Win32_Emotet_K_2{
	meta:
		description = "Trojan:Win32/Emotet.K,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {8b 55 e4 33 c0 33 c9 8d 64 24 00 3d 40 af a6 00 76 0d 81 fa 0f 2c 02 00 74 05 b9 6c 00 00 00 40 83 f9 6c 75 e6 } //1
		$a_03_1 = {8a 04 1e 88 04 3e 46 3b 75 f8 72 e0 8d 45 f8 8b d7 e8 ?? ?? ff ff ff 55 f0 5f 5e 33 c0 } //1
		$a_01_2 = {8d 3c 02 33 f7 2b ce be 01 00 00 00 81 c2 47 86 c8 61 29 75 fc 75 b2 8b 55 f8 89 0a 89 42 04 83 c2 08 29 75 f4 89 55 f8 75 8e } //1
		$a_01_3 = {6a 00 ff d7 81 fe cb 24 19 00 7e 1f 81 7d f0 e4 86 00 00 74 16 81 7d f0 1c 23 01 00 74 0d 0f b7 45 c8 3d 40 e2 01 00 74 02 } //3
		$a_00_4 = {43 00 3a 00 5c 00 42 00 6f 00 73 00 64 00 69 00 73 00 61 00 6d 00 73 00 61 00 64 00 70 00 66 00 61 00 73 00 6b 00 66 00 6d 00 6e 00 2e 00 74 00 78 00 74 00 } //1 C:\Bosdisamsadpfaskfmn.txt
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*3+(#a_00_4  & 1)*1) >=5
 
}
rule Trojan_Win32_Emotet_K_3{
	meta:
		description = "Trojan:Win32/Emotet.K,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 07 00 00 "
		
	strings :
		$a_01_0 = {74 5e c1 ef 02 33 c0 53 33 db 8d 14 be 8b fa 2b fe 83 c7 03 c1 ef 02 3b f2 0f 47 f8 85 ff 74 37 } //1
		$a_01_1 = {8d 49 08 33 55 08 8d 76 04 0f b6 c2 43 66 89 41 f8 8b c2 c1 e8 08 0f b6 c0 66 89 41 fa c1 ea 10 0f b6 c2 66 89 41 fc c1 ea 08 0f b6 c2 66 89 41 fe 3b df 72 c9 } //1
		$a_03_2 = {8d 44 24 0c ba 0c 00 00 00 50 68 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ff ff 8b ?? 24 14 83 c4 08 ?? ff 15 ?? ?? ?? ?? 85 c0 74 1b 68 } //1
		$a_03_3 = {8d 45 f8 ba 0c 00 00 00 50 68 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ff ff 8b 75 f8 68 } //1
		$a_03_4 = {83 c0 04 c7 85 cc fb ff ff 04 01 00 00 89 85 c4 fb ff ff 57 c7 00 00 00 00 00 8d 85 dc fb ff ff 50 68 ?? ?? ?? ?? e8 be db ff ff 8d 85 d0 fb ff ff ba 28 00 00 00 50 68 } //1
		$a_03_5 = {8d 45 f8 ba 04 00 00 00 50 68 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 75 f8 8d ?? ?? ?? ?? ff 68 } //1
		$a_03_6 = {75 2a 8d 04 5d 02 00 00 00 50 8d ?? ?? ?? ?? ff 50 6a 01 6a 00 68 ?? ?? ?? ?? ff 75 f4 ff 15 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1) >=4
 
}