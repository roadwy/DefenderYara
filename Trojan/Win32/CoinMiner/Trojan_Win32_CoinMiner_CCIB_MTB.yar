
rule Trojan_Win32_CoinMiner_CCIB_MTB{
	meta:
		description = "Trojan:Win32/CoinMiner.CCIB!MTB,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 05 00 00 "
		
	strings :
		$a_01_0 = {34 37 2e 39 36 2e 38 36 2e 38 31 } //1 47.96.86.81
		$a_01_1 = {77 6d 69 63 20 70 72 6f 63 65 73 73 20 20 67 65 74 20 4e 61 6d 65 2c 45 78 65 63 75 74 61 62 6c 65 50 61 74 68 2c 50 72 6f 63 65 73 73 49 64 2c 50 61 72 65 6e 74 50 72 6f 63 65 73 73 49 64 20 2f 76 61 6c 75 65 } //1 wmic process  get Name,ExecutablePath,ProcessId,ParentProcessId /value
		$a_01_2 = {43 3a 5c 57 69 6e 64 6f 77 73 5c 53 79 73 74 65 6d 33 32 5c 74 61 73 6b 6b 69 6c 6c 2e 65 78 65 20 2f 54 20 2f 46 20 2f 50 49 44 } //1 C:\Windows\System32\taskkill.exe /T /F /PID
		$a_01_3 = {63 3a 5c 77 69 6e 64 6f 77 73 5c 70 72 6f 63 65 73 73 2e 74 78 74 } //1 c:\windows\process.txt
		$a_01_4 = {39 38 20 34 39 20 31 32 31 20 31 30 35 20 35 31 20 39 37 20 31 31 32 20 31 31 32 20 31 31 32 20 35 36 20 35 31 20 39 39 20 31 30 36 20 31 32 30 20 31 31 39 20 31 30 36 20 31 31 39 20 31 32 30 20 35 34 20 31 30 34 20 35 37 20 35 32 20 39 37 20 31 30 36 20 34 39 20 31 30 36 20 34 39 20 31 31 35 20 31 31 37 20 31 31 37 20 31 30 33 20 31 32 31 20 31 30 37 20 31 32 32 20 31 30 34 20 35 36 20 31 32 32 20 39 39 20 31 30 31 20 35 36 20 31 30 35 20 35 30 20 31 30 39 20 35 32 20 31 30 37 20 35 36 20 31 30 30 20 35 30 20 35 34 20 35 37 20 39 38 20 35 30 20 31 32 31 20 31 30 30 20 35 34 20 31 30 30 20 35 36 20 34 38 20 34 38 20 35 36 20 31 32 32 20 31 30 35 20 31 32 31 20 35 30 } //1 98 49 121 105 51 97 112 112 112 56 51 99 106 120 119 106 119 120 54 104 57 52 97 106 49 106 49 115 117 117 103 121 107 122 104 56 122 99 101 56 105 50 109 52 107 56 100 50 54 57 98 50 121 100 54 100 56 48 48 56 122 105 121 50
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1) >=5
 
}