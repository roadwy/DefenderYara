
rule Trojan_Win32_Scar_A{
	meta:
		description = "Trojan:Win32/Scar.A,SIGNATURE_TYPE_PEHSTR_EXT,2c 00 2c 00 09 00 00 "
		
	strings :
		$a_00_0 = {43 61 6c 6c 4e 65 78 74 48 6f 6f 6b 45 78 } //1 CallNextHookEx
		$a_00_1 = {52 65 67 69 73 74 65 72 48 6f 74 4b 65 79 } //1 RegisterHotKey
		$a_00_2 = {53 65 6e 64 4d 65 73 73 61 67 65 41 } //1 SendMessageA
		$a_00_3 = {23 33 32 37 37 30 } //1 #32770
		$a_00_4 = {50 72 6f 67 72 61 6d 20 4d 61 6e 61 67 65 72 } //1 Program Manager
		$a_00_5 = {00 6f 70 65 6e 00 65 78 70 6c 6f 72 65 72 2e 65 78 65 } //10 漀数n硥汰牯牥攮數
		$a_00_6 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 5c 00 43 00 75 00 72 00 72 00 65 00 6e 00 74 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 5c 00 57 00 69 00 6e 00 6c 00 6f 00 67 00 6f 00 6e 00 } //10 SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
		$a_00_7 = {5c 00 75 00 73 00 72 00 69 00 6e 00 69 00 74 00 2e 00 65 00 78 00 65 00 } //10 \usrinit.exe
		$a_02_8 = {db e2 9b 0f 01 e0 a8 08 75 f9 0f 01 e0 a8 02 74 f9 68 ?? ?? 40 00 e8 ?? ?? 00 00 6b c0 02 8b c8 a0 ?? ?? 40 00 8d 3d ?? ?? 40 00 80 3f 00 74 02 30 07 } //10
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*10+(#a_00_6  & 1)*10+(#a_00_7  & 1)*10+(#a_02_8  & 1)*10) >=44
 
}