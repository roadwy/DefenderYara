
rule Trojan_Win32_OilRig_A_MSR{
	meta:
		description = "Trojan:Win32/OilRig.A!MSR,SIGNATURE_TYPE_PEHSTR_EXT,0b 00 0b 00 04 00 00 05 00 "
		
	strings :
		$a_01_0 = {5c 65 78 65 72 75 6e 65 72 5c 65 78 65 72 75 6e 65 72 } //05 00  \exeruner\exeruner
		$a_01_1 = {72 00 55 00 70 00 64 00 61 00 74 00 65 00 43 00 68 00 65 00 63 00 6b 00 65 00 72 00 2e 00 70 00 73 00 31 00 } //01 00  rUpdateChecker.ps1
		$a_01_2 = {2f 00 63 00 20 00 70 00 6f 00 77 00 65 00 72 00 73 00 68 00 65 00 6c 00 6c 00 20 00 2d 00 65 00 78 00 65 00 63 00 20 00 62 00 79 00 70 00 61 00 73 00 73 00 20 00 2d 00 77 00 69 00 6e 00 64 00 6f 00 77 00 20 00 68 00 69 00 64 00 64 00 65 00 6e 00 20 00 2d 00 6e 00 6f 00 6c 00 6f 00 67 00 6f 00 20 00 2d 00 63 00 6f 00 6d 00 6d 00 61 00 6e 00 64 00 } //01 00  /c powershell -exec bypass -window hidden -nologo -command
		$a_01_3 = {73 00 63 00 68 00 74 00 61 00 73 00 6b 00 73 00 20 00 2f 00 63 00 72 00 65 00 61 00 74 00 65 00 20 00 2f 00 46 00 20 00 2f 00 72 00 75 00 20 00 53 00 59 00 53 00 54 00 45 00 4d 00 20 00 2f 00 73 00 63 00 20 00 6d 00 69 00 6e 00 75 00 74 00 65 00 20 00 2f 00 6d 00 6f 00 20 00 31 00 20 00 2f 00 74 00 6e 00 20 00 22 00 5c 00 55 00 70 00 64 00 61 00 74 00 65 00 54 00 61 00 73 00 6b 00 73 00 5c 00 4a 00 61 00 76 00 61 00 55 00 70 00 64 00 61 00 74 00 65 00 73 00 22 00 20 00 2f 00 74 00 72 00 20 00 22 00 77 00 73 00 63 00 72 00 69 00 70 00 74 00 20 00 2f 00 62 00 20 00 5c 00 } //00 00  schtasks /create /F /ru SYSTEM /sc minute /mo 1 /tn "\UpdateTasks\JavaUpdates" /tr "wscript /b \
	condition:
		any of ($a_*)
 
}