
rule Trojan_Win32_Nebuler_G{
	meta:
		description = "Trojan:Win32/Nebuler.G,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 07 00 00 "
		
	strings :
		$a_03_0 = {8b 4d 0c 8a 4c 01 01 8b 55 08 80 f1 ?? 88 0c 10 40 3b c6 72 eb 8b 45 08 5f c6 04 06 00 5e 5b c9 c2 08 00 } //4
		$a_03_1 = {33 ff 85 f6 89 45 f8 76 20 8b 55 fc 8b cb 2b d3 8b de 8a 04 0a 32 87 ?? ?? ?? ?? 47 3b 7d f8 88 01 75 02 33 ff 41 4b 75 e9 33 c0 85 f6 76 15 } //4
		$a_03_2 = {8a 11 33 c0 84 d2 74 1a 53 56 8b f7 2b f1 8a d8 80 eb ?? 32 da 88 1c 0e 40 41 8a 11 84 d2 75 ee 5e 5b c6 04 38 00 8b c7 c3 } //4
		$a_01_3 = {49 73 44 65 62 75 67 67 65 72 50 72 65 73 65 6e 74 } //1 IsDebuggerPresent
		$a_01_4 = {63 3d 49 25 64 } //1 c=I%d
		$a_01_5 = {52 61 73 45 6e 75 6d 44 65 76 69 63 65 73 41 00 5b 6d 6f 64 65 6d 5d 00 5b 62 72 61 6e 64 5d 00 5b 76 65 72 73 69 6f 6e 5d } //1
		$a_03_6 = {53 68 75 74 64 6f 77 6e ?? ?? ?? ?? 53 74 61 72 74 75 70 ?? ?? ?? ?? 54 65 73 74 90 09 19 00 2e 64 6c 6c ?? ?? ?? ?? 49 6e 73 74 ?? ?? ?? ?? 52 75 6e } //5
	condition:
		((#a_03_0  & 1)*4+(#a_03_1  & 1)*4+(#a_03_2  & 1)*4+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_03_6  & 1)*5) >=8
 
}