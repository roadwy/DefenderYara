
rule Trojan_Win32_Trufout_A{
	meta:
		description = "Trojan:Win32/Trufout.A,SIGNATURE_TYPE_PEHSTR_EXT,22 00 22 00 07 00 00 "
		
	strings :
		$a_01_0 = {53 0f 01 4c 24 fe 5b 83 c3 28 66 8b 53 06 c1 e2 10 66 8b 13 8d } //5
		$a_01_1 = {66 89 03 c1 e8 10 66 89 43 06 1e 06 cd 05 } //5
		$a_01_2 = {07 1f 66 89 13 c1 ea 10 66 89 53 06 68 00 80 } //5
		$a_01_3 = {48 6f 6f 6b 48 61 6e 64 6c 65 72 00 53 77 69 74 63 68 4f 66 66 00 53 77 69 74 63 68 4f 6e 00 00 } //2
		$a_01_4 = {6e 46 69 6c 65 00 4e 74 4f 70 65 6e 50 72 6f 63 65 73 73 00 4e 74 51 75 65 72 79 44 69 72 65 63 } //2 䙮汩e瑎灏湥牐捯獥s瑎畑牥䑹物捥
		$a_01_5 = {10 ac 3c b8 75 2a aa a5 8b 3d } //2
		$a_00_6 = {47 65 74 43 75 72 72 65 6e 74 50 72 6f 63 65 73 73 49 64 } //20 GetCurrentProcessId
	condition:
		((#a_01_0  & 1)*5+(#a_01_1  & 1)*5+(#a_01_2  & 1)*5+(#a_01_3  & 1)*2+(#a_01_4  & 1)*2+(#a_01_5  & 1)*2+(#a_00_6  & 1)*20) >=34
 
}