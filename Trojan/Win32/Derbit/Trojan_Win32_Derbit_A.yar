
rule Trojan_Win32_Derbit_A{
	meta:
		description = "Trojan:Win32/Derbit.A,SIGNATURE_TYPE_PEHSTR_EXT,14 00 14 00 0d 00 00 "
		
	strings :
		$a_03_0 = {50 6a 48 e8 ?? ?? ?? ?? 8d 84 24 ?? ?? ?? ?? 50 6a 49 e8 ?? ?? ?? ?? 8d 84 24 ?? ?? ?? ?? 50 6a 4a e8 } //3
		$a_03_1 = {8a 04 30 32 04 d5 ?? ?? ?? ?? 32 04 d5 ?? ?? ?? ?? 32 c3 43 88 04 3e 0f b7 f3 3b f1 72 db 90 09 07 00 8b 04 d5 } //3
		$a_01_2 = {00 70 61 79 6c 6f 61 64 2e 64 6c 6c 00 5f 53 74 61 72 74 40 34 00 } //5 瀀祡潬摡搮汬开瑓牡䁴4
		$a_01_3 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 31 37 37 } //1 185.121.177.177
		$a_01_4 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 35 33 } //1 185.121.177.53
		$a_01_5 = {34 35 2e 36 33 2e 32 35 2e 35 35 } //1 45.63.25.55
		$a_01_6 = {31 31 31 2e 36 37 2e 31 36 2e 32 30 32 } //1 111.67.16.202
		$a_01_7 = {31 34 32 2e 34 2e 32 30 34 2e 31 31 31 } //1 142.4.204.111
		$a_01_8 = {31 34 32 2e 34 2e 32 30 35 2e 34 37 } //1 142.4.205.47
		$a_01_9 = {33 31 2e 33 2e 31 33 35 2e 32 33 32 } //1 31.3.135.232
		$a_01_10 = {36 32 2e 31 31 33 2e 32 30 33 2e 35 35 } //1 62.113.203.55
		$a_01_11 = {33 37 2e 32 32 38 2e 31 35 31 2e 31 33 33 } //1 37.228.151.133
		$a_01_12 = {31 34 34 2e 37 36 2e 31 33 33 2e 33 38 } //1 144.76.133.38
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*3+(#a_01_2  & 1)*5+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1) >=20
 
}