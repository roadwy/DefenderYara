
rule Trojan_Win32_Derbit_B{
	meta:
		description = "Trojan:Win32/Derbit.B,SIGNATURE_TYPE_PEHSTR_EXT,12 00 12 00 0c 00 00 "
		
	strings :
		$a_01_0 = {b9 0a 00 00 00 be 42 57 07 00 f3 a5 } //3
		$a_01_1 = {00 70 61 79 6c 6f 61 64 2e 64 6c 6c 00 5f 53 74 61 72 74 40 34 00 } //5 瀀祡潬摡搮汬开瑓牡䁴4
		$a_01_2 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 31 37 37 } //1 185.121.177.177
		$a_01_3 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 35 33 } //1 185.121.177.53
		$a_01_4 = {34 35 2e 36 33 2e 32 35 2e 35 35 } //1 45.63.25.55
		$a_01_5 = {31 31 31 2e 36 37 2e 31 36 2e 32 30 32 } //1 111.67.16.202
		$a_01_6 = {31 34 32 2e 34 2e 32 30 34 2e 31 31 31 } //1 142.4.204.111
		$a_01_7 = {31 34 32 2e 34 2e 32 30 35 2e 34 37 } //1 142.4.205.47
		$a_01_8 = {33 31 2e 33 2e 31 33 35 2e 32 33 32 } //1 31.3.135.232
		$a_01_9 = {36 32 2e 31 31 33 2e 32 30 33 2e 35 35 } //1 62.113.203.55
		$a_01_10 = {33 37 2e 32 32 38 2e 31 35 31 2e 31 33 33 } //1 37.228.151.133
		$a_01_11 = {31 34 34 2e 37 36 2e 31 33 33 2e 33 38 } //1 144.76.133.38
	condition:
		((#a_01_0  & 1)*3+(#a_01_1  & 1)*5+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1) >=18
 
}