
rule Trojan_Win32_Derbit_D_bit{
	meta:
		description = "Trojan:Win32/Derbit.D!bit,SIGNATURE_TYPE_PEHSTR_EXT,2d 00 2d 00 0e 00 00 "
		
	strings :
		$a_01_0 = {7b 42 41 53 45 43 4f 4e 46 49 47 7d } //10 {BASECONFIG}
		$a_01_1 = {62 63 64 66 67 68 6b 6c 6d 6e 70 71 72 73 74 76 77 78 7a 61 65 69 6f 75 79 25 78 25 78 25 78 25 78 25 78 25 78 } //10 bcdfghklmnpqrstvwxzaeiouy%x%x%x%x%x%x
		$a_01_2 = {2e 64 6c 6c 00 4d 6f 7a 69 6c 6c 61 2f 34 2e 30 20 28 63 6f 6d 70 61 74 69 62 6c 65 3b 20 4d 53 49 45 } //10 搮汬䴀穯汩慬㐯〮⠠潣灭瑡扩敬※卍䕉
		$a_01_3 = {2e 62 69 74 00 48 54 54 50 2f 31 2e 31 00 50 4f 53 54 00 47 45 54 00 43 6f 6e 6e 65 63 74 69 6f 6e 3a } //10 戮瑩䠀呔⽐⸱1佐呓䜀呅䌀湯敮瑣潩㩮
		$a_01_4 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 35 33 } //1 185.121.177.53
		$a_01_5 = {31 38 35 2e 31 32 31 2e 31 37 37 2e 31 37 37 } //1 185.121.177.177
		$a_01_6 = {34 35 2e 36 33 2e 32 35 2e 35 35 } //1 45.63.25.55
		$a_01_7 = {31 31 31 2e 36 37 2e 31 36 2e 32 30 32 } //1 111.67.16.202
		$a_01_8 = {31 34 32 2e 34 2e 32 30 34 2e 31 31 31 } //1 142.4.204.111
		$a_01_9 = {31 34 32 2e 34 2e 32 30 35 2e 34 37 } //1 142.4.205.47
		$a_01_10 = {33 31 2e 33 2e 31 33 35 2e 32 33 32 } //1 31.3.135.232
		$a_01_11 = {36 32 2e 31 31 33 2e 32 30 33 2e 35 35 } //1 62.113.203.55
		$a_01_12 = {33 37 2e 32 32 38 2e 31 35 31 2e 31 33 33 } //1 37.228.151.133
		$a_01_13 = {31 34 34 2e 37 36 2e 31 33 33 2e 33 38 } //1 144.76.133.38
	condition:
		((#a_01_0  & 1)*10+(#a_01_1  & 1)*10+(#a_01_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*1+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_01_13  & 1)*1) >=45
 
}