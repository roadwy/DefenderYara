
rule Trojan_Win32_CryptInject_PZ_MTB{
	meta:
		description = "Trojan:Win32/CryptInject.PZ!MTB,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 01 00 00 "
		
	strings :
		$a_03_0 = {8b 84 24 40 01 00 00 48 8d 0d ?? ?? ?? ?? 8a 04 08 88 84 24 38 01 00 00 0f b6 84 24 38 01 00 00 42 0f b6 04 00 0f b6 8c 24 30 01 00 00 33 c8 8b 84 24 40 01 00 00 88 4c 04 20 8a 84 24 30 01 00 00 fe c0 88 84 24 30 01 00 00 8b 84 24 40 01 00 00 ff c0 89 84 24 40 01 00 00 8b 84 24 40 01 00 00 41 3b c2 72 } //1
	condition:
		((#a_03_0  & 1)*1) >=1
 
}
rule Trojan_Win32_CryptInject_PZ_MTB_2{
	meta:
		description = "Trojan:Win32/CryptInject.PZ!MTB,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 04 00 00 "
		
	strings :
		$a_02_0 = {83 c0 01 89 45 ?? 81 7d ?? ?? ?? 00 00 73 7e 8b 4d ?? 8b 55 ?? 8b 04 8a 89 85 ?? ?? ?? ff 8b 0d ?? ?? ?? 00 89 8d ?? ?? ?? ff 8b 95 ?? ?? ?? ff 2b 55 ?? 89 95 ?? ?? ?? ff 8b 45 ?? 83 e8 50 89 45 ?? 8b 8d ?? ?? ?? ff 33 8d ?? ?? ?? ff 89 8d ?? ?? ?? ff 8b 55 ?? 81 ea ?? ?? 00 00 89 55 ?? c1 85 ?? ?? ?? ff 07 8b 85 ?? ?? ?? ff 33 85 ?? ?? ?? ff 89 85 ?? ?? ?? ff 8b 4d ?? 8b 55 ?? 8b 85 ?? ?? ?? ff 89 04 8a e9 ?? ff ff ff } //1
		$a_02_1 = {83 c1 01 89 4d ?? 81 7d ?? 84 03 00 00 73 ?? 8b 55 ?? 8b 45 ?? 8b 0c 90 90 89 8d ?? ?? ?? ff 8b 15 ?? ?? ?? ?? 89 95 ?? ?? ?? ff 8b 85 ?? ?? ?? ff 2b 45 ?? 89 85 ?? ?? ?? ff 8b 4d ?? 83 e9 50 89 4d ?? 8b 95 ?? ?? ?? ff 33 95 ?? ?? ?? ff 89 95 ?? ?? ?? ff 8b 45 ?? 2d e8 03 00 00 89 45 ?? c1 85 ?? ?? ?? ff 07 8b 8d ?? ?? ?? ff 33 8d ?? ?? ?? ff 89 8d ?? ?? ?? ff 8b 55 ?? 8b 45 ?? 8b 8d ?? ?? ?? ff 89 0c 90 90 e9 ?? ff ff ff } //1
		$a_02_2 = {83 c2 01 89 55 ?? 81 7d ?? 84 03 00 00 73 ?? 8b 45 ?? 8b 4d ?? 8b 14 81 89 55 ?? a1 ?? ?? ?? ?? 89 45 ?? 8b 4d ?? 2b 4d ?? 89 4d ?? 8b 55 ?? 83 ea 50 89 55 ?? 8b 45 ?? 33 45 ?? 89 45 ?? 8b 4d ?? 81 e9 e8 03 00 00 89 4d ?? c1 45 ?? 07 8b 55 ?? 33 55 ?? 89 55 ?? 8b 45 ?? 8b 4d ?? 8b 55 ?? 89 14 81 eb } //1
		$a_02_3 = {83 c2 01 89 55 ?? 81 7d ?? 84 03 00 00 73 ?? 8b 45 ?? 8b 4d ?? 8b 14 81 89 95 ?? ?? ?? ff a1 ?? ?? ?? ?? 89 45 ?? 8b 8d ?? ?? ?? ff 2b 4d ?? 89 8d ?? ?? ?? ff 8b 55 ?? 83 ea 50 89 55 ?? 8b 85 ?? ?? ?? ff 33 45 ?? 89 85 ?? ?? ?? ff 8b 4d ?? 81 e9 e8 03 00 00 89 4d ?? c1 85 ?? ?? ?? ff 07 8b 95 ?? ?? ?? ff 33 55 ?? 89 95 ?? ?? ?? ff 8b 45 ?? 8b 4d ?? 8b 95 ?? ?? ?? ff 89 14 81 e9 ?? ff ff ff } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1+(#a_02_3  & 1)*1) >=1
 
}
rule Trojan_Win32_CryptInject_PZ_MTB_3{
	meta:
		description = "Trojan:Win32/CryptInject.PZ!MTB,SIGNATURE_TYPE_PEHSTR,01 00 01 00 01 00 00 "
		
	strings :
		$a_01_0 = {0f b6 55 10 8b 45 f0 03 45 ec 0f b6 08 33 ca 8b 55 f0 03 55 ec 88 0a eb d6 } //1
	condition:
		((#a_01_0  & 1)*1) >=1
 
}