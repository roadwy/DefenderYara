
rule Trojan_Win32_Matsnu_R{
	meta:
		description = "Trojan:Win32/Matsnu.R,SIGNATURE_TYPE_PEHSTR_EXT,0a 00 0a 00 10 00 00 02 00 "
		
	strings :
		$a_80_0 = {64 6c 6c 6c 69 73 74 3d 25 73 26 70 72 6f 63 6c 69 73 74 3d 25 73 } //dlllist=%s&proclist=%s  03 00 
		$a_80_1 = {69 64 3d 25 73 26 6d 79 6e 75 6d 3d 25 75 26 76 65 72 3d 25 73 26 63 76 72 3d 25 75 26 74 68 72 65 61 64 69 64 3d 25 75 } //id=%s&mynum=%u&ver=%s&cvr=%u&threadid=%u  03 00 
		$a_80_2 = {26 6c 61 6e 67 3d 30 78 25 30 34 58 26 6f 73 3d 25 73 26 63 72 63 62 6c 77 3d 25 30 38 78 26 25 73 } //&lang=0x%04X&os=%s&crcblw=%08x&%s  01 00 
		$a_80_3 = {47 45 54 3d 25 73 26 41 45 53 3d 25 73 } //GET=%s&AES=%s  01 00 
		$a_80_4 = {69 64 74 3d 25 75 26 63 6f 64 65 3d 25 75 } //idt=%u&code=%u  01 00 
		$a_80_5 = {67 65 74 3d 72 61 70 6f 72 74 } //get=raport  01 00 
		$a_80_6 = {67 65 74 3d 73 79 73 69 6e 66 6f } //get=sysinfo  01 00 
		$a_80_7 = {00 45 4e 44 44 44 44 44 00 } //  01 00 
		$a_03_8 = {50 4f 53 54 90 01 03 00 90 01 03 48 54 54 50 90 00 } //01 00 
		$a_03_9 = {30 32 64 20 90 01 07 47 4d 90 01 04 ff ff 54 90 00 } //01 00 
		$a_01_10 = {ff 52 43 50 4b } //01 00 
		$a_03_11 = {43 4f 4d 50 90 01 03 4c 45 54 45 90 00 } //01 00 
		$a_01_12 = {e8 11 00 00 00 43 55 52 52 45 4e 54 25 30 38 58 4d 55 54 45 58 00 } //02 00 
		$a_01_13 = {e8 05 00 00 00 2e 64 6c 6c 00 8d 95 f0 fe ff ff 52 ff 93 } //02 00 
		$a_01_14 = {e8 0a 00 00 00 2f 25 73 3a 2a 2d 2d 25 73 00 } //01 00 
		$a_01_15 = {30 d0 31 c9 b1 08 d3 ea f8 d1 d8 73 05 35 20 83 b8 ed } //00 00 
	condition:
		any of ($a_*)
 
}