
rule TrojanDownloader_Win64_Rugmi_HNW_MTB{
	meta:
		description = "TrojanDownloader:Win64/Rugmi.HNW!MTB,SIGNATURE_TYPE_PEHSTR_EXT,04 00 04 00 03 00 00 "
		
	strings :
		$a_03_0 = {48 8d 6c 24 20 48 89 4d ?? 48 89 55 ?? ?? [0-05] 45 90 1b 00 48 89 45 08 (8b|48 8b) 45 ?? 90 03 01 02 89 48 89 45 [0-04] ff ff ff ff 90 03 01 02 03 48 03 45 90 1b 06 90 03 01 02 89 48 89 45 90 1b 06 (8b|48 8b) 45 [0-02] 85 c0 [0-0d] 48 8b [0-08] 88 [0-0f] b8 01 00 00 00 48 03 45 ?? 48 89 45 90 1b 12 eb } //3
		$a_03_1 = {48 8d 6c 24 20 48 89 4d ?? 48 89 55 ?? ?? [0-05] 45 90 1b 00 48 89 45 10 (8b|48 8b) 45 ?? 48 90 03 01 02 89 48 89 45 [0-04] 6a ff 58 90 03 01 02 03 48 03 45 90 1b 06 48 90 03 01 02 89 48 89 45 90 1b 06 (8b|48 8b) 45 [0-02] 85 c0 [0-0d] 48 8b [0-08] 88 [0-04] 6a 01 [0-0f] 48 03 45 ?? 48 89 45 90 1b 13 eb } //3
		$a_01_2 = {48 6b c0 02 48 03 45 20 0f b7 00 0f b7 c0 85 c0 } //1
	condition:
		((#a_03_0  & 1)*3+(#a_03_1  & 1)*3+(#a_01_2  & 1)*1) >=4
 
}