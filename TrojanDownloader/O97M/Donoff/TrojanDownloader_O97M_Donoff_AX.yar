
rule TrojanDownloader_O97M_Donoff_AX{
	meta:
		description = "TrojanDownloader:O97M/Donoff.AX,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_02_0 = {2e 53 74 61 74 75 73 20 3d 20 28 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 29 20 54 68 65 6e 20 47 6f 54 6f } //1
		$a_02_1 = {3d 20 31 20 54 6f 20 28 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 29 } //1
		$a_02_2 = {49 66 20 28 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2d 20 [0-04] 29 20 3d 20 28 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2b 20 [0-04] 20 2d 20 [0-04] 20 2d 20 [0-04] 29 20 54 68 65 6e } //1
	condition:
		((#a_02_0  & 1)*1+(#a_02_1  & 1)*1+(#a_02_2  & 1)*1) >=3
 
}