
rule TrojanDownloader_O97M_Donoff_QH_MTB{
	meta:
		description = "TrojanDownloader:O97M/Donoff.QH!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,02 00 02 00 02 00 00 "
		
	strings :
		$a_01_0 = {63 41 42 76 41 48 63 41 5a 51 42 79 41 48 4d 41 61 41 42 6c 41 47 77 41 62 41 41 67 41 43 30 41 51 77 42 76 41 47 30 41 62 51 42 68 41 47 34 41 5a 41 41 67 41 43 49 41 53 51 42 75 41 48 59 41 62 77 42 72 41 47 55 41 4c 51 42 58 41 47 55 41 59 67 42 53 41 47 55 41 63 51 42 31 41 47 55 41 63 77 42 30 41 43 41 41 61 41 42 30 41 48 51 41 63 41 41 36 41 43 38 41 4c 77 41 6c 41 46 55 41 56 51 42 56 41 46 55 41 4a 51 41 69 41 43 41 41 4c 51 42 50 41 48 55 41 64 41 42 47 41 47 6b 41 62 41 42 6c 41 43 41 41 4a 41 42 46 41 45 34 41 56 67 41 36 41 46 55 41 63 77 42 6c 41 48 49 41 55 41 42 79 41 47 38 41 5a 67 42 70 41 47 77 41 5a 51 42 63 41 47 73 41 5a 51 42 35 41 48 4d 41 4c 67 42 6b 41 47 77 41 62 41 41 69 41 41 3d 3d } //1 cABvAHcAZQByAHMAaABlAGwAbAAgAC0AQwBvAG0AbQBhAG4AZAAgACIASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAAaAB0AHQAcAA6AC8ALwAlAFUAVQBVAFUAJQAiACAALQBPAHUAdABGAGkAbABlACAAJABFAE4AVgA6AFUAcwBlAHIAUAByAG8AZgBpAGwAZQBcAGsAZQB5AHMALgBkAGwAbAAiAA==
		$a_01_1 = {53 68 65 6c 6c 20 52 65 70 6c 61 63 65 } //1 Shell Replace
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1) >=2
 
}