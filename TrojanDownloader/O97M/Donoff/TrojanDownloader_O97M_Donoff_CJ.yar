
rule TrojanDownloader_O97M_Donoff_CJ{
	meta:
		description = "TrojanDownloader:O97M/Donoff.CJ,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 01 00 "
		
	strings :
		$a_03_0 = {46 6f 72 6d 61 74 47 55 49 44 28 42 79 52 65 66 20 69 6e 47 55 49 44 20 41 73 20 53 74 72 69 6e 67 29 20 41 73 20 53 74 72 69 6e 67 90 02 05 90 1d 30 00 20 3d 20 22 90 12 1f 00 69 63 72 6f 90 12 1f 00 6f 66 74 2e 90 12 1f 00 64 6f 64 62 2e 90 12 1f 00 74 72 90 00 } //01 00 
		$a_03_1 = {3d 20 47 6f 64 90 1d 0f 00 28 90 1d 2f 00 20 2b 20 22 5c 90 12 1f 00 2e 64 6c 6c 22 2c 20 22 90 12 1f 00 22 2c 20 22 90 11 01 00 22 29 90 00 } //01 00 
		$a_01_2 = {46 6f 72 20 69 20 3d 20 31 20 54 6f 20 4c 65 6e 28 54 72 69 6d 28 22 63 65 63 65 73 22 29 29 } //00 00  For i = 1 To Len(Trim("ceces"))
		$a_00_3 = {8f } //f0 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Donoff_CJ_2{
	meta:
		description = "TrojanDownloader:O97M/Donoff.CJ,SIGNATURE_TYPE_MACROHSTR_EXT,07 00 07 00 04 00 00 03 00 "
		
	strings :
		$a_03_0 = {28 42 79 52 65 66 20 69 6e 47 55 49 44 20 41 73 20 53 74 72 69 6e 67 29 20 41 73 20 53 74 72 69 6e 67 90 02 05 90 1d 30 00 20 3d 20 22 90 01 02 90 02 1f 69 63 72 6f 90 01 02 90 02 6f 66 74 2e 90 01 02 90 02 1f 64 6f 64 62 2e 90 01 02 90 02 1f 74 72 90 00 } //03 00 
		$a_03_1 = {20 2b 20 22 5c 90 02 09 2e 64 6c 6c 22 2c 20 22 90 01 01 90 02 02 90 04 01 03 41 2d 5a 22 2c 20 22 90 04 01 03 61 2d 7a 22 29 90 00 } //01 00 
		$a_03_2 = {3d 20 47 6f 64 90 12 1f 00 28 90 02 2f 2c 20 22 90 01 01 90 02 02 90 04 01 03 41 2d 5a 22 2c 20 22 90 11 01 00 22 29 90 00 } //01 00 
		$a_03_3 = {2b 20 47 6f 64 90 12 1f 00 28 22 90 01 50 90 02 5f 22 2c 20 22 90 11 05 00 90 12 0f 00 22 2c 20 22 90 01 05 90 02 0f 22 29 90 00 } //00 00 
		$a_00_4 = {8f } //31 01 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Donoff_CJ_3{
	meta:
		description = "TrojanDownloader:O97M/Donoff.CJ,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 01 00 "
		
	strings :
		$a_03_0 = {3d 20 47 6f 64 90 12 1f 00 28 22 90 01 02 90 02 1f 69 63 72 6f 90 01 02 90 02 6f 66 74 2e 90 01 02 90 02 1f 64 6f 64 62 2e 90 01 02 90 02 1f 74 72 90 00 } //01 00 
		$a_03_1 = {2b 20 22 5c 90 11 05 00 90 12 0f 00 2e 90 11 05 00 90 12 0f 00 22 2c 20 22 90 11 02 00 90 12 05 00 22 2c 20 22 90 11 01 00 22 29 90 00 } //01 00 
		$a_03_2 = {3d 20 53 70 6c 69 74 28 22 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 0f 04 00 90 10 09 00 90 04 01 03 a0 2d ae 90 01 ff 90 02 ff 22 2c 20 22 90 00 } //00 00 
		$a_00_3 = {5d } //04 00  ]
	condition:
		any of ($a_*)
 
}