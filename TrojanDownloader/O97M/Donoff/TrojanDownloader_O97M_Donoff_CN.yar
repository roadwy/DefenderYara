
rule TrojanDownloader_O97M_Donoff_CN{
	meta:
		description = "TrojanDownloader:O97M/Donoff.CN,SIGNATURE_TYPE_MACROHSTR_EXT,06 00 06 00 05 00 00 "
		
	strings :
		$a_03_0 = {22 6f 65 67 2f 6d 6f 63 2e 64 6e 69 6d 78 61 6d 2e 77 77 77 2f 2f 3a 73 70 74 74 68 90 12 0f 00 2f 79 74 69 63 2f 31 2e 32 76 2f 70 69 22 29 } //1
		$a_03_1 = {50 75 62 6c 69 63 20 46 75 6e 63 74 69 6f 6e 20 90 12 09 00 28 29 20 41 73 20 53 74 72 69 6e 67 [0-05] 90 1b 00 20 3d 20 90 12 09 00 28 90 0f 02 00 90 10 02 00 2c 20 90 0f 02 00 90 10 02 00 2c 20 22 [0-09] (65|45) [0-09] (|) 79 59 [0-09] (65|45) [0-09] (65|45) [0-09] (|) 72 52 [0-09] (|) 69 49 [0-09] (|) 66 46 [0-09] 22 29 } //1
		$a_03_2 = {50 75 62 6c 69 63 20 46 75 6e 63 74 69 6f 6e 20 90 12 09 00 28 29 [0-05] 90 1b 00 20 3d 20 90 12 09 00 28 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 2c 20 90 12 09 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 2c 20 [0-0f] 90 12 09 00 29 } //4
		$a_03_3 = {50 75 62 6c 69 63 20 46 75 6e 63 74 69 6f 6e 20 90 12 09 00 28 42 79 56 61 6c 20 90 12 09 00 2c 20 42 79 56 61 6c 20 90 12 09 00 20 41 73 20 49 6e 74 65 67 65 72 2c 20 42 79 56 61 6c 20 90 12 09 00 20 41 73 20 49 6e 74 65 67 65 72 29 20 41 73 20 53 74 72 69 6e 67 0d 0a 90 1b 00 20 3d 20 90 12 09 00 28 90 1b 01 2e 53 6f 75 72 63 65 2c 20 90 1b 02 2c 20 90 1b 03 29 } //1
		$a_03_4 = {50 75 62 6c 69 63 20 46 75 6e 63 74 69 6f 6e 20 90 12 09 00 28 29 20 41 73 20 53 74 72 69 6e 67 0d 0a 90 1b 00 20 3d 20 90 11 01 00 28 90 10 03 00 2c 20 22 [0-09] (69|49) [0-09] 90 03 01 01 6c 4c [0-09] 90 03 01 01 64 44 [0-09] 90 03 01 01 65 45 [0-09] 90 03 01 01 66 46 [0-09] 90 03 01 01 64 44 [0-09] 90 03 01 01 72 52 22 2c 20 90 10 03 00 29 } //1
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*4+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1) >=6
 
}