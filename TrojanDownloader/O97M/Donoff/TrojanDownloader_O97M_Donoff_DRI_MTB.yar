
rule TrojanDownloader_O97M_Donoff_DRI_MTB{
	meta:
		description = "TrojanDownloader:O97M/Donoff.DRI!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 05 00 00 "
		
	strings :
		$a_01_0 = {43 68 72 28 36 34 29 20 26 20 43 68 72 28 36 39 29 20 26 20 43 68 72 28 36 37 29 20 26 20 43 68 72 28 37 32 29 20 26 20 43 68 72 28 37 39 29 } //1 Chr(64) & Chr(69) & Chr(67) & Chr(72) & Chr(79)
		$a_01_1 = {55 30 6b 2e 56 42 53 20 20 26 20 74 49 4d 65 4f 55 54 20 31 33 20 26 20 4f 43 2e 65 78 65 } //1 U0k.VBS  & tIMeOUT 13 & OC.exe
		$a_01_2 = {43 68 72 28 41 73 63 28 56 39 6a 29 2d 20 32 35 29 20 3e 3e 55 30 6b 2e 56 42 53 } //1 Chr(Asc(V9j)- 25) >>U0k.VBS
		$a_01_3 = {53 68 65 6c 6c 20 43 68 72 28 35 30 32 20 2d 20 34 33 35 29 20 26 20 43 68 72 28 34 38 34 20 2d 20 34 30 37 29 20 26 20 43 68 72 28 34 30 35 20 2d 20 33 30 35 29 20 26 20 43 68 72 28 39 37 33 20 2d 20 39 34 31 29 20 26 20 43 68 72 28 39 37 39 20 2d 20 39 33 32 29 20 26 20 43 68 72 28 34 32 36 20 2d 20 33 32 37 29 20 26 20 43 68 72 28 39 37 33 20 2d 20 39 34 31 29 20 26 20 43 68 72 28 34 32 36 20 2d 20 33 32 37 29 20 26 20 43 68 72 28 34 30 35 20 2d 20 33 30 35 29 } //1 Shell Chr(502 - 435) & Chr(484 - 407) & Chr(405 - 305) & Chr(973 - 941) & Chr(979 - 932) & Chr(426 - 327) & Chr(973 - 941) & Chr(426 - 327) & Chr(405 - 305)
		$a_03_4 = {63 64 6e 2e 64 69 73 63 6f 72 64 61 70 70 2e 63 6f 6d 2f 61 74 74 61 63 68 6d 65 6e 74 73 2f 38 34 33 30 37 33 34 36 31 31 37 32 39 36 31 33 32 32 2f 38 34 33 32 31 37 31 31 37 38 31 36 38 31 35 37 32 36 2f 43 68 72 6f 6d 65 2e 65 78 65 90 0a 57 00 68 74 74 70 73 3a 2f 2f 90 00 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1+(#a_03_4  & 1)*1) >=4
 
}