
rule TrojanDownloader_O97M_Pwrencode_A{
	meta:
		description = "TrojanDownloader:O97M/Pwrencode.A,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 01 00 00 01 00 "
		
	strings :
		$a_00_0 = {77 4f 72 4b 62 6f 6f 4b 5f 4f 50 45 4e 28 29 3a 20 43 61 6c 6c 20 53 68 65 6c 6c 24 28 22 70 6f 57 45 52 53 68 45 6c 4c 2e 45 78 65 20 2d 45 78 45 43 75 74 69 6f 4e 50 6f 6c 69 63 79 20 62 59 70 41 73 53 20 2d 4e 4f 50 72 4f 46 69 4c 65 20 2d 57 69 6e 64 4f 77 73 54 79 4c 65 20 48 69 64 64 45 4e 20 2d 65 6e 43 6f 64 45 64 43 6f 4d 4d 41 4e 64 20 49 41 41 6f 41 47 34 41 52 51 42 33 41 43 30 41 62 77 42 69 41 47 6f 41 5a 51 42 6a 41 46 51 41 49 41 42 54 41 48 6b 41 55 77 42 55 41 47 55 41 62 51 41 75 41 45 34 41 5a 51 42 30 41 43 34 41 56 77 } //00 00  wOrKbooK_OPEN(): Call Shell$("poWERShElL.Exe -ExECutioNPolicy bYpAsS -NOPrOFiLe -WindOwsTyLe HiddEN -enCodEdCoMMANd IAAoAG4ARQB3AC0AbwBiAGoAZQBjAFQAIABTAHkAUwBUAGUAbQAuAE4AZQB0AC4AVw
	condition:
		any of ($a_*)
 
}