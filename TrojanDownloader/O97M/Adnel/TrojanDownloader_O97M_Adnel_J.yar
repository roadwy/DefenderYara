
rule TrojanDownloader_O97M_Adnel_J{
	meta:
		description = "TrojanDownloader:O97M/Adnel.J,SIGNATURE_TYPE_MACROHSTR_EXT,02 00 02 00 02 00 00 01 00 "
		
	strings :
		$a_01_0 = {49 66 20 28 31 33 2e 35 20 2b 20 36 34 31 20 2b 20 31 33 2e 35 20 2d 20 36 34 31 20 2b 20 31 33 2e 35 20 2b 20 36 34 31 20 2b 20 31 33 2e 35 20 2d 20 36 34 31 20 2d 20 31 29 20 3d 20 28 31 33 2e 35 20 2b 20 36 34 35 20 2b 20 31 33 2e 35 20 2d 20 36 34 35 20 2b 20 31 33 2e 35 20 2b 20 36 34 35 20 2b 20 31 33 2e 35 20 2d 20 36 34 35 20 2d 20 31 29 20 54 68 65 6e } //01 00 
		$a_01_1 = {3d 20 31 20 54 6f 20 28 32 35 30 30 20 2b 20 34 31 37 20 2b 20 32 35 30 30 20 2d 20 34 31 37 20 2b 20 32 35 30 30 20 2b 20 34 31 37 20 2b 20 32 35 30 30 20 2d 20 34 31 37 20 2d 20 31 29 } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Adnel_J_2{
	meta:
		description = "TrojanDownloader:O97M/Adnel.J,SIGNATURE_TYPE_MACROHSTR_EXT,05 00 05 00 05 00 00 01 00 "
		
	strings :
		$a_03_0 = {2e 72 65 61 64 79 53 74 61 74 65 20 3d 20 28 90 02 03 20 2b 20 90 02 03 20 2b 20 90 02 03 20 2d 20 90 02 03 29 20 41 6e 64 20 90 02 10 2e 53 74 61 74 75 73 20 3d 20 28 90 02 03 20 2b 20 90 02 03 20 2b 20 90 02 03 20 2d 20 90 02 03 29 20 54 68 65 6e 90 00 } //01 00 
		$a_03_1 = {3d 20 43 72 65 61 74 65 4f 62 6a 65 63 74 28 90 02 14 28 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 90 00 } //01 00 
		$a_03_2 = {57 69 74 68 20 90 02 14 2e 63 52 65 61 74 65 74 65 58 74 66 49 6c 65 28 90 00 } //01 00 
		$a_03_3 = {3d 20 45 6e 76 69 72 6f 6e 28 90 02 14 28 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 90 00 } //01 00 
		$a_03_4 = {43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 20 2b 20 43 68 72 24 28 90 02 03 29 2c 20 22 90 02 14 22 29 29 2e 52 75 6e 90 00 } //00 00 
		$a_00_5 = {5d 04 00 } //00 aa 
	condition:
		any of ($a_*)
 
}