
rule TrojanDownloader_O97M_Obfuse_JF_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_01_0 = {28 45 6e 76 69 72 6f 6e 28 22 54 45 4d 50 22 29 29 } //1 (Environ("TEMP"))
		$a_03_1 = {43 61 6c 6c 20 [0-09] 28 [0-09] 2e [0-09] 2c 20 22 76 65 72 69 6e 73 74 65 72 65 2e 78 6c 73 22 2c 20 30 29 } //1
		$a_01_2 = {3d 20 56 42 41 2e 53 70 6c 69 74 28 22 22 29 } //1 = VBA.Split("")
		$a_01_3 = {3d 20 56 42 41 2e 4d 69 64 24 28 } //1 = VBA.Mid$(
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*1+(#a_01_2  & 1)*1+(#a_01_3  & 1)*1) >=4
 
}
rule TrojanDownloader_O97M_Obfuse_JF_MTB_2{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,06 00 06 00 05 00 00 "
		
	strings :
		$a_03_0 = {36 38 37 34 37 34 37 30 37 33 22 29 20 26 20 [0-0f] 28 22 33 61 32 66 32 66 36 62 37 32 36 35 36 35 32 65 36 64 36 39 36 33 37 32 36 66 37 34 36 31 36 62 36 34 36 39 37 32 36 35 36 33 37 34 32 65 36 33 36 66 36 64 32 66 36 37 37 32 36 35 37 39 36 64 36 66 36 39 37 32 32 66 [0-32] 32 65 } //2
		$a_03_1 = {43 68 72 24 28 56 61 6c 28 22 26 48 22 20 26 20 4d 69 64 24 28 [0-0f] 2c 20 [0-0f] 2c 20 32 29 29 29 } //1
		$a_03_2 = {47 65 74 4f 62 6a 65 63 74 28 [0-0f] 28 22 37 37 36 39 36 65 36 64 36 37 36 64 37 34 37 33 33 61 35 63 22 29 20 26 20 [0-0f] 28 22 35 63 32 65 35 63 37 32 36 66 36 66 37 34 35 63 36 33 36 39 36 64 37 36 33 32 22 29 29 } //1
		$a_03_3 = {36 37 37 32 36 35 37 39 36 64 22 29 20 26 20 [0-0f] 28 22 36 66 37 32 36 35 32 65 36 35 37 38 36 35 } //1
		$a_03_4 = {47 65 74 4f 62 6a 65 63 74 28 [0-0f] 28 22 37 37 36 39 36 65 36 64 36 37 36 64 37 34 37 33 33 61 35 63 35 63 32 65 35 63 37 32 36 66 36 66 37 34 35 63 36 33 36 39 36 64 37 36 33 32 33 61 35 37 22 29 20 26 20 [0-0f] 28 22 36 39 36 65 33 33 33 32 35 66 35 30 37 32 36 66 36 33 36 35 37 33 37 33 22 29 29 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1) >=6
 
}
rule TrojanDownloader_O97M_Obfuse_JF_MTB_3{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.JF!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,04 00 04 00 04 00 00 "
		
	strings :
		$a_00_0 = {55 52 4c 44 65 63 6f 64 65 28 22 25 37 30 25 36 66 25 37 37 25 36 35 25 37 32 25 37 33 25 36 38 25 36 35 25 36 63 25 36 63 25 32 30 25 32 64 25 37 33 25 37 34 25 36 31 25 32 30 25 32 64 25 36 65 25 36 66 25 37 30 25 32 30 25 32 64 25 37 37 25 32 30 25 36 38 25 36 39 25 36 34 25 36 34 25 36 35 25 36 65 25 32 30 25 32 64 25 36 35 25 37 38 25 36 35 25 36 33 25 32 30 25 36 32 25 37 39 25 37 30 25 36 31 25 37 33 25 37 33 25 32 30 25 32 65 25 32 30 22 29 } //1 URLDecode("%70%6f%77%65%72%73%68%65%6c%6c%20%2d%73%74%61%20%2d%6e%6f%70%20%2d%77%20%68%69%64%64%65%6e%20%2d%65%78%65%63%20%62%79%70%61%73%73%20%2e%20")
		$a_00_1 = {25 36 38 25 37 34 25 37 34 25 37 30 25 37 33 25 33 61 25 32 66 25 32 66 25 36 33 25 36 34 25 36 65 25 32 65 25 36 31 25 36 63 25 37 35 25 36 64 25 36 65 25 36 39 25 36 65 25 36 35 25 37 34 25 37 37 25 36 66 25 37 32 25 36 62 25 32 65 25 37 33 25 36 39 25 37 34 25 36 35 25 32 66 25 33 37 25 33 33 25 33 35 25 36 36 25 33 34 25 36 34 25 33 37 25 33 35 25 36 35 25 36 33 25 36 35 25 36 31 25 36 36 25 36 36 25 33 30 25 33 34 25 36 31 25 33 39 25 36 31 25 36 36 25 33 30 25 33 31 25 36 32 25 36 36 25 36 36 25 33 31 25 33 37 25 33 38 25 33 35 25 33 36 25 33 39 25 33 34 25 32 66 25 37 33 25 37 35 25 37 32 25 37 36 25 36 35 25 37 39 25 32 65 25 36 37 25 36 31 25 37 34 25 36 38 25 36 35 25 37 32 } //1 %68%74%74%70%73%3a%2f%2f%63%64%6e%2e%61%6c%75%6d%6e%69%6e%65%74%77%6f%72%6b%2e%73%69%74%65%2f%37%33%35%66%34%64%37%35%65%63%65%61%66%66%30%34%61%39%61%66%30%31%62%66%66%31%37%38%35%36%39%34%2f%73%75%72%76%65%79%2e%67%61%74%68%65%72
		$a_00_2 = {25 34 33 25 33 61 25 35 63 25 37 37 25 36 39 25 36 65 25 36 34 25 36 66 25 37 37 25 37 33 25 35 63 25 37 34 25 36 35 25 36 64 25 37 30 25 35 63 25 37 33 25 37 35 25 37 32 25 37 36 25 36 35 25 37 39 25 32 65 25 37 30 25 37 33 25 33 31 } //1 %43%3a%5c%77%69%6e%64%6f%77%73%5c%74%65%6d%70%5c%73%75%72%76%65%79%2e%70%73%31
		$a_03_3 = {4d 69 64 28 53 74 72 69 6e 67 54 6f 44 65 63 6f 64 65 2c 20 [0-0a] 20 2b 20 31 2c 20 32 29 } //1
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_03_3  & 1)*1) >=4
 
}