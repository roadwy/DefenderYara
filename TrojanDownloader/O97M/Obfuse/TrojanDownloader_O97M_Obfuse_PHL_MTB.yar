
rule TrojanDownloader_O97M_Obfuse_PHL_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfuse.PHL!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_01_0 = {48 41 47 55 41 59 51 42 73 41 48 49 41 5a 67 42 31 41 48 59 41 61 51 42 72 41 47 77 41 65 51 42 6c 41 48 67 41 4c 67 42 6c 41 48 67 41 5a 51 41 69 41 44 73 41 4b 41 42 4f 41 47 55 41 64 77 41 74 41 45 38 41 59 67 42 71 41 47 55 41 59 77 42 30 41 43 41 41 55 77 42 35 41 48 4d 41 64 41 42 6c 41 47 30 41 4c 67 42 4f 41 47 55 41 64 41 41 75 41 46 63 41 5a 51 42 } //1 HAGUAYQBsAHIAZgB1AHYAaQBrAGwAeQBlAHgALgBlAHgAZQAiADsAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQB
		$a_01_1 = {69 41 45 4d 41 62 41 42 70 41 47 55 41 62 67 42 30 41 43 6b 41 4c 67 42 45 41 47 38 41 64 77 42 75 41 47 77 41 62 77 42 68 41 47 51 41 52 67 42 70 41 47 77 41 5a 51 41 6f 41 43 49 41 61 41 42 30 41 48 51 41 63 41 41 36 41 43 38 41 4c 77 41 7a 41 43 34 41 4e 77 41 77 41 43 34 41 4e 51 41 79 41 43 34 41 4f 41 41 76 41 46 49 41 4d 51 41 76 41 46 6f 41 4c 77 42 56 41 46 6b 41 53 41 41 7a 41 44 41 41 4d 67 41 75 41 47 55 41 65 41 42 6c 41 43 } //1 iAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACIAaAB0AHQAcAA6AC8ALwAzAC4ANwAwAC4ANQAyAC4AOAAvAFIAMQAvAFoALwBVAFkASAAzADAAMgAuAGUAeABlAC
		$a_01_2 = {49 41 4c 41 41 69 41 43 51 41 5a 51 42 75 41 48 59 41 4f 67 42 42 41 46 41 41 55 41 42 45 41 45 45 41 56 41 42 42 41 46 77 41 4a 41 42 51 41 48 49 41 62 77 42 6a 41 45 34 41 59 51 42 74 41 47 55 41 49 67 41 70 41 44 73 41 55 77 42 30 41 47 45 41 63 67 42 30 41 43 30 41 55 41 42 79 41 47 38 41 59 77 42 6c 41 48 4d 41 63 77 41 67 41 43 67 41 } //1 IALAAiACQAZQBuAHYAOgBBAFAAUABEAEEAVABBAFwAJABQAHIAbwBjAE4AYQBtAGUAIgApADsAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgACgA
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=3
 
}