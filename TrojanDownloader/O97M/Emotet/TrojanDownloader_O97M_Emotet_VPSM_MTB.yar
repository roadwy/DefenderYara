
rule TrojanDownloader_O97M_Emotet_VPSM_MTB{
	meta:
		description = "TrojanDownloader:O97M/Emotet.VPSM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 0c 00 00 01 00 "
		
	strings :
		$a_00_0 = {6e 65 6e 6c 69 6e 65 61 73 76 2e 63 6f 6d 2f 65 6e 63 61 73 61 2f 63 67 69 2d 62 69 6e 2f 77 71 44 5a 7a 4f 32 4f 73 49 6b 37 71 47 62 2f } //01 00 
		$a_00_1 = {68 6f 77 61 72 64 63 6f 75 6e 74 79 72 65 70 75 62 6c 69 63 61 6e 73 2e 6f 72 67 2f 69 6d 61 67 65 73 2f 33 58 39 41 6d 4a 36 62 65 38 77 2f } //01 00 
		$a_00_2 = {64 72 6d 65 74 7a 2e 63 6f 6d 2f 49 6e 64 65 78 5f 66 69 6c 65 73 2f 33 4e 63 6d 53 50 52 59 65 51 79 2f } //01 00 
		$a_00_3 = {68 61 74 69 70 6f 67 6c 75 68 61 6c 69 2e 63 6f 6d 2f 61 70 70 6c 69 63 61 74 69 6f 6e 2f 32 43 6b 70 4b 45 66 32 48 30 46 2f } //01 00 
		$a_00_4 = {68 6f 6c 69 64 61 79 6f 6e 65 68 6f 74 65 6c 2e 63 6f 6d 2f 6c 69 62 72 61 72 69 65 73 2f 6c 78 65 6b 2f } //01 00 
		$a_00_5 = {65 2d 6b 69 6e 65 72 6a 61 2e 6e 74 62 70 72 6f 76 2e 67 6f 2e 69 64 2f 61 73 65 74 2f 33 79 56 64 41 46 32 62 49 53 66 47 77 42 6d 4d 6b 2f } //01 00 
		$a_00_6 = {70 61 6e 63 6f 6f 6b 2e 63 6f 6d 2f 6e 65 77 73 69 74 65 2f 74 62 4b 2f } //01 00 
		$a_00_7 = {66 68 64 6c 6c 70 2e 63 6f 6d 2f 77 70 2d 61 64 6d 69 6e 2f 44 57 41 45 63 35 62 6b 53 39 33 2f } //01 00 
		$a_00_8 = {68 6f 6c 6f 67 79 2e 75 62 2e 61 63 2e 69 64 2f 61 64 6d 69 6e 2f 38 68 61 4e 2f } //01 00 
		$a_00_9 = {66 66 66 63 61 74 66 72 69 65 6e 64 73 2e 6f 72 67 2f 61 64 6f 70 74 61 62 6c 65 73 2f 58 4e 33 48 6a 77 48 65 6d 7a 31 41 61 49 77 2f } //01 00 
		$a_00_10 = {6c 61 2d 63 73 69 2e 63 6f 6d 2f 6d 74 2d 61 64 6d 69 6e 2f 67 43 4f 62 63 6b 47 67 4a 79 4f 4a 57 4a 4c 5a 2f } //01 00 
		$a_00_11 = {66 69 6c 6d 6d 6f 67 7a 69 76 6f 74 61 2e 72 73 2f 6a 73 2f 61 48 4f 4a 4e 52 76 4a 46 67 4b 34 67 2f } //00 00 
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Emotet_VPSM_MTB_2{
	meta:
		description = "TrojanDownloader:O97M/Emotet.VPSM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 06 00 00 01 00 "
		
	strings :
		$a_01_0 = {6f 22 26 22 66 22 26 22 74 22 26 22 61 22 26 22 6c 22 26 22 6d 22 26 22 6f 22 26 22 63 22 26 22 69 22 26 22 74 22 26 22 79 2e 63 22 26 22 6f 22 26 22 6d 22 26 22 2f 77 22 26 22 70 22 26 22 2d 61 22 26 22 64 22 26 22 6d 22 26 22 69 22 26 22 6e 22 26 22 2f 22 26 22 78 22 26 22 44 22 26 22 6a 22 26 22 44 22 26 22 69 22 26 22 58 22 26 22 68 22 26 22 63 22 26 22 53 22 26 22 2f 22 26 22 } //01 00 
		$a_01_1 = {77 22 26 22 77 22 26 22 77 22 26 22 2e 22 26 22 6d 22 26 22 75 22 26 22 73 22 26 22 6c 22 26 22 69 22 26 22 6d 22 26 22 70 22 26 22 72 22 26 22 6f 22 26 22 70 22 26 22 65 22 26 22 72 22 26 22 74 22 26 22 79 22 26 22 2e 22 26 22 63 22 26 22 6f 22 26 22 2e 22 26 22 75 22 26 22 6b 22 26 22 2f 22 26 22 63 22 26 22 67 22 26 22 69 22 26 22 2d 62 22 26 22 69 22 26 22 6e 2f 22 26 22 38 22 26 22 6c 22 26 22 53 22 26 22 2f 22 26 22 } //01 00 
		$a_01_2 = {70 22 26 22 34 22 26 22 39 22 26 22 33 22 26 22 36 22 26 22 2e 22 26 22 77 22 26 22 65 22 26 22 62 22 26 22 6d 22 26 22 6f 22 26 22 2e 22 26 22 66 22 26 22 72 22 26 22 2f 22 26 22 77 22 26 22 70 22 26 22 2d 22 26 22 61 22 26 22 64 22 26 22 6d 22 26 22 69 22 26 22 6e 22 26 22 2f 22 26 22 46 22 26 22 4b 22 26 22 54 22 26 22 79 22 26 22 6e 22 26 22 56 22 26 22 2f } //01 00 
		$a_01_3 = {77 22 26 22 77 22 26 22 77 2e 6f 22 26 22 6d 22 26 22 61 22 26 22 72 22 26 22 68 22 26 22 6f 22 26 22 73 22 26 22 70 22 26 22 69 22 26 22 74 22 26 22 61 22 26 22 6c 2e 63 22 26 22 6f 22 26 22 6d 2f 77 22 26 22 70 2d 63 22 26 22 6f 22 26 22 6e 22 26 22 74 22 26 22 65 22 26 22 6e 22 26 22 74 2f 56 22 26 22 65 22 26 22 64 22 26 22 34 22 26 22 42 22 26 22 42 22 26 22 4a 22 26 22 6d 22 26 22 73 22 26 22 37 22 26 22 67 22 26 22 77 22 26 22 6c 22 26 22 32 2f } //01 00 
		$a_01_4 = {67 22 26 22 6f 6f 22 26 22 64 66 22 26 22 72 69 22 26 22 65 6e 22 26 22 64 73 22 26 22 64 72 22 26 22 69 76 22 26 22 69 6e 22 26 22 67 2e 63 22 26 22 6f 22 26 22 6d 2f 63 22 26 22 72 65 22 26 22 61 22 26 22 74 65 22 26 22 73 63 22 26 22 68 65 22 26 22 64 75 22 26 22 6c 65 2f 46 22 26 22 30 6a 22 26 22 47 76 22 26 22 67 54 22 26 22 69 46 22 26 22 41 4d 22 26 22 52 68 22 26 22 32 54 22 26 22 72 38 22 26 22 48 4c 2f } //01 00 
		$a_01_5 = {69 74 22 26 22 6d 22 26 22 61 22 26 22 78 2e 74 22 26 22 6e 2f 63 22 26 22 67 22 26 22 69 2d 62 22 26 22 69 22 26 22 6e 2f 77 2f } //00 00 
	condition:
		any of ($a_*)
 
}