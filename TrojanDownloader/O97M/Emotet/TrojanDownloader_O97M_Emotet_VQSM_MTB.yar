
rule TrojanDownloader_O97M_Emotet_VQSM_MTB{
	meta:
		description = "TrojanDownloader:O97M/Emotet.VQSM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 06 00 00 01 00 "
		
	strings :
		$a_01_0 = {73 74 22 26 22 6f 6e 22 26 22 65 66 6c 22 26 22 79 6d 22 26 22 61 72 22 26 22 6b 65 74 22 26 22 69 6e 67 2e 63 22 26 22 6f 22 26 22 6d 2f 77 6d 22 26 22 69 6e 6a 22 26 22 75 72 79 22 26 22 6c 61 77 2e 63 22 26 22 6f 22 26 22 6d 2f 69 59 22 26 22 49 4e 22 26 22 50 2f } //01 00  st"&"on"&"efl"&"ym"&"ar"&"ket"&"ing.c"&"o"&"m/wm"&"inj"&"ury"&"law.c"&"o"&"m/iY"&"IN"&"P/
		$a_01_1 = {66 75 22 26 22 65 72 7a 22 26 22 61 39 22 26 22 39 66 6d 2e 63 22 26 22 6f 22 26 22 6d 2f 63 22 26 22 67 69 2d 62 22 26 22 69 6e 2f 68 22 26 22 6d 35 22 26 22 42 69 22 26 22 36 36 2f } //01 00  fu"&"erz"&"a9"&"9fm.c"&"o"&"m/c"&"gi-b"&"in/h"&"m5"&"Bi"&"66/
		$a_01_2 = {75 22 26 22 6e 69 22 26 22 63 6f 22 26 22 72 6e 2d 75 22 26 22 6e 64 22 26 22 65 72 22 26 22 77 65 22 26 22 61 72 2e 67 22 26 22 72 2f 77 22 26 22 70 2d 63 22 26 22 6f 6e 22 26 22 74 65 22 26 22 6e 74 2f 6e 22 26 22 55 51 22 26 22 6c 52 22 26 22 75 2f } //01 00  u"&"ni"&"co"&"rn-u"&"nd"&"er"&"we"&"ar.g"&"r/w"&"p-c"&"on"&"te"&"nt/n"&"UQ"&"lR"&"u/
		$a_01_3 = {6c 22 26 22 61 76 22 26 22 61 6d 22 26 22 65 61 22 26 22 70 70 2e 63 22 26 22 6c 2f 77 22 26 22 70 2d 73 6e 22 26 22 61 70 22 26 22 73 68 22 26 22 6f 74 22 26 22 73 2f 68 69 22 26 22 6d 76 22 26 22 30 72 22 26 22 62 42 22 26 22 6f 66 22 26 22 6d 41 22 26 22 42 66 22 26 22 33 65 22 26 22 77 4e 2f } //01 00  l"&"av"&"am"&"ea"&"pp.c"&"l/w"&"p-sn"&"ap"&"sh"&"ot"&"s/hi"&"mv"&"0r"&"bB"&"of"&"mA"&"Bf"&"3e"&"wN/
		$a_01_4 = {6e 22 26 22 69 65 22 26 22 6e 6b 22 26 22 7a 2e 6e 22 26 22 6c 2f 73 22 26 22 63 72 22 26 22 69 70 22 26 22 74 73 2f 38 22 26 22 42 42 22 26 22 53 76 22 26 22 33 65 22 26 22 6e 56 22 26 22 4d 65 22 26 22 65 55 22 26 22 34 79 2f } //01 00  n"&"ie"&"nk"&"z.n"&"l/s"&"cr"&"ip"&"ts/8"&"BB"&"Sv"&"3e"&"nV"&"Me"&"eU"&"4y/
		$a_01_5 = {77 22 26 22 77 22 26 22 77 2e 6e 22 26 22 34 69 2e 65 22 26 22 73 2f 76 22 26 22 69 64 65 22 26 22 6f 73 2f 35 22 26 22 35 79 54 22 26 22 36 56 22 26 22 6a 69 22 26 22 4d 2f } //00 00  w"&"w"&"w.n"&"4i.e"&"s/v"&"ide"&"os/5"&"5yT"&"6V"&"ji"&"M/
	condition:
		any of ($a_*)
 
}
rule TrojanDownloader_O97M_Emotet_VQSM_MTB_2{
	meta:
		description = "TrojanDownloader:O97M/Emotet.VQSM!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,01 00 01 00 06 00 00 01 00 "
		
	strings :
		$a_00_0 = {68 74 74 70 3a 2f 2f 63 22 26 22 6c 69 22 26 22 70 61 22 26 22 63 63 2e 63 22 26 22 22 26 22 6f 6d 2f 69 22 26 22 6d 67 2f 64 6f 58 22 26 22 77 22 26 22 36 38 64 37 22 26 22 62 71 78 78 68 22 26 22 77 75 22 26 22 78 4e 22 26 22 62 30 22 26 22 4e 2f } //01 00  http://c"&"li"&"pa"&"cc.c"&""&"om/i"&"mg/doX"&"w"&"68d7"&"bqxxh"&"wu"&"xN"&"b0"&"N/
		$a_00_1 = {68 74 74 70 3a 2f 2f 63 68 22 26 22 61 64 68 79 22 26 22 6d 22 26 22 61 73 2e 63 22 26 22 6f 6d 2f 77 22 26 22 70 2d 61 22 26 22 64 6d 22 26 22 69 6e 2f 79 22 26 22 6f 31 22 26 22 31 72 45 54 22 26 22 6c 6d 7a 22 26 22 52 71 5a 22 26 22 6c 43 35 22 26 22 36 42 2f } //01 00  http://ch"&"adhy"&"m"&"as.c"&"om/w"&"p-a"&"dm"&"in/y"&"o1"&"1rET"&"lmz"&"RqZ"&"lC5"&"6B/
		$a_00_2 = {68 74 74 70 3a 2f 2f 6d 22 26 22 75 6c 22 26 22 6d 61 74 22 26 22 64 6f 22 26 22 6c 2e 63 22 26 22 6f 6d 2f 61 22 26 22 64 6d 2f 59 22 26 22 4f 37 22 26 22 6c 70 22 26 22 4c 6c 52 6e 22 26 22 50 49 22 26 22 4d 2f } //01 00  http://m"&"ul"&"mat"&"do"&"l.c"&"om/a"&"dm/Y"&"O7"&"lp"&"LlRn"&"PI"&"M/
		$a_00_3 = {68 74 74 70 3a 2f 2f 66 22 26 22 6d 65 73 22 26 22 70 65 72 22 26 22 61 22 26 22 6e 7a 61 39 22 26 22 34 35 2e 63 22 26 22 6f 6d 2f 66 22 26 22 6f 22 26 22 6e 74 22 26 22 73 2f 4d 22 26 22 74 61 2f } //01 00  http://f"&"mes"&"per"&"a"&"nza9"&"45.c"&"om/f"&"o"&"nt"&"s/M"&"ta/
		$a_00_4 = {68 74 74 70 3a 2f 2f 63 6c 22 26 22 61 6e 77 22 26 22 61 74 22 26 22 73 6f 22 26 22 6e 2e 63 22 26 22 6f 2e 75 22 26 22 6b 2f 70 65 22 26 22 72 22 26 22 73 6f 6e 22 26 22 61 6c 2f 44 22 26 22 78 6c 43 22 26 22 62 4b 22 26 22 35 79 78 22 26 22 62 71 22 26 22 71 31 6a 22 26 22 71 50 2f } //01 00  http://cl"&"anw"&"at"&"so"&"n.c"&"o.u"&"k/pe"&"r"&"son"&"al/D"&"xlC"&"bK"&"5yx"&"bq"&"q1j"&"qP/
		$a_00_5 = {68 74 74 70 73 3a 2f 2f 63 6c 61 22 26 22 73 22 26 22 73 69 22 26 22 63 70 22 26 22 61 69 22 26 22 6e 74 2e 6e 22 26 22 65 74 2f 77 22 26 22 70 2d 63 22 26 22 6f 6e 22 26 22 74 65 22 26 22 6e 74 2f 56 78 36 22 26 22 69 50 34 22 26 22 4b 4f 79 6f 22 26 22 5a 75 69 77 22 26 22 73 79 22 26 22 57 2f } //00 00  https://cla"&"s"&"si"&"cp"&"ai"&"nt.n"&"et/w"&"p-c"&"on"&"te"&"nt/Vx6"&"iP4"&"KOyo"&"Zuiw"&"sy"&"W/
	condition:
		any of ($a_*)
 
}