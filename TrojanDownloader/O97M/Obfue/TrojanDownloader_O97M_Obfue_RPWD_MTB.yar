
rule TrojanDownloader_O97M_Obfue_RPWD_MTB{
	meta:
		description = "TrojanDownloader:O97M/Obfue.RPWD!MTB,SIGNATURE_TYPE_MACROHSTR_EXT,06 00 06 00 06 00 00 01 00 "
		
	strings :
		$a_01_0 = {77 61 66 6c 6c 20 73 74 20 2b 20 22 5c 22 20 2b 20 62 62 2c 20 61 63 63 65 66 33 34 44 65 63 6f 64 65 28 55 73 65 72 46 6f 72 6d 31 2e 4c 61 62 65 6c 31 29 2c 20 43 42 79 74 65 28 37 39 29 2c 20 30 } //01 00  wafll st + "\" + bb, accef34Decode(UserForm1.Label1), CByte(79), 0
		$a_01_1 = {43 68 72 28 33 32 20 58 6f 72 20 43 42 79 74 65 28 39 39 29 29 20 2b 20 43 68 72 28 38 33 20 58 6f 72 20 43 42 79 74 65 28 31 30 35 29 29 20 2b 20 43 68 72 28 34 38 20 58 6f 72 20 43 42 79 74 65 28 31 30 38 29 29 20 2b 20 43 68 72 28 35 35 20 58 6f 72 20 43 42 79 74 65 28 39 38 29 29 20 2b } //01 00  Chr(32 Xor CByte(99)) + Chr(83 Xor CByte(105)) + Chr(48 Xor CByte(108)) + Chr(55 Xor CByte(98)) +
		$a_01_2 = {43 68 72 28 31 35 20 58 6f 72 20 43 42 79 74 65 28 31 30 38 29 29 20 2b 20 43 68 72 28 31 20 58 6f 72 20 43 42 79 74 65 28 31 30 38 29 29 20 2b 20 43 68 72 28 32 30 20 58 6f 72 20 43 42 79 74 65 28 31 30 30 29 29 20 2b 20 43 68 72 28 37 36 20 58 6f 72 20 43 42 79 74 65 28 34 36 29 29 20 2b 20 43 68 72 28 39 35 20 58 6f 72 20 43 42 79 74 65 28 35 32 29 29 20 } //01 00  Chr(15 Xor CByte(108)) + Chr(1 Xor CByte(108)) + Chr(20 Xor CByte(100)) + Chr(76 Xor CByte(46)) + Chr(95 Xor CByte(52)) 
		$a_01_3 = {43 68 72 28 34 36 20 58 6f 72 20 43 42 79 74 65 28 31 31 34 29 29 20 2b 20 43 68 72 28 35 33 20 58 6f 72 20 43 42 79 74 65 28 31 30 31 29 29 20 2b 20 43 68 72 28 36 20 58 6f 72 20 43 42 79 74 65 28 31 31 35 29 29 20 2b 20 43 68 72 28 35 35 20 58 6f 72 20 43 42 79 74 65 28 38 35 29 29 20 2b 20 43 68 72 28 34 38 20 58 6f 72 20 43 42 79 74 65 28 39 32 29 29 20 2b 20 43 68 72 28 38 33 20 58 6f 72 20 43 42 79 74 65 28 35 38 29 29 20 2b 20 43 68 72 28 33 32 20 58 6f 72 20 43 42 79 74 65 28 36 37 29 29 } //01 00  Chr(46 Xor CByte(114)) + Chr(53 Xor CByte(101)) + Chr(6 Xor CByte(115)) + Chr(55 Xor CByte(85)) + Chr(48 Xor CByte(92)) + Chr(83 Xor CByte(58)) + Chr(32 Xor CByte(67))
		$a_01_4 = {2b 20 43 68 72 28 30 20 58 6f 72 20 43 42 79 74 65 28 35 34 29 29 20 2b 20 43 68 72 28 39 35 20 58 6f 72 20 43 42 79 74 65 28 31 30 37 29 29 20 2b 20 43 68 72 28 37 36 20 58 6f 72 20 43 42 79 74 65 28 39 38 29 29 20 2b 20 43 68 72 28 32 30 20 58 6f 72 20 43 42 79 74 65 28 31 31 32 29 29 20 2b 20 43 68 72 28 31 20 58 6f 72 20 43 42 79 74 65 28 31 30 39 29 29 20 2b 20 43 68 72 28 31 35 20 58 6f 72 20 43 42 79 74 65 28 39 39 29 29 } //01 00  + Chr(0 Xor CByte(54)) + Chr(95 Xor CByte(107)) + Chr(76 Xor CByte(98)) + Chr(20 Xor CByte(112)) + Chr(1 Xor CByte(109)) + Chr(15 Xor CByte(99))
		$a_01_5 = {43 68 72 28 36 20 58 6f 72 20 43 42 79 74 65 28 31 31 37 29 29 20 2b 20 43 68 72 28 35 33 20 58 6f 72 20 43 42 79 74 65 28 38 30 29 29 20 2b 20 43 68 72 28 34 36 20 58 6f 72 20 43 42 79 74 65 28 39 32 29 29 20 2b 20 43 68 72 28 30 20 58 6f 72 20 43 42 79 74 65 28 31 31 35 29 29 } //00 00  Chr(6 Xor CByte(117)) + Chr(53 Xor CByte(80)) + Chr(46 Xor CByte(92)) + Chr(0 Xor CByte(115))
	condition:
		any of ($a_*)
 
}