
rule TrojanDownloader_Win32_Onkods_A{
	meta:
		description = "TrojanDownloader:Win32/Onkods.A,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 04 00 00 "
		
	strings :
		$a_01_0 = {00 63 3a 5c 55 73 65 72 73 5c 73 5c 44 65 73 6b 74 6f 70 5c } //1 挀尺獕牥屳屳敄歳潴屰
		$a_03_1 = {6a 00 6a 00 6a 02 6a 00 6a 00 68 00 00 00 40 8d ?? ?? ?? ff ff 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 ff (95 ?? ?? ff ff 55|?? 89 85 ??) ?? ff ff 90 08 00 10 8d ?? ?? ?? ff ff 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 68 ff 03 00 00 } //1
		$a_03_2 = {6a 00 6a 00 6a 20 6a 00 6a 00 6a 00 8d ?? ?? ?? ff ff 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 6a 00 ff (95 ?? ?? ff ff 55|?? 90 08 00) 20 b8 01 00 00 00 } //1
		$a_03_3 = {0f b7 45 fc 83 c0 01 0f b7 4d 10 99 f7 f9 66 89 55 fc 0f b7 45 ?? 0f b7 55 fc 0f b6 4c 15 ?? 03 c1 0f b7 4d 10 99 f7 f9 66 89 55 } //1
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1) >=1
 
}
rule TrojanDownloader_Win32_Onkods_A_2{
	meta:
		description = "TrojanDownloader:Win32/Onkods.A,SIGNATURE_TYPE_PEHSTR_EXT,01 00 01 00 04 00 00 "
		
	strings :
		$a_03_0 = {6a 00 6a 00 6a 02 6a 00 6a 00 [0-06] 68 00 00 00 40 8d ?? 24 ?? ?? 00 00 [0-10] 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 [0-10] ff 54 24 ?? 90 08 00 10 8d ?? 24 ?? 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 68 ff 03 00 00 } //1
		$a_03_1 = {56 56 6a 02 56 56 [0-06] 68 00 00 00 40 8d ?? 24 ?? ?? 00 00 [0-10] 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 [0-10] ff 54 24 ?? 90 08 00 10 8d ?? 24 ?? 90 17 06 01 01 01 01 01 01 50 51 52 53 56 57 68 ff 03 00 00 } //1
		$a_03_2 = {68 00 00 00 40 8d 84 24 ?? 00 00 00 50 [0-01] ff 54 24 ?? 8b ?? 24 ?? 8d 4c 24 ?? 51 68 ff 03 00 00 8d 94 24 ?? ?? 00 00 52 ?? 8b ?? ff } //1
		$a_03_3 = {8b c6 99 f7 fd 8a 5c 34 ?? 8b 44 24 ?? 46 0f be 14 02 } //10
	condition:
		((#a_03_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*10) >=1
 
}