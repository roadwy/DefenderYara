
rule HackTool_Win32_WDigest_A{
	meta:
		description = "HackTool:Win32/WDigest.A,SIGNATURE_TYPE_PEHSTR_EXT,05 00 05 00 0c 00 00 "
		
	strings :
		$a_03_0 = {ff d0 89 44 24 10 e9 90 01 04 8b 7d 0c 8b 4f 04 39 19 0f 85 90 01 04 8b 40 04 53 ff 75 10 ff 37 ff 36 ff 30 ff 15 90 00 } //2
		$a_03_1 = {89 41 04 3b c7 74 90 01 01 8b 06 8b 40 04 81 38 4d 44 4d 50 75 90 01 01 b9 90 01 04 66 39 48 04 90 00 } //1
		$a_03_2 = {4c 73 61 49 c7 44 24 90 01 01 43 61 6e 63 c7 44 24 90 01 01 65 6c 4e 6f 90 00 } //1
		$a_03_3 = {72 1c 81 79 0c 90 01 04 73 13 6a 0b 58 6a 24 5f 6a 1e 90 00 } //1
		$a_03_4 = {42 43 72 79 c7 45 90 01 01 70 74 47 65 c7 45 90 01 01 6e 65 72 61 90 00 } //1
		$a_03_5 = {81 7d d8 52 55 55 55 0f 85 90 01 02 00 00 8b 45 08 90 00 } //1
		$a_03_6 = {81 7e 04 4b 53 53 4d 75 90 01 01 03 75 f8 90 00 } //1
		$a_03_7 = {6a 6c 58 6a 73 66 89 90 01 01 e8 58 6a 61 90 00 } //1
		$a_01_8 = {43 72 65 64 65 6e 74 69 61 6c 4b 65 79 73 } //1 CredentialKeys
		$a_01_9 = {25 00 6c 00 53 00 25 00 6c 00 53 00 25 00 6c 00 53 00 3a 00 25 00 6c 00 53 00 00 00 } //1
		$a_01_10 = {77 00 64 00 69 00 67 00 65 00 73 00 74 00 2e 00 64 00 6c 00 6c 00 00 00 } //2
		$a_01_11 = {6c 00 73 00 61 00 73 00 72 00 76 00 00 00 } //1
	condition:
		((#a_03_0  & 1)*2+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1+(#a_03_3  & 1)*1+(#a_03_4  & 1)*1+(#a_03_5  & 1)*1+(#a_03_6  & 1)*1+(#a_03_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*2+(#a_01_11  & 1)*1) >=5
 
}