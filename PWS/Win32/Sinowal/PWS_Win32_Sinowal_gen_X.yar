
rule PWS_Win32_Sinowal_gen_X{
	meta:
		description = "PWS:Win32/Sinowal.gen!X,SIGNATURE_TYPE_PEHSTR_EXT,15 00 15 00 17 00 00 "
		
	strings :
		$a_03_0 = {83 7d fc 1d (73 ?? 0f 83|?? ?? ?? ?? 90) 03 05 06 8b 55 ?? ff 75 ?? 5a c1 e2 04 90 03 05 06 8b 45 ?? ff 75 ?? 58 c1 e8 05 } //10
		$a_01_1 = {03 44 11 0c 50 e8 } //10
		$a_03_2 = {42 65 65 70 90 09 02 00 81 (38|3a) ?? ?? ?? ?? (|) 74 0f 84 } //10
		$a_01_3 = {81 e2 00 ff 00 00 81 fa 00 45 00 00 75 } //10
		$a_01_4 = {6a 08 68 aa 00 00 00 8d 45 f4 50 e8 } //10
		$a_01_5 = {81 7d fc 01 17 00 00 73 } //1
		$a_01_6 = {81 7d f8 89 2a 00 00 73 } //1
		$a_01_7 = {81 7d fc c7 32 00 00 73 } //1
		$a_01_8 = {81 7d fc 9b 63 00 00 73 } //1
		$a_01_9 = {81 7d fc a1 75 00 00 73 } //1
		$a_01_10 = {81 7d f4 a9 78 00 00 73 } //1
		$a_01_11 = {81 7d f8 a9 78 00 00 73 } //1
		$a_01_12 = {81 7d f4 69 a8 00 00 73 } //1
		$a_03_13 = {81 7d f4 54 bc 00 00 (73|0f 83) } //1
		$a_01_14 = {81 7d fc 54 bc 00 00 73 } //1
		$a_01_15 = {81 7d fc 50 c3 00 00 73 } //1
		$a_01_16 = {81 7d fc c1 c3 00 00 73 } //1
		$a_03_17 = {81 7d f4 58 cc 00 00 (73|0f 83) } //1
		$a_01_18 = {81 7d fc 58 cc 00 00 73 } //1
		$a_01_19 = {81 7d fc 37 c7 00 00 73 } //1
		$a_01_20 = {81 7d f4 49 d7 00 00 73 } //1
		$a_01_21 = {81 7d fc 49 d7 00 00 73 } //1
		$a_01_22 = {81 7d f4 0b fc 00 00 73 } //1
	condition:
		((#a_03_0  & 1)*10+(#a_01_1  & 1)*10+(#a_03_2  & 1)*10+(#a_01_3  & 1)*10+(#a_01_4  & 1)*10+(#a_01_5  & 1)*1+(#a_01_6  & 1)*1+(#a_01_7  & 1)*1+(#a_01_8  & 1)*1+(#a_01_9  & 1)*1+(#a_01_10  & 1)*1+(#a_01_11  & 1)*1+(#a_01_12  & 1)*1+(#a_03_13  & 1)*1+(#a_01_14  & 1)*1+(#a_01_15  & 1)*1+(#a_01_16  & 1)*1+(#a_03_17  & 1)*1+(#a_01_18  & 1)*1+(#a_01_19  & 1)*1+(#a_01_20  & 1)*1+(#a_01_21  & 1)*1+(#a_01_22  & 1)*1) >=21
 
}