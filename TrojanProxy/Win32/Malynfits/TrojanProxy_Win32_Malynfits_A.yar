
rule TrojanProxy_Win32_Malynfits_A{
	meta:
		description = "TrojanProxy:Win32/Malynfits.A,SIGNATURE_TYPE_PEHSTR_EXT,08 00 08 00 1d 00 00 "
		
	strings :
		$a_80_0 = {00 70 72 6f 78 79 5f 64 6c 6c 2e 64 6c 6c 00 44 6c 6c 52 75 6e 00 } //  2
		$a_80_1 = {25 25 42 4f 54 5f 47 55 49 44 25 25 } //%%BOT_GUID%%  2
		$a_80_2 = {25 25 42 4f 54 5f 41 50 49 25 25 } //%%BOT_API%%  2
		$a_80_3 = {66 6b 69 74 2e 70 72 6f 78 79 2e 70 69 70 65 } //fkit.proxy.pipe  2
		$a_80_4 = {00 4d 49 54 4d 5f 43 46 47 00 } //  2
		$a_80_5 = {00 53 65 72 76 65 72 3a 20 6e 67 69 6e 78 0d 0a } //  2
		$a_80_6 = {00 25 30 38 78 25 30 34 78 25 30 34 78 25 30 32 78 25 30 32 78 25 30 32 78 25 30 32 78 25 30 32 78 25 30 32 78 25 30 32 78 25 30 32 78 00 } //  1
		$a_80_7 = {00 58 2d 52 65 64 69 72 65 63 74 2d 4e 61 6d 65 00 } //  1
		$a_80_8 = {00 7b 22 73 74 61 74 75 73 22 3a 22 6f 6b 22 7d 00 } //  1
		$a_80_9 = {00 4f 50 54 49 4f 4e 53 00 47 45 54 00 48 45 41 44 00 } //  1
		$a_80_10 = {00 6d 61 69 6e 36 34 2e 64 6c 6c 00 50 6c 75 67 69 6e 45 6e 74 72 79 00 } //  2
		$a_80_11 = {66 6b 69 74 2e 25 64 2e 6d 69 74 6d } //fkit.%d.mitm  2
		$a_80_12 = {73 6f 63 6b 65 74 2e 74 75 6e 6e 65 6c 2e 25 64 } //socket.tunnel.%d  2
		$a_80_13 = {66 6b 69 74 2e 78 36 34 2e 68 65 6c 70 65 72 } //fkit.x64.helper  2
		$a_80_14 = {5c 6c 61 73 74 2e 63 6f 6e 66 00 } //\last.conf  1
		$a_80_15 = {5c 6c 75 67 72 61 64 65 34 00 } //\lugrade4  1
		$a_03_16 = {8b 75 08 c7 05 28 e7 42 00 ?? ?? ?? ?? 80 35 28 e7 42 00 ?? 80 35 2a e7 42 00 ?? 68 ?? ?? ?? ?? 56 e8 ?? ?? ff ff } //1
		$a_01_17 = {bf c5 9d 1c 81 40 69 d7 93 01 00 01 } //1
		$a_80_18 = {31 38 35 35 30 44 32 32 2d 34 46 43 41 2d 34 41 46 32 2d 39 45 38 45 2d 46 30 32 35 39 44 32 33 36 39 34 46 } //18550D22-4FCA-4AF2-9E8E-F0259D23694F  1
		$a_80_19 = {63 34 65 38 64 30 65 31 2d 39 38 38 64 2d 34 32 62 37 2d 62 65 61 37 2d 36 62 66 39 35 38 39 62 62 31 31 31 } //c4e8d0e1-988d-42b7-bea7-6bf9589bb111  1
		$a_80_20 = {72 75 6e 64 6c 6c 33 32 20 73 68 65 6c 6c 33 32 2e 64 6c 6c 2c 53 68 65 6c 6c 45 78 65 63 5f 52 75 6e 44 4c 4c } //rundll32 shell32.dll,ShellExec_RunDLL  1
		$a_01_21 = {63 66 67 00 25 00 55 00 53 00 45 00 52 00 50 00 } //1 æ™£g%USERP
		$a_80_22 = {5c 63 6f 6e 74 61 69 6e 65 72 2e 64 61 74 } //\container.dat  1
		$a_80_23 = {64 72 6f 70 70 65 72 2e 70 61 74 68 } //dropper.path  1
		$a_80_24 = {74 6d 70 2e 64 65 6c 65 74 65 5f 66 69 6c 65 } //tmp.delete_file  1
		$a_80_25 = {2e 63 65 72 74 5f 66 70 } //.cert_fp  1
		$a_80_26 = {2e 6e 6f 5f 69 6e 73 74 61 6c 6c } //.no_install  1
		$a_80_27 = {2e 72 65 67 5f 70 61 74 68 } //.reg_path  1
		$a_80_28 = {2e 76 6d 5f 64 65 74 65 63 74 } //.vm_detect  1
	condition:
		((#a_80_0  & 1)*2+(#a_80_1  & 1)*2+(#a_80_2  & 1)*2+(#a_80_3  & 1)*2+(#a_80_4  & 1)*2+(#a_80_5  & 1)*2+(#a_80_6  & 1)*1+(#a_80_7  & 1)*1+(#a_80_8  & 1)*1+(#a_80_9  & 1)*1+(#a_80_10  & 1)*2+(#a_80_11  & 1)*2+(#a_80_12  & 1)*2+(#a_80_13  & 1)*2+(#a_80_14  & 1)*1+(#a_80_15  & 1)*1+(#a_03_16  & 1)*1+(#a_01_17  & 1)*1+(#a_80_18  & 1)*1+(#a_80_19  & 1)*1+(#a_80_20  & 1)*1+(#a_01_21  & 1)*1+(#a_80_22  & 1)*1+(#a_80_23  & 1)*1+(#a_80_24  & 1)*1+(#a_80_25  & 1)*1+(#a_80_26  & 1)*1+(#a_80_27  & 1)*1+(#a_80_28  & 1)*1) >=8
 
}