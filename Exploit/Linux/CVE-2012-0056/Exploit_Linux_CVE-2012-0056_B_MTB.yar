
rule Exploit_Linux_CVE-2012-0056_B_MTB{
	meta:
		description = "Exploit:Linux/CVE-2012-0056.B!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,05 00 05 00 03 00 00 "
		
	strings :
		$a_01_0 = {64 72 65 73 73 20 6d 61 6e 75 61 6c 6c 79 2e 00 00 5b 2d 5d 20 55 73 61 67 65 3a 20 25 73 20 2d 6f 20 41 44 44 52 45 53 53 0a 5b 2d 5d 20 45 78 61 6d 70 6c 65 3a 20 25 73 20 2d 6f 20 30 78 34 30 32 31 37 38 0a 00 00 00 5b 2b 5d 20 52 65 73 6f 6c 76 65 64 20 63 61 6c 6c 20 61 64 64 72 65 73 73 20 74 6f 20 30 78 25 6c 78 2e 0a 00 5b 2b 5d 20 43 61 6c 63 75 } //2
		$a_01_1 = {72 72 65 64 20 66 64 20 69 6e 20 70 61 72 65 6e 74 2e 00 5b 2b 5d 20 52 65 63 65 69 76 65 64 20 66 64 20 61 74 20 25 64 2e 0a 00 5b 2d 5d 20 72 65 63 76 5f 66 64 00 00 00 5b 2b 5d 20 41 73 73 69 67 6e 69 6e 67 20 66 64 20 25 64 20 74 6f 20 73 74 64 65 72 72 2e 0a 00 5b 2b 5d 20 53 65 65 6b 69 6e 67 20 74 6f 20 6f } //2
		$a_01_2 = {6a 64 75 6d 70 20 2d 64 20 2f 62 69 6e 2f 73 75 7c 67 72 65 70 20 27 3c 65 78 69 74 40 70 6c 74 3e 27 7c 68 65 61 64 20 2d 6e 20 31 7c 63 75 74 20 2d 64 20 27 20 27 20 2d 66 20 31 7c 73 65 64 20 27 73 2f 5e 5b 30 5d 2a 5c 28 5b 5e 30 5d 2a 5c 29 2f 30 78 5c 31 2f 27 } //1 jdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed 's/^[0]*\([^0]*\)/0x\1/'
	condition:
		((#a_01_0  & 1)*2+(#a_01_1  & 1)*2+(#a_01_2  & 1)*1) >=5
 
}