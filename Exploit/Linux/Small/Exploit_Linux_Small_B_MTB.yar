
rule Exploit_Linux_Small_B_MTB{
	meta:
		description = "Exploit:Linux/Small.B!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,06 00 06 00 06 00 00 "
		
	strings :
		$a_00_0 = {24 24 24 20 4c 30 30 6b 31 6e 67 20 66 30 72 20 6b 6e 30 77 6e 20 74 34 72 67 33 74 7a 2e 2e } //1 $$$ L00k1ng f0r kn0wn t4rg3tz..
		$a_00_1 = {64 75 6d 6d 79 5f 73 65 63 75 72 69 74 79 5f 6f 70 73 } //1 dummy_security_ops
		$a_00_2 = {2f 70 72 6f 63 2f 6b 61 6c 6c 73 79 6d 73 } //1 /proc/kallsyms
		$a_00_3 = {61 64 64 31 6e 67 20 73 70 33 63 31 34 6c 20 63 30 64 65 20 74 30 20 72 65 6d 30 76 33 20 73 33 6c 69 6e 75 78 20 74 33 72 72 30 72 31 7a 74 20 74 68 72 33 34 74 } //1 add1ng sp3c14l c0de t0 rem0v3 s3linux t3rr0r1zt thr34t
		$a_00_4 = {6f 76 65 72 72 69 64 65 5f 63 72 65 64 73 } //1 override_creds
		$a_00_5 = {45 72 72 30 72 20 31 6e 20 73 33 74 74 31 6e 67 20 63 72 33 64 20 73 68 33 6c 6c 63 30 64 33 7a } //1 Err0r 1n s3tt1ng cr3d sh3llc0d3z
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_00_3  & 1)*1+(#a_00_4  & 1)*1+(#a_00_5  & 1)*1) >=6
 
}