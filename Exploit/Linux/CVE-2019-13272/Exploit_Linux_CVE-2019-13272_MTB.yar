
rule Exploit_Linux_CVE-2019-13272_MTB{
	meta:
		description = "Exploit:Linux/CVE-2019-13272!MTB,SIGNATURE_TYPE_ELFHSTR_EXT,03 00 03 00 03 00 00 "
		
	strings :
		$a_00_0 = {50 54 52 41 43 45 5f 54 52 41 43 45 4d 45 20 6c 6f 63 61 6c 20 72 6f 6f 74 20 28 43 56 45 2d 32 30 31 39 2d 31 33 32 37 32 29 } //1 PTRACE_TRACEME local root (CVE-2019-13272)
		$a_00_1 = {2f 62 69 6e 2f 6c 6f 67 69 6e 63 74 6c 20 2d 2d 6e 6f 2d 61 73 6b 2d 70 61 73 73 77 6f 72 64 20 73 68 6f 77 2d 73 65 73 73 69 6f 6e 20 24 58 44 47 5f 53 45 53 53 49 4f 4e 5f 49 44 } //1 /bin/loginctl --no-ask-password show-session $XDG_SESSION_ID
		$a_00_2 = {54 72 61 63 69 6e 67 20 6d 69 64 70 69 64 } //1 Tracing midpid
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1) >=3
 
}