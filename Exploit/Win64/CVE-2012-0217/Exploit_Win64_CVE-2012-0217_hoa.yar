
rule Exploit_Win64_CVE-2012-0217_hoa{
	meta:
		description = "Exploit:Win64/CVE-2012-0217!hoa,SIGNATURE_TYPE_PEHSTR_EXT,02 00 02 00 03 00 00 "
		
	strings :
		$a_01_0 = {55 73 61 67 65 20 3a 20 73 79 73 72 65 74 2e 65 78 65 20 3c 6f 70 74 69 6f 6e 3e 20 3c 61 72 67 75 6d 65 6e 74 3e } //1 Usage : sysret.exe <option> <argument>
		$a_01_1 = {57 69 6e 64 6f 77 73 20 4b 65 72 6e 65 6c 20 49 6e 74 65 6c 20 78 36 34 20 53 79 73 72 65 74 20 56 75 6c 6e 65 72 61 62 69 6c 69 74 79 20 28 4d 53 31 32 2d 30 34 32 29 } //1 Windows Kernel Intel x64 Sysret Vulnerability (MS12-042)
		$a_01_2 = {45 78 70 6c 6f 69 74 65 64 20 62 79 20 53 68 61 68 72 69 79 61 72 } //1 Exploited by Shahriyar
	condition:
		((#a_01_0  & 1)*1+(#a_01_1  & 1)*1+(#a_01_2  & 1)*1) >=2
 
}